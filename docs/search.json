[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "MetaDAG experiment example",
    "section": "",
    "text": "1 Load data MetaDag experiment\nexperiment=\n  \"result_bb261b6e-95c6-3e39-b82b-b68eea80e30b\"\npath_exp=paste0(\"data/\",experiment,\"/data/\")\nknitr::kable(data.frame(\n  Directory_files_and_folders=dir(path_exp),\n  Type=c(rep(\"Data file\",2),\n  rep(\"Directory\",2),\n  rep(\"Data file\",5),\n  \"Directory\")))\n\n\n\n\nDirectory_files_and_folders\nType\n\n\n\n\nDifferent_MBB.csv\nData file\n\n\nDifferent_mDAG.csv\nData file\n\n\nGlobal\nDirectory\n\n\nIndividuals\nDirectory\n\n\nResults.csv\nData file\n\n\nSimilarities_MBB_MSAMethod.csv\nData file\n\n\nSimilarities_MBB_MunkresMethod.csv\nData file\n\n\nSimilarities_mDAG_MSAMethod.csv\nData file\n\n\nSimilarities_mDAG_MunkresMethod.csv\nData file\n\n\nTaxonomyLevels\nDirectory\nMBB=read_csv(paste0(path_exp,\"Different_MBB.csv\"),\n             show_col_types = FALSE)\nmDAG=read_csv(paste0(path_exp,\"Different_mDAG.csv\"),\n              show_col_types = FALSE)\nResults=read_csv(paste0(path_exp,\"Results.csv\"),\n                 show_col_types = FALSE)\nsave(MBB,mDAG,Results,\n     file=\"MBB_mDag_Results.Rdata\")\nRead graphs in graphml format\nWe will first load the metadata and adapt them to the structure of the similarities to facilitate the creation of the graphs and statistics.\nRemenber de path of the experiment:\npath_exp\n\n[1] \"data/result_bb261b6e-95c6-3e39-b82b-b68eea80e30b/data/\"\nlibrary(dendextend)\nlibrary(ggraph)\nlibrary(ape)\n\nD=as.dist(sqrt(1-Sim_MSA_mDAG^2))\nhc_MSA=hclust(as.dist(D),method =\"ward.D\")\nlibrary(circlize)\ncirclize_dendrogram(as.dendrogram(hc_MSA))\nclust4_MSA=cutree(hc_MSA,4)\ntable(clust4_MSA,meta_taxo$Kingdom)\n\n          \nclust4_MSA Animals Fungi Plants Protists\n         1     331     0      0        0\n         2     195     0      0        0\n         3       9   154     14       56\n         4       0     0    125        0\naux=meta_taxo %&gt;%\n  select(Organism,Kingdom,Phylum,Class,Full_Name)\naux$clust4_MSA=clust4_MSA\naux_Animals_cluster_1_2 = aux %&gt;%\n  filter(Kingdom==\"Animals\",clust4_MSA %in% c(1,2))\n\ntable(aux_Animals_cluster_1_2$Phylum,aux_Animals_cluster_1_2$clust4_MSA)\n\n                  \n                     1   2\n  Annelids           0   1\n  Arthropods         0 158\n  Brachiopodas       0   1\n  Cephalochordates   0   2\n  Cnidarians         0  10\n  Echinoderms        0   3\n  Hemichordates      0   1\n  Mollusks           0  14\n  Nematodes          0   1\n  Placozoans         0   1\n  Poriferans         0   1\n  Tunicates          0   2\n  Vertebrates      331   0\n\naux_9_Animals_cluster_3= filter(aux,\n                                clust4_MSA==3,\n                                Kingdom==\"Animals\")\naux_9_Animals_cluster_3\n\n# A tibble: 9 × 6\n  Organism Kingdom Phylum    Class     Full_Name                      clust4_MSA\n  &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                               &lt;int&gt;\n1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                 3\n2 cbr      Animals Nematodes Nematodes Caenorhabditis briggsae (nema…          3\n3 cel      Animals Nematodes Nematodes Caenorhabditis elegans (nemat…          3\n4 loa      Animals Nematodes Nematodes Loa loa (eye worm)                      3\n5 tsp      Animals Nematodes Nematodes Trichinella spiralis                    3\n6 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyda…          3\n7 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (South…          3\n8 shx      Animals Flatworms Flatworms Schistosoma haematobium (urin…          3\n9 smm      Animals Flatworms Flatworms Schistosoma mansoni                     3\n\naux_all_Nematodes_Flatworns= aux %&gt;% \n  filter(Kingdom==\"Animals\",\n         Phylum %in% c(\"Nematodes\",\"Flatworms\"))\naux_all_Nematodes_Flatworns\n\n# A tibble: 10 × 6\n   Organism Kingdom Phylum    Class     Full_Name                     clust4_MSA\n   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                              &lt;int&gt;\n 1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                3\n 2 cbr      Animals Nematodes Nematodes Caenorhabditis briggsae (nem…          3\n 3 cel      Animals Nematodes Nematodes Caenorhabditis elegans (nema…          3\n 4 loa      Animals Nematodes Nematodes Loa loa (eye worm)                     3\n 5 nai      Animals Nematodes Nematodes Necator americanus (New Worl…          2\n 6 tsp      Animals Nematodes Nematodes Trichinella spiralis                   3\n 7 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyd…          3\n 8 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (Sout…          3\n 9 shx      Animals Flatworms Flatworms Schistosoma haematobium (uri…          3\n10 smm      Animals Flatworms Flatworms Schistosoma mansoni                    3\n\naux_14_Plants_clust2= filter(aux,clust4_MSA==3,\n                             Kingdom==\"Plants\")\naux_14_Plants_clust2\n\n# A tibble: 14 × 6\n   Organism Kingdom Phylum Class Full_Name                      clust4_MSA\n   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                               &lt;int&gt;\n 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3\n 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3\n 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3\n 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3\n 5 cvr      Plants  Green  algae Chlorella variabilis                    3\n 6 mis      Plants  Green  algae Micromonas commoda                      3\n 7 mng      Plants  Green  algae Monoraphidium neglectum                 3\n 8 mpp      Plants  Green  algae Micromonas pusilla                      3\n 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3\n10 ota      Plants  Green  algae Ostreococcus tauri                      3\n11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3\n12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3\n13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3\n14 gsl      Plants  Red    algae Galdieria sulphuraria                   3\n\naux_all_algae_class= aux %&gt;% \n  filter(Kingdom==\"Plants\",\n         Class %in% c(\"algae\"))\naux_all_algae_class\n\n# A tibble: 14 × 6\n   Organism Kingdom Phylum Class Full_Name                      clust4_MSA\n   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                               &lt;int&gt;\n 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3\n 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3\n 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3\n 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3\n 5 cvr      Plants  Green  algae Chlorella variabilis                    3\n 6 mis      Plants  Green  algae Micromonas commoda                      3\n 7 mng      Plants  Green  algae Monoraphidium neglectum                 3\n 8 mpp      Plants  Green  algae Micromonas pusilla                      3\n 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3\n10 ota      Plants  Green  algae Ostreococcus tauri                      3\n11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3\n12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3\n13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3\n14 gsl      Plants  Red    algae Galdieria sulphuraria                   3\nThe hierarchical classification by Ward’s method recovers the kingdom Animal clusters 1 (all vertebrates) and 2 (invertebrate animals), cluster 4 the Plants and in cluster 3 are all protists and fungi together with 9 animals and 14 plants.\nThe 9 Animals are all from the Phylum Nematodes or Flatworns, out of the total of the 10 species of these phylums considered in the experiment. Only the Nematode Necator americanus (New World hookworm) is classified in Animals.\nThe 14 plants in cluster 2 are all algae considered in the experiment.\nSome statistics for graphs"
  },
  {
    "objectID": "index.html#mbb",
    "href": "index.html#mbb",
    "title": "MetaDAG experiment example",
    "section": "1.1 MBB",
    "text": "1.1 MBB\nIn this experiment MBB is a table with 5112 rows and 4106 columns.\n\n#100\nknitr::kable(MBB[1:20,1:10]) %&gt;%   \n  scroll_box(width = \"100%\", height = \"200px\")\n\n\n\n\n\nMBB Id\nnatural\n#pathways\nProtists\nFungi\nPlants\nAnimals\nAlveolates\nAmoebozoa\nAnnelids\n\n\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n0.0.0\n1\n1\n1\n0\n0\n0\n0\n0\n0\n\n\n0.0.0.0\n1\n1\n1\n0\n0\n0\n0\n0\n0\n\n\n0.0.1\n1\n1\n1\n0\n0\n0\n0\n0\n0\n\n\n0.0.1.0\n1\n86\n2\n77\n1\n6\n1\n0\n0\n\n\n0.0.1.1\n1\n86\n2\n77\n1\n6\n1\n0\n0\n\n\n0.0.1.2\n1\n15\n15\n0\n0\n0\n12\n0\n0\n\n\n0.0.1.3\n1\n5\n5\n0\n0\n0\n0\n4\n0\n\n\n0.0.1.4\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n0.0.1.4.0\n1\n609\n14\n128\n128\n339\n1\n3\n1\n\n\n0.0.1.4.1\n1\n609\n14\n128\n128\n339\n1\n3\n1\n\n\n0.0.1.4.2\n1\n322\n6\n92\n133\n91\n1\n0\n0\n\n\n0.0.1.4.3\n1\n322\n6\n92\n133\n91\n1\n0\n0\n\n\n0.0.1.4.4\n1\n1\n0\n0\n1\n0\n0\n0\n0\n\n\n0.0.1.4.5\n1\n1\n1\n0\n0\n0\n0\n1\n0\n\n\n0.0.1.5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n0.0.1.5.0\n1\n5\n5\n0\n0\n0\n0\n4\n0\n\n\n0.0.2\n1\n1\n1\n0\n0\n0\n0\n0\n0\n\n\n0.0.3\n1\n1\n1\n0\n0\n0\n0\n1\n0"
  },
  {
    "objectID": "index.html#mdag",
    "href": "index.html#mdag",
    "title": "MetaDAG experiment example",
    "section": "1.2 mDAG",
    "text": "1.2 mDAG\nAbstract/unique mDAG’s in this experiment\n\ndim(mDAG)\n\n[1]  884 5224\n\n\n\n#100\nkable(mDAG[1:20,1:10]) %&gt;%   scroll_box(width = \"100%\", height = \"200px\")\n\n\n\n\n\nmDAG Id\n#Categories\nAnimals\nPlants\nFungi\nProtists\nAlveolates\nAmoebozoa\nAnnelids\nArthropods\n\n\n\n\n0001\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0002\n2\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n0003\n2\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0004\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0005\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0006\n3\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n0007\n2\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n0008\n3\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n0009\n3\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n0010\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0011\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0012\n3\n0\n0\n0\n1\n0\n0\n0\n0\n\n\n0013\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0014\n3\n0\n0\n0\n1\n1\n0\n0\n0\n\n\n0015\n2\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n0016\n3\n0\n0\n0\n1\n0\n1\n0\n0\n\n\n0017\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0018\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0019\n3\n1\n0\n0\n0\n0\n0\n0\n1\n\n\n0020\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n\ndim(mDAG)\n\n[1]  884 5224\n\nnames(mDAG)[1:6]\n\n[1] \"mDAG Id\"     \"#Categories\" \"Animals\"     \"Plants\"      \"Fungi\"      \n[6] \"Protists\"   \n\nhead(names(mDAG)[7:(dim(mDAG)[2]-1150)])\n\n[1] \"Alveolates\"        \"Amoebozoa\"         \"Annelids\"         \n[4] \"Arthropods\"        \"Ascomycetes\"       \"Basal angiosperms\"\n\n# 28 to 1213  code MBB: 1 if MBB in mDAG 0"
  },
  {
    "objectID": "index.html#results",
    "href": "index.html#results",
    "title": "MetaDAG experiment example",
    "section": "1.3 Results",
    "text": "1.3 Results\nTabular data Results for this experiment\n\n#100\n#1:20\nkable(Results[1:20,1:10])%&gt;%\n  row_spec(0, angle = 0) %&gt;%   \n  scroll_box(width = \"300%\", height = \"1000px\")\n\n\n\n\n\norganism\nCategories\nmDAG Id\nFull Name\nR00710(1.2.1.3)\nR00710_rev(1.2.1.3)\nR00711(1.2.1.5)\nR00711_rev(1.2.1.5)\nR00755(4.1.1.1)\nR00746(1.1.1.2)\n\n\n\n\naaf\nProtists|Stramenopiles|Pelagophytes\n0036\nAureococcus anophagefferens\n0.0.15\n0.0.15\nNA\nNA\nNA\n0.0.15\n\n\naag\nAnimals|Arthropods|Insects\n0035\nAedes aegypti (yellow fever mosquito)\n0.2.33.36.14\n0.2.33.36.14\nNA\nNA\nNA\n0.2.33.36.14\n\n\naalb\nAnimals|Arthropods|Insects\n0276\nAedes albopictus (Asian tiger mosquito)\n0.2.33.36.18\n0.2.33.36.18\nNA\nNA\nNA\n0.2.33.36.18\n\n\naali\nAnimals|Arthropods|Insects\n0267\nAnopheles albimanus\n0.2.33.36.65\n0.2.33.36.65\n0.2.33.36.65\n0.2.33.36.65\nNA\n0.2.33.36.65\n\n\naalt\nFungi|Ascomycetes|Dothideomycetes\n0240\nAlternaria alternata\n0.3.5.6.7\n0.3.5.6.7\nNA\nNA\n0.3.5.6.7\n0.3.5.6.7\n\n\naam\nAnimals|Vertebrates|Birds\n0040\nApteryx mantelli mantelli (North Island brown kiwi)\n0.2.40.15.46\n0.2.40.15.46\n0.2.40.15.46\n0.2.40.15.46\nNA\n0.2.40.15.46\n\n\naamp\nAnimals|Vertebrates|Mammals\n0313\nArvicola amphibius (Eurasian water vole)\n0.2.40.18.2.0\n0.2.40.18.2.0\n0.2.40.18.2.0\n0.2.40.18.2.0\nNA\n0.2.40.18.2.0\n\n\naang\nAnimals|Vertebrates|Fishes\n0317\nAnguilla anguilla (European eel)\n0.2.40.17.0.0\n0.2.40.17.0.0\n0.2.40.17.0.0\n0.2.40.17.0.0\nNA\n0.2.40.17.0.0\n\n\naara\nAnimals|Arthropods|Insects\n0362\nAnopheles arabiensis\n0.2.33.36.34\n0.2.33.36.34\n0.2.33.36.34\n0.2.33.36.34\nNA\n0.2.33.36.34\n\n\nabe\nFungi|Ascomycetes|Eurotiomycetes\n0060\nTrichophyton benhamiae\n0.3.5.7.0\n0.3.5.7.0\nNA\nNA\n0.3.5.7.0\n0.3.5.7.0\n\n\nabp\nFungi|Basidiomycetes\n0068\nAgaricus bisporus var. burnettii JB137-S8\n0.3.6.1\n0.3.6.1\nNA\nNA\n0.3.6.1\nNA\n\n\nabv\nFungi|Basidiomycetes\n0073\nAgaricus bisporus var. bisporus H97\n0.3.6.3\n0.3.6.3\nNA\nNA\n0.3.6.3\nNA\n\n\nacan\nProtists|Amoebozoa|Acanthamoeba\n0873\nAcanthamoeba castellanii\n0.0.3\n0.0.3\nNA\nNA\nNA\n0.0.3\n\n\nacar\nAnimals|Vertebrates|Birds\n0884\nAntrostomus carolinensis (chuck-will's-widow)\n0.2.40.15.59\n0.2.40.15.59\n0.2.40.15.59\n0.2.40.15.59\nNA\n0.2.40.15.59\n\n\nacep\nAnimals|Arthropods|Insects\n0054\nAtta cephalotes (leaf cutting ant)\n0.2.33.36.56\n0.2.33.36.56\nNA\nNA\nNA\n0.2.33.36.56\n\n\nacer\nAnimals|Arthropods|Insects\n0057\nApis cerana (Asiatic honeybee)\n0.2.33.35.34\n0.2.33.35.34\n0.2.33.35.34\n0.2.33.35.34\nNA\n0.2.33.35.34\n\n\nachc\nAnimals|Vertebrates|Birds\n0103\nAquila chrysaetos chrysaetos (golden eagle)\n0.2.40.15.2.0\n0.2.40.15.2.0\n0.2.40.15.2.0\n0.2.40.15.2.0\nNA\n0.2.40.15.2.0\n\n\nache\nFungi|Ascomycetes|Eurotiomycetes\n0106\nAspergillus chevalieri\n0.3.5.7.2\n0.3.5.7.2\nNA\nNA\n0.3.5.7.2\n0.3.5.7.2\n\n\nachl\nAnimals|Vertebrates|Birds\n0081\nAcanthisitta chloris (rifleman)\n0.2.40.15.1.1.0.0\n0.2.40.15.1.1.0.0\nNA\nNA\nNA\n0.2.40.15.1.1.0.0\n\n\nacoz\nAnimals|Arthropods|Insects\n0255\nAnopheles coluzzii\n0.2.33.36.22\n0.2.33.36.22\n0.2.33.36.22\n0.2.33.36.22\nNA\n0.2.33.36.22\n\n\n\n\n\n\n\n\ndim(Results)\n\n[1]  884 3997\n\nnames(Results)[1]# organisms  kegg id  class representant of mDAG\n\n[1] \"organism\"\n\nnames(Results)[2]# taxonomy separate by |\n\n[1] \"Categories\"\n\nnames(Results)[3]# mDAG_Id \n\n[1] \"mDAG Id\"\n\nnames(Results)[4]# Full name representant\n\n[1] \"Full Name\"\n\nnames(Results)[6:36]# columns 6 to 2726  Variable Reactions name id: This reaction belongs to this ball for this MDAG. If not present the value is NA\n\n [1] \"R00710_rev(1.2.1.3)\"  \"R00711(1.2.1.5)\"      \"R00711_rev(1.2.1.5)\" \n [4] \"R00755(4.1.1.1)\"      \"R00746(1.1.1.2)\"      \"R00746_rev(1.1.1.2)\" \n [7] \"R00754(1.1.1.1)\"      \"R00754_rev(1.1.1.1)\"  \"R00014(4.1.1.1)\"     \n[10] \"R00014(1.2.4.1)\"      \"R03270(1.2.4.1)\"      \"R02569(2.3.1.12)\"    \n[13] \"R02569_rev(2.3.1.12)\" \"R00703(1.1.1.27)\"     \"R00703_rev(1.1.1.27)\"\n[16] \"R00200(2.7.1.40)\"     \"R00658(4.2.1.11)\"     \"R00658_rev(4.2.1.11)\"\n[19] \"R01518(5.4.2.11)\"     \"R01518_rev(5.4.2.11)\" \"R01061(1.2.1.12)\"    \n[22] \"R01061_rev(1.2.1.12)\" \"R01015(5.3.1.1)\"      \"R01015_rev(5.3.1.1)\" \n[25] \"R01070(4.1.2.13)\"     \"R01070_rev(4.1.2.13)\" \"R04779(2.7.1.11)\"    \n[28] \"R04780(3.1.3.11)\"     \"R02740(5.3.1.9)\"      \"R02740_rev(5.3.1.9)\" \n[31] \"R00959(5.4.2.2)\"     \n\n\n\nreactions=names(Results)[-c(1:5)]\nreverse_reactions=stringr::str_detect(reactions,\"rev\")\nreverse_reactions=table(reverse_reactions)\ndimnames(reverse_reactions)$reverse_reactions=c(\"One direction\",\n                                                \"Reverse reaction\")\nreverse_reactions\n\nreverse_reactions\n   One direction Reverse reaction \n            3398              594"
  },
  {
    "objectID": "index.html#individuals-graph-for-each-organism",
    "href": "index.html#individuals-graph-for-each-organism",
    "title": "MetaDAG experiment example",
    "section": "2.1 Individuals graph for each organism",
    "text": "2.1 Individuals graph for each organism\nRead individual graph for Homo sapiens (Keg id: hsa) at directory(Individuals/hsa)\n\nfiles_hsa=dir(paste0(path_exp,\"Individuals/hsa\"))\nfiles_hsa\n\n [1] \"hsa_mDAG.graphml\"       \"hsa_mDAG_adj.csv\"       \"hsa_mDAG_biggerDAG.pdf\"\n [4] \"hsa_mDAG_biggerDAG.svg\" \"hsa_mDAG_essential.pdf\" \"hsa_mDAG_essential.svg\"\n [7] \"hsa_mDAG_nl.csv\"        \"hsa_mDAG_structure.csv\" \"hsa_R_adj.csv\"         \n[10] \"hsa_R_nl.csv\"           \"hsa_RC.graphml\"         \"hsa_RC.pdf\"            \n[13] \"hsa_RC.svg\"            \n\n\n\n\n\n\n\nfiles_Individual_hsa\nDescription\n\n\n\n\nhsa_mDAG.graphml\ngraph mDAG graphml format\n\n\nhsa_mDAG_adj.csv\ncsv graph adjacency matrix of mDAG\n\n\nhsa_mDAG_biggerDAG.pdf\nplot bigger conected componet mDAG pdf format\n\n\nhsa_mDAG_biggerDAG.svg\nplot bigger conected componet mDAG svg format\n\n\nhsa_mDAG_essential.pdf\nplot essential MBB mDAG pdf format\n\n\nhsa_mDAG_essential.svg\nplot essential MBB mDAG svg format\n\n\nhsa_mDAG_nl.csv\ncsv names labels MBB vertex of mDAG\n\n\nhsa_mDAG_structure.csv\ncsv matrix membership of reacctions of each MBB of mDAG ordered by decreasing size of MBB\n\n\nhsa_R_adj.csv\ncsv graph adjacency matrix of RC graph\n\n\nhsa_R_nl.csv\ncsv names labels MBB vertex of RC\n\n\nhsa_RC.graphml\ngraph RC graphml format\n\n\nhsa_RC.pdf\nplot RC pdf format\n\n\nhsa_RC.svg\nplot RC svg format\n\n\n\n\n\n\n\n\ngraph_mDAG=read.graph(\n  paste0(path_exp,\n         \"Individuals/hsa/hsa_mDAG.graphml\"),\n  format= \"graphml\")\nsummary(graph_mDAG)\n\nIGRAPH 33eaf5a D--- 1026 1086 -- \n+ attr: color (v/c), label (v/c), id (v/c), id (e/c)\n\nbarplot(table(igraph::degree(graph_mDAG,mode=\"all\")),\n              ylim=c(0,350),col=\"blue\",\n              main=\"Frequency of nodes degree\",\n              ylab=\"Frequency\",xlab=\"degree\")"
  },
  {
    "objectID": "index.html#mdag-global-core-for-eukaryotes",
    "href": "index.html#mdag-global-core-for-eukaryotes",
    "title": "MetaDAG experiment example",
    "section": "2.2 mDag Global core for eukaryotes",
    "text": "2.2 mDag Global core for eukaryotes\nNote that the mDAG core is empty as it does not contain any reactions.\n\n2.2.1 Core mDAG\n\ngraph_core_mDAG=read.graph(\n  paste0(path_exp,\"Global/core/core_mDAG.graphml\"),\n  format = \"graphml\")\nsummary(graph_core_mDAG)\n\nIGRAPH 340a31e D--- 0 0 -- \n+ attr: color (v/c), label (v/c), id (v/c)\n\n\n\n# file missing\nknitr::include_graphics(paste0(path_exp,\n                               \"Global/core/core_mDAG.pdf\"))\n\nThe graph core mDAG have 0 vertex and 0, is an empty graph.\n\n\n2.2.2 Core reaction graph (RC)\n\ngraph_core_RC=read.graph(\n  paste0(path_exp,\n         \"Global/core/core_RC.graphml\"),\n  format = \"graphml\")\nsummary(graph_core_mDAG)\n\nIGRAPH 340a31e D--- 0 0 -- \n+ attr: color (v/c), label (v/c), id (v/c)\n\n\n\nknitr::include_graphics(\n  paste0(path_exp,\"Global/core/core_RC.pdf\"))\n\n\n\n\nCore mDAG is empty\n\n\n\n\nThe graph core reaction graph have 0 vertex and 0, is an empty graph."
  },
  {
    "objectID": "index.html#mdag-global-pan-for-eukaryotes",
    "href": "index.html#mdag-global-pan-for-eukaryotes",
    "title": "MetaDAG experiment example",
    "section": "2.3 mDag Global pan for eukaryotes",
    "text": "2.3 mDag Global pan for eukaryotes\n\n2.3.1 Pan mDAG\n\ngraph_pan_mDAG=read.graph(\n  paste0(path_exp,\n         \"TaxonomyLevels/Kingdom/Animals/pan/Animals_pan_mDAG.graphml\"),\n  format = \"graphml\")\nsummary(graph_pan_mDAG)\n\nIGRAPH 3446078 D--- 1184 1261 -- \n+ attr: color (v/c), label (v/c), id (v/c), id (e/c)\n\n\nThe graph pan mDAG have 1184 vertex and 1261.\n\n\n2.3.2 Pan Reaction graph (RC)\n\ngraph_pan_RC=read.graph(\n  paste0(path_exp,\n         \"TaxonomyLevels/Kingdom/Animals/pan/Animals_pan_RC.graphml\"),\n  format = \"graphml\")\nsummary(graph_pan_RC)\n\nIGRAPH 3456cac D--- 4556 5798 -- \n+ attr: color (v/c), label (v/c), id (v/c), id (e/c)\n\n\nThe graph pan reaction graph have 4556 vertex and 5798.\n\ncompo=components(graph_mDAG,mode = \"weak\")\nstr(compo)\n\nList of 3\n $ membership: num [1:1026] 1 1 1 1 1 1 1 1 1 1 ...\n $ csize     : num [1:167] 589 1 1 1 1 1 4 3 4 3 ...\n $ no        : int 167\n\ncompo$csize\n\n  [1] 589   1   1   1   1   1   4   3   4   3   2   3   3   1   1   1   2   6\n [19]   3   1   3   6   1   1   1   1   1   3   1   6   2   1   1   1   2   1\n [37]   1  14   1  16   1   6   2   2   4   1   1   1   1   1   1   1   1   1\n [55]  13   1   1   1   1   2   6   5   5   2   2  10   1   1   1   2   2   1\n [73]   1   1  62   6   2   1   2   1   1   1   2   1   2  14   3   1   1   1\n [91]   1   1   1   1   1   1   3   6   1   3   1   3   2   1   1   1   2   2\n[109]   3   1   1   2   5   1   1   2   3   2   1   1   2   3   4   1   1   2\n[127]   1   1   2   1   1   1   1   1   3   1   2   2   1   6   1   1   1   2\n[145]   1   1   1   1   1   2   7   1  15   3   1   1   1   1   2   1   3   1\n[163]   1   1   1   1   2\n\nk=which.max(compo$csize==max(compo$csize))\nk\n\n[1] 1\n\ntable(compo$membership)\n\n\n  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20 \n589   1   1   1   1   1   4   3   4   3   2   3   3   1   1   1   2   6   3   1 \n 21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40 \n  3   6   1   1   1   1   1   3   1   6   2   1   1   1   2   1   1  14   1  16 \n 41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60 \n  1   6   2   2   4   1   1   1   1   1   1   1   1   1  13   1   1   1   1   2 \n 61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80 \n  6   5   5   2   2  10   1   1   1   2   2   1   1   1  62   6   2   1   2   1 \n 81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 \n  1   1   2   1   2  14   3   1   1   1   1   1   1   1   1   1   3   6   1   3 \n101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 \n  1   3   2   1   1   1   2   2   3   1   1   2   5   1   1   2   3   2   1   1 \n121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 \n  2   3   4   1   1   2   1   1   2   1   1   1   1   1   3   1   2   2   1   6 \n141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 \n  1   1   1   2   1   1   1   1   1   2   7   1  15   3   1   1   1   1   2   1 \n161 162 163 164 165 166 167 \n  3   1   1   1   1   1   2 \n\nvertex=which(compo$membership==k)\nlength(vertex)\n\n[1] 589\n\nBig_Component=induced_subgraph(graph_mDAG, vids=vertex)\nigraph::vcount(Big_Component)\n\n[1] 589\n\nigraph::ecount(Big_Component)\n\n[1] 774\n\n\nThe curated plot of the bigger component of hsa mDAG\n\nknitr::include_graphics(paste0(path_exp,\n                            \"Individuals/hsa/hsa_mDAG_biggerDAG.pdf\"))"
  },
  {
    "objectID": "index.html#load-meta-data-from-eukariotes-experimet",
    "href": "index.html#load-meta-data-from-eukariotes-experimet",
    "title": "MetaDAG experiment example",
    "section": "3.1 Load meta data from eukariotes experimet",
    "text": "3.1 Load meta data from eukariotes experimet\nMeta data mDa_Id and taxonomy sort by Kingdom,Filum,Class,mDAG_Id\n\npath_exp\n\n[1] \"data/result_bb261b6e-95c6-3e39-b82b-b68eea80e30b/data/\"\n\nResults=read_csv(paste0(path_exp,\"Results.csv\"))\nnames(Results)[c(1,3,4)]=c(\"Organism\",\"mDAG_Id\",\"Full_Name\")\ntaxo=Results %&gt;% select(Organism:Full_Name)\ntaxo=taxo %&gt;% separate(Categories,into=c(\"Kingdom\",\"Phylum\",\"Class\"))\nindex=which(is.na(taxo$Class))\ntaxo$Class[index]=paste(taxo$Phylum[index])\nmeta_taxo=taxo\naux=table(meta_taxo$Phylum)\nFreq_Phylum=tibble(Phylum=names(aux),Freq_Phylum=aux)\nnames(Freq_Phylum)=c(\"Phylum\",\"Freq_Phylum\")\naux=table(meta_taxo$Class)\nFreq_Class=tibble(Class=names(aux),Freq_Class=aux)\nnames(Freq_Class)=c(\"Class\",\"Freq_Class\")\n\n\nmeta_taxo = meta_taxo %&gt;% \n  left_join(Freq_Phylum) %&gt;%\n  left_join(Freq_Class)\nmeta_taxo = meta_taxo %&gt;% \n  arrange(Kingdom,desc(Freq_Phylum),Phylum,\n          desc(Freq_Class),Class)\nhead(meta_taxo)\n\n# A tibble: 6 × 8\n  Organism Kingdom Phylum      Class   mDAG_Id Full_Name  Freq_Phylum Freq_Class\n  &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;table[1d]&gt; &lt;table[1d&gt;\n1 aamp     Animals Vertebrates Mammals 0313    Arvicola … 331         139       \n2 afz      Animals Vertebrates Mammals 0143    Antechinu… 331         139       \n3 ajm      Animals Vertebrates Mammals 0221    Artibeus … 331         139       \n4 aju      Animals Vertebrates Mammals 0224    Acinonyx … 331         139       \n5 aml      Animals Vertebrates Mammals 0279    Ailuropod… 331         139       \n6 anu      Animals Vertebrates Mammals 0310    Arvicanth… 331         139       \n\n\n\ntable(meta_taxo$Kingdom) %&gt;% kable %&gt;%\n  kable_styling(\"striped\", full_width = F,position=\"left\")%&gt;% \n scroll_box(width = \"400px\", height = \"200px\")\n\n\n\n\n\nVar1\nFreq\n\n\n\n\nAnimals\n535\n\n\nFungi\n154\n\n\nPlants\n139\n\n\nProtists\n56\n\n\n\n\n\n\ntable(meta_taxo$Phylum,meta_taxo$Kingdom) %&gt;% kable %&gt;%\n  kable_styling(\"striped\", full_width = F,position=\"left\")%&gt;% \n scroll_box(width = \"500px\", height = \"500px\")\n\n\n\n\n\n\nAnimals\nFungi\nPlants\nProtists\n\n\n\n\nAlveolates\n0\n0\n0\n25\n\n\nAmoebozoa\n0\n0\n0\n7\n\n\nAnnelids\n1\n0\n0\n0\n\n\nArthropods\n158\n0\n0\n0\n\n\nAscomycetes\n0\n113\n0\n0\n\n\nBasal\n0\n0\n2\n0\n\n\nBasidiomycetes\n0\n36\n0\n0\n\n\nBrachiopodas\n1\n0\n0\n0\n\n\nCephalochordates\n2\n0\n0\n0\n\n\nChoanoflagellates\n0\n0\n0\n2\n\n\nCnidarians\n10\n0\n0\n0\n\n\nCryptomonads\n0\n0\n0\n1\n\n\nEchinoderms\n3\n0\n0\n0\n\n\nEudicots\n0\n0\n98\n0\n\n\nEuglenozoa\n0\n0\n0\n9\n\n\nFerns\n0\n0\n1\n0\n\n\nFlatworms\n4\n0\n0\n0\n\n\nGreen\n0\n0\n11\n0\n\n\nHaptophyta\n0\n0\n0\n1\n\n\nHemichordates\n1\n0\n0\n0\n\n\nHeterolobosea\n0\n0\n0\n1\n\n\nMetamonada\n0\n0\n0\n2\n\n\nMicrosporidians\n0\n5\n0\n0\n\n\nMollusks\n14\n0\n0\n0\n\n\nMonocots\n0\n0\n23\n0\n\n\nMosses\n0\n0\n1\n0\n\n\nNematodes\n6\n0\n0\n0\n\n\nPlacozoans\n1\n0\n0\n0\n\n\nPoriferans\n1\n0\n0\n0\n\n\nRed\n0\n0\n3\n0\n\n\nStramenopiles\n0\n0\n0\n8\n\n\nTunicates\n2\n0\n0\n0\n\n\nVertebrates\n331\n0\n0\n0"
  },
  {
    "objectID": "index.html#similarities-msamunkres-methods",
    "href": "index.html#similarities-msamunkres-methods",
    "title": "MetaDAG experiment example",
    "section": "3.2 Similarities MSA,Munkres methods",
    "text": "3.2 Similarities MSA,Munkres methods\nIn this section we will show the similarities between mDAG’s using different methods.\nThe experiment data set consists of 884 eurkaryotes from the animal, plant, fungus, and protist kingdoms.\n\n\n\n\n\nKingdom\nAbs. Freq.\n\n\n\n\nAnimals\n535\n\n\nFungi\n154\n\n\nPlants\n139\n\n\nProtists\n56\n\n\n\n\n\n\n\n\nlist_Sim=dir(path_exp,pattern=\"^Similarities\")\nlist_Sim\n\n[1] \"Similarities_MBB_MSAMethod.csv\"      \"Similarities_MBB_MunkresMethod.csv\" \n[3] \"Similarities_mDAG_MSAMethod.csv\"     \"Similarities_mDAG_MunkresMethod.csv\"\n\n\nLoad MDAG similarities\n\nSim_MSA_mDAG=read_csv(paste0(path_exp,\n                             \"Similarities_mDAG_MSAMethod.csv\"))\nSim_MSA_mDAG=as.matrix(Sim_MSA_mDAG[,-1])\nrownames(Sim_MSA_mDAG)=colnames(Sim_MSA_mDAG)\nSim_MSA_mDAG=Sim_MSA_mDAG[meta_taxo$mDAG_Id,meta_taxo$mDAG_Id]\n\n\nSim_Mun_mDAG=read_csv(paste0(path_exp,\n\"Similarities_mDAG_MunkresMethod.csv\"))\nSim_Mun_mDAG=as.matrix(Sim_Mun_mDAG[,-1])\nrownames(Sim_Mun_mDAG)=colnames(Sim_Mun_mDAG)\nSim_Mun_mDAG=Sim_Mun_mDAG[meta_taxo$mDAG_Id,meta_taxo$mDAG_Id]"
  },
  {
    "objectID": "index.html#heatmaps",
    "href": "index.html#heatmaps",
    "title": "MetaDAG experiment example",
    "section": "3.3 Heatmaps",
    "text": "3.3 Heatmaps\n\n3.3.1 Heatmap Similarity MSA and Munkres method\n\ndff&lt;-meta_taxo %&gt;% select(Kingdom)  %&gt;% as.data.frame()\ncolorsK &lt;- list(Kingdom= c(\"Animals\"=\"red\",\n                           \"Plants\"=\"green\",\n                           \"Fungi\"=\"yellow\",\n                           \"Protists\"=\"black\"))\nannotationK &lt;- HeatmapAnnotation(df=dff, col = colorsK,show_legend = TRUE)\n\nMSA_heat_1 &lt;- Heatmap(matrix = Sim_MSA_mDAG, \n                      column_title=\n                        \"m-DAGs MSA-similarity Eukaryotes by Kingdoms\",\n                      heatmap_legend_param=list(\n                        title=\"Similarity\",\n                        at = seq(0,1,by=0.1)),\n                      col=rev(viridis(256)),\n                      cluster_rows = FALSE,\n                      cluster_columns = FALSE,\n                      top_annotation = annotationK,\n                      show_column_names = FALSE, \n                      show_row_names = FALSE,\n                      left_annotation =\n                        rowAnnotation(df = dff,\n                                      col = colorsK,\n                                    show_annotation_name=FALSE,\n                                    show_legend=FALSE\n                                      ))\n\n\n\n\n\n\n\nMun_heat_1&lt;- Heatmap(matrix = Sim_Mun_mDAG, \n             column_title=\"mDAGs Munkres-similarity  Eukaryotes by Kingdoms\",\n            name = \"Munkres Similarity\",\n            heatmap_legend_param=list(\n                        title=\"Similarity\",\n                        at = seq(0,1,by=0.1)),\n                      col=rev(viridis(256)),\n                      cluster_rows = FALSE,\n                      cluster_columns = FALSE,\n                      top_annotation = annotationK,\n                      show_column_names = FALSE, \n                      show_row_names = FALSE,\n                      left_annotation =\n                        rowAnnotation(df = dff,\n                                      col = colorsK,\n                                    show_annotation_name=FALSE,\n                                    show_legend=FALSE\n                                      ))\n\n\nmeta_animals= meta_taxo %&gt;% filter(Kingdom==\"Animals\")\n\ndff&lt;-meta_taxo %&gt;%\n  filter(Kingdom==\"Animals\") %&gt;% \n  select(Phylum,Freq_Phylum) %&gt;%   \n  as.data.frame() %&gt;% select(Phylum)\n\nnamesP=dff %&gt;% distinct( Phylum, .keep_all = TRUE) \nnamesP=namesP$Phylum\ndff$Phylum=ordered(dff$Phylum,labels=namesP)\ncol=rainbow(length(namesP))\ncolorsP=list(Phylum=col)\nnames(colorsP$Phylum)=namesP\nannotation_H2 &lt;- HeatmapAnnotation(df=dff, col = colorsP)\nMSA_heat_2 &lt;- Heatmap(matrix =\n                        Sim_MSA_mDAG[1:nrow(dff),1:nrow(dff)],\n                      column_title=\"mDAGs MSA-similarity  Animals by Phyla\",\n                      col=rev(viridis(256)),\n                      cluster_rows = FALSE,\n                      show_heatmap_legend=FALSE, \n                      cluster_columns = FALSE,\n                      top_annotation = annotation_H2,\n                      show_column_names = FALSE, \n                      show_row_names = FALSE,\n                      left_annotation = \n                        rowAnnotation(df = dff,\n                                      col = colorsP,\n                                      show_annotation_name=FALSE,\n                                      show_legend =FALSE\n                                      ))\n\n\n\nMun_heat_2 &lt;- Heatmap(matrix = Sim_Mun_mDAG[1:nrow(dff),1:nrow(dff)], \n              column_title=\"mDAGs Munkres-similarity  Animals by Phyla\",\n        col=rev(viridis(256)),\n    show_heatmap_legend=FALSE, \n        cluster_rows = FALSE,\n        cluster_columns = FALSE,\n        top_annotation = annotation_H2,\n        show_column_names = FALSE, \n        show_row_names = FALSE,\n        left_annotation = rowAnnotation(df = dff,\n                                        col = colorsP,\n                                    show_annotation_name=FALSE,\n                                        show_legend =FALSE\n                                        ))\n\n\nMSA_heat_1\n\n\n\nMSA_heat_2\n\n\n\nMun_heat_1\n\n\n\nMun_heat_2"
  },
  {
    "objectID": "index.html#mds-multidimensional-scaling-msa",
    "href": "index.html#mds-multidimensional-scaling-msa",
    "title": "MetaDAG experiment example",
    "section": "3.4 MDS (Multidimensional Scaling) MSA",
    "text": "3.4 MDS (Multidimensional Scaling) MSA\n\n## Metric multidimensional scaling (mMDS)\nmds7 &lt;- cmdscale(sqrt(1-Sim_MSA_mDAG^2),k=7,eig=TRUE)\n#pairs(mds7$points[,1:4])\nmds7$GOF\n\n[1] 0.4406568 0.5541042\n\nmds &lt;- mds7$points %&gt;%  as_tibble()\ncolnames(mds) &lt;-paste0(\"Dim.\",1:dim(mds7$points)[2])\n\n\ncooordinates=as_tibble(mds7$points)\ncolnames(cooordinates)=paste(\"Component\",1:7)\nggpairs(cooordinates,columns=1:4,\n        aes(color=meta_taxo$Kingdom,alpha=0.5,\n            title=\"MDS 4 dimensions projection\",\n            legend=1),upper=list(continuous=\"points\")) +\n  scale_fill_manual(values = colorsK$Kingdom) + \n  theme(legend.position = \"left\")"
  },
  {
    "objectID": "index.html#mds-multidimensional-scaling-munkres",
    "href": "index.html#mds-multidimensional-scaling-munkres",
    "title": "MetaDAG experiment example",
    "section": "4.1 MDS (Multidimensional Scaling) Munkres",
    "text": "4.1 MDS (Multidimensional Scaling) Munkres\n\n## Metric multidimensional scaling\nmds7 &lt;- cmdscale(sqrt(1-Sim_Mun_mDAG^2),k=7,eig=TRUE)\nmds7$GOF\n\n[1] 0.5600385 0.5796647\n\nmds &lt;- mds7$points %&gt;%  as_tibble()\ncolnames(mds) &lt;-paste0(\"Dim.\",1:dim(mds7$points)[2])\n\ncooordinates=as_tibble(mds7$points)\ncolnames(cooordinates)=paste(\"Component\",1:7)\nggpairs(cooordinates,columns=1:4,\n        aes(color=meta_taxo$Kingdom,\n            title=\"MDS 4 dimensions projection\",legend=1),\n        lower=list(continuous=\"points\")) + \n  scale_fill_manual(values = colorsK$Kingdom) + \n  theme(legend.position = \"left\")"
  },
  {
    "objectID": "index.html#hierarchical-cluster-munkres",
    "href": "index.html#hierarchical-cluster-munkres",
    "title": "MetaDAG experiment example",
    "section": "4.2 Hierarchical cluster Munkres",
    "text": "4.2 Hierarchical cluster Munkres\n\nD=as.dist(sqrt(1-Sim_Mun_mDAG^2))\nhc_Mun=hclust(as.dist(D),method =\"ward.D\")\nggplot(as.ggdend(as.dendrogram(hc_Mun)))\n\n\n\n\n\nclust4_Mun=cutree(hc_Mun,4)\ntable(clust4_Mun,meta_taxo$Kingdom)\n\n          \nclust4_Mun Animals Fungi Plants Protists\n         1     331     0      0        0\n         2     197     0      0        0\n         3       7   154     14       56\n         4       0     0    125        0\n\n\nOnly two nematodes of the 9 return to the invertebrate animal cluster for Munkrest; all algae remain in the fungi and archaea cluster.\n\naux=meta_taxo %&gt;%\n  select(Organism,Kingdom,Phylum,Class,Full_Name)\naux$clust4_Mun=clust4_Mun\naux_Animals_cluster_1_2_Mun = aux %&gt;%\n  filter(Kingdom==\"Animals\",clust4_Mun %in% c(1,2))\n\ntable(aux_Animals_cluster_1_2_Mun$Phylum,\n      aux_Animals_cluster_1_2_Mun$clust4_Mun)\n\n                  \n                     1   2\n  Annelids           0   1\n  Arthropods         0 158\n  Brachiopodas       0   1\n  Cephalochordates   0   2\n  Cnidarians         0  10\n  Echinoderms        0   3\n  Hemichordates      0   1\n  Mollusks           0  14\n  Nematodes          0   3\n  Placozoans         0   1\n  Poriferans         0   1\n  Tunicates          0   2\n  Vertebrates      331   0\n\naux_7_Animals_cluster_3_Mun= filter(aux,\n                                clust4_Mun==3,\n                                Kingdom==\"Animals\")\naux_7_Animals_cluster_3_Mun\n\n# A tibble: 7 × 6\n  Organism Kingdom Phylum    Class     Full_Name                      clust4_Mun\n  &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                               &lt;int&gt;\n1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                 3\n2 loa      Animals Nematodes Nematodes Loa loa (eye worm)                      3\n3 tsp      Animals Nematodes Nematodes Trichinella spiralis                    3\n4 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyda…          3\n5 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (South…          3\n6 shx      Animals Flatworms Flatworms Schistosoma haematobium (urin…          3\n7 smm      Animals Flatworms Flatworms Schistosoma mansoni                     3\n\naux_all_Nematodes_Flatworns= aux %&gt;% \n  filter(Kingdom==\"Animals\",\n         Phylum %in% c(\"Nematodes\",\"Flatworms\"))\naux_all_Nematodes_Flatworns\n\n# A tibble: 10 × 6\n   Organism Kingdom Phylum    Class     Full_Name                     clust4_Mun\n   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                              &lt;int&gt;\n 1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                3\n 2 cbr      Animals Nematodes Nematodes Caenorhabditis briggsae (nem…          2\n 3 cel      Animals Nematodes Nematodes Caenorhabditis elegans (nema…          2\n 4 loa      Animals Nematodes Nematodes Loa loa (eye worm)                     3\n 5 nai      Animals Nematodes Nematodes Necator americanus (New Worl…          2\n 6 tsp      Animals Nematodes Nematodes Trichinella spiralis                   3\n 7 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyd…          3\n 8 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (Sout…          3\n 9 shx      Animals Flatworms Flatworms Schistosoma haematobium (uri…          3\n10 smm      Animals Flatworms Flatworms Schistosoma mansoni                    3\n\naux_14_Plants_clust2_Mun= filter(aux,clust4_Mun==3,\n                             Kingdom==\"Plants\")\naux_14_Plants_clust2_Mun\n\n# A tibble: 14 × 6\n   Organism Kingdom Phylum Class Full_Name                      clust4_Mun\n   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                               &lt;int&gt;\n 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3\n 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3\n 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3\n 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3\n 5 cvr      Plants  Green  algae Chlorella variabilis                    3\n 6 mis      Plants  Green  algae Micromonas commoda                      3\n 7 mng      Plants  Green  algae Monoraphidium neglectum                 3\n 8 mpp      Plants  Green  algae Micromonas pusilla                      3\n 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3\n10 ota      Plants  Green  algae Ostreococcus tauri                      3\n11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3\n12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3\n13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3\n14 gsl      Plants  Red    algae Galdieria sulphuraria                   3\n\naux_all_algae_class= aux %&gt;% \n  filter(Kingdom==\"Plants\",\n         Class %in% c(\"algae\"))\naux_all_algae_class\n\n# A tibble: 14 × 6\n   Organism Kingdom Phylum Class Full_Name                      clust4_Mun\n   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                               &lt;int&gt;\n 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3\n 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3\n 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3\n 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3\n 5 cvr      Plants  Green  algae Chlorella variabilis                    3\n 6 mis      Plants  Green  algae Micromonas commoda                      3\n 7 mng      Plants  Green  algae Monoraphidium neglectum                 3\n 8 mpp      Plants  Green  algae Micromonas pusilla                      3\n 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3\n10 ota      Plants  Green  algae Ostreococcus tauri                      3\n11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3\n12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3\n13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3\n14 gsl      Plants  Red    algae Galdieria sulphuraria                   3"
  },
  {
    "objectID": "index.html#similarity-comparison-eukaryotes",
    "href": "index.html#similarity-comparison-eukaryotes",
    "title": "MetaDAG experiment example",
    "section": "4.3 Similarity comparison Eukaryotes",
    "text": "4.3 Similarity comparison Eukaryotes\nComparison of two similarities\nLoad the similarities for pairs and comparison\n\nn=length(meta_taxo$mDAG_Id)\nn\n\n[1] 884\n\ndim(Sim_MSA_mDAG)\n\n[1] 884 884\n\n#aux1=base::rep(x=1:n,each=c(n:1))\n\naux=as_tibble(Sim_MSA_mDAG)\naux$mDag=names(aux)\naux=aux %&gt;% pivot_longer(cols=`0313`:`0300`,\n                         names_to=\"mDag_2\",\n                         values_to=\"Sim_MSA\")\n\naux_2= aux %&gt;%  mutate(i=pmax(as.integer(mDag),\n                              as.integer(mDag_2)),\n                       j=pmin(as.integer(mDag),\n                       as.integer(mDag_2))) %&gt;% unite(\"ij\",i:j) %&gt;%\n  filter(duplicated(ij))\n\n\naux=as_tibble(Sim_Mun_mDAG)\naux$mDag=names(aux)\naux=aux %&gt;% pivot_longer(cols=`0313`:`0300`,\n                         names_to=\"mDag_2\",\n                         values_to=\"Sim_Mun\")\naux_2 = aux_2 %&gt;% left_join(aux)\n\nSim_comp=aux_2\nrm(aux,aux_2)\n\nSpearman and Pearson correlations\n\ncor(Sim_comp[,c(3,5)],method=\"spearman\")\n\n          Sim_MSA   Sim_Mun\nSim_MSA 1.0000000 0.8902053\nSim_Mun 0.8902053 1.0000000\n\ncor(Sim_comp[,c(3,5)],method=\"pearson\")\n\n          Sim_MSA   Sim_Mun\nSim_MSA 1.0000000 0.9138905\nSim_Mun 0.9138905 1.0000000\n\n\n\nGGally::ggpairs(Sim_comp[,c(3,5)])\n\n\n\n\n\naux= Sim_comp%&gt;% pivot_longer(\n  cols=c(Sim_MSA,Sim_Mun),\n  names_to=\"Method\",\n  values_to=\"Similarity\")\n\nggstatsplot::ggbetweenstats(\n  data = aux,\n  x = Method,\n  y = Similarity)"
  },
  {
    "objectID": "index.html#read-all-graphs-from-a-level-of-the-experiment",
    "href": "index.html#read-all-graphs-from-a-level-of-the-experiment",
    "title": "MetaDAG experiment example",
    "section": "5.1 Read all graphs from a level of the experiment",
    "text": "5.1 Read all graphs from a level of the experiment\nRead all graphs from a level from experiment; for example individuals. We read only firts (alphabetic) two graph\n\npath_exp=\"data/result_bb261b6e-95c6-3e39-b82b-b68eea80e30b/data/\"\nlist_names=dir(paste0(path_exp,\"Individuals/\"))\n\nlist_names= list_names[-1] # filter 0000_RefPw\nlength(list_names)\n\n[1] 884\n\ngraphs_list=paste0(path_exp,\"Individuals/\",\n                   list_names,\"/\",list_names,\n                   \"_MDAG.graphml\")\n\n\nknitr::include_graphics(\n  paste0(path_exp,\"Individuals/cang/cang_RC.pdf\"))"
  },
  {
    "objectID": "index.html#graph-statistics",
    "href": "index.html#graph-statistics",
    "title": "MetaDAG experiment example",
    "section": "5.2 Graph statistics",
    "text": "5.2 Graph statistics\n\nread_mDAG=function(x) {DAG=read.graph(file=x,\n                                  format=\"graphml\")\n  return(DAG)}\nmDAG_componets=function(x) {\n  sort(components(x,mode = \"weak\")$csize,\n       decreasing=TRUE)\n  }\n\ncompo_list=lapply(graphs_list,\n                  FUN=function(x) {\n                    gg=read_mDAG(x)\n                  aux=list(\n                    mDAG_componets=mDAG_componets(gg),\n                    degree_count=igraph::degree(gg,mode=\"total\"))\n                    return(aux)}\n                  )\n\nnames(compo_list)=list_names\nn=max(sapply(compo_list,FUN=function(x) {length(x[[1]])}))\nn\n\n[1] 234\n\nsize_compo_list=lapply(compo_list,FUN=function(x) {\n  return(c(x[[1]],rep(NA,n-length(x[[1]]))))})\n\naux=do.call(bind_cols,size_compo_list)\naux2=pivot_longer(aux,aaf:zvi,names_to=\"Organism\",\n                  values_to=\"csize\") %&gt;%\n  arrange(Organism,-csize)\naux2$index=rep(1:n,times=dim(aux)[2])\naux2=aux2 %&gt;%\n  left_join(meta_taxo,by=\"Organism\")\n\n\nOrganism=names(compo_list)\nbig_MBB=function(org){\n  x=Results %&gt;% filter(Organism==org)\n  x=as.character(x[1,5:dim(Results)[2]])\n  x=x[x!=\"NA\"]\n  tt=sort(table(x),decreasing=TRUE)\n  return(tt)\n  }\nbig_MBB_list= lapply(Organism,FUN=function(x) big_MBB(x))\nnMBB=max(sapply(big_MBB_list,FUN=function(x) length(x)))\nnMBB\n\n[1] 1041\n\nbig_MBB_list=lapply(big_MBB_list,\n                    FUN=function(x){\n                      x=c(x,rep(NA,nMBB-length(x)))\n                      return(x)}\n)\nnames(big_MBB_list)=Organism\nbig_MBB_list=do.call(bind_cols,big_MBB_list)\n\nkMBB=nrow(big_MBB_list)\nindex=rep(1:kMBB,times=length(Organism))\n\nbig_MBB_list2=pivot_longer(big_MBB_list,\n                           cols=names(big_MBB_list),\n                           values_to = \"MBBsize\",\n                           names_to = \"Organism\") %&gt;% \n  arrange(Organism,-MBBsize) %&gt;%  \n  mutate(index=index) %&gt;% \n  left_join(meta_taxo,by=\"Organism\")\n\n\n5.2.1 Sizes of MBB for each mDAG\n\nCOLOR_KINGDOM=c(\"red\",\"green\",\"yellow\",\"black\")\ncolors_kingdom=big_MBB_list2 %&gt;%\n  select(Organism,Kingdom) %&gt;%\n  distinct()\n\nnames(COLOR_KINGDOM)=sort(unique(colors_kingdom$Kingdom))\n\np0&lt;-ggplot(data=big_MBB_list2) + \n  geom_line(mapping=aes(x=index,\n                        y=MBBsize,\n                        group = Organism,\n                        color=Kingdom)) + \n  scale_y_continuous(trans='log10') + \n  scale_x_continuous(trans='identity') +\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom]) +\n   ggtitle(\"Plot log-identity of MBB \\n  decreasing index.\") +\n  ylab(\"Log10 MBB size\") + xlab(\"Index\")\n\n\np1&lt;- ggplot(data=big_MBB_list2) + \n  geom_line(mapping=aes(x=index,\n                        y=MBBsize,\n                        group = Organism,color=Kingdom),\n                        na.rm=TRUE) + \n  scale_x_continuous(trans='log10') + \n  scale_y_continuous(trans='log10') +\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom]) +\n   ggtitle(\"Plot log10-log10identity of MBB \\n  decreasing index.\") +\n  ylab(\"Log10 MBB size\") + xlab(\"Log10 Index\")\n\np2&lt;- ggplot(data=big_MBB_list2) + \n  geom_line(mapping=aes(x=index,\n                        y=MBBsize,\n                        group = Organism, \n                        color=Kingdom),\n            na.rm=TRUE)+\n   scale_x_continuous(trans=\"identity\") + \n   scale_y_continuous(trans=\"identity\") + \n  ylim(0,1039)+ \n  ggtitle(\"Plot  of MBB sized  decreasing index.\") +\n  ylab(\"MBB size\") + xlab(\"Index\") +\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom])\n\n\np0\n\n\n\np1\n\n\n\np2\n\n\n\n\n\n\n5.2.2 Sizes of weak components for each mDAG\n\nCOLOR_KINGDOM=c(\"red\",\"yellow\",\"green\",\"yellow\",\"black\")\ncolors_kingdom=aux2%&gt;% select(Organism,Kingdom) %&gt;% distinct()\nnames(COLOR_KINGDOM)=sort(unique(colors_kingdom$Kingdom))\n\np0&lt;-ggplot(data=aux2) + \n  geom_line(mapping=aes(x=index,\n                        y=csize,\n                        group = Organism,\n                        color=Kingdom),\n            na.rm=TRUE) + \n  scale_x_continuous(trans='log10') + \n  scale_y_continuous(trans='identity') +\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom]) +\n   ggtitle(\"Plot log-identity of size  weak components decreasing index.\") +\n  ylab(\"Log10 Weak componente size\") + xlab(\"Index\")\n\n\np1&lt;- ggplot(data=aux2) + \n  geom_line(mapping=aes(x=index,\n                        y=csize,group = Organism,\n                        color=Kingdom),\n            na.rm=TRUE) + \n  scale_y_continuous(trans='log10') + \n  scale_x_continuous(trans='log10') +\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom])+\n   ggtitle(\"Plot log-log of size  weak components decreasing index.\") +\n  ylab(\"Log10 weak component size\") + xlab(\"Log10 Index\")\n\np2&lt;- ggplot(data=aux2) + \n  geom_line(mapping=aes(x=index,\n                        y=csize,group = Organism,\n                        color=Kingdom),\n            na.rm=TRUE) + \n   scale_x_continuous(trans=\"identity\") + \n  scale_y_continuous(trans=\"identity\") +\n  ylim(0,1039)+\n   ggtitle(\"Plot  of size  weak components decreasing index.\")+\n  ylab(\"Weak components size\") + xlab(\"Index\")+\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom])\n\n\np0\n\n\n\np1\n\n\n\np2\n\n\n\n\n\ndata2=big_MBB_list2 %&gt;% filter(index %in% 2:20)\np3&lt;- ggplot(data=data2) + \n  geom_line(mapping=aes(x=index,\n                        y=MBBsize,\n                        group = Organism,\n                        color=Kingdom),\n            na.rm=TRUE)+\n  scale_x_continuous(trans=\"identity\") + \n  scale_y_continuous(trans=\"identity\") +\n  ylim(0,25)+\n  ggtitle(\"Plot  of size  weak components  decreasing index 2 to 20.\")+\n  ylab(\"Weak components size\") + xlab(\"Index\")+\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom])\n\np3"
  },
  {
    "objectID": "index.html#comparison-cores-all-algaes-fungi-and-archaea",
    "href": "index.html#comparison-cores-all-algaes-fungi-and-archaea",
    "title": "MetaDAG experiment example",
    "section": "5.3 Comparison core’s all algaes, fungi and archaea",
    "text": "5.3 Comparison core’s all algaes, fungi and archaea\n\nreactions=names(Results)[-c(1:4)]\ncores=tibble(reactions)\ncores=cores %&gt;%  separate(reactions, into=c(\"reactions\",\"enzyme\"),sep=\"\\\\(\")\n\ncores= cores %&gt;% separate(reactions,into=c(\"reactions\",\"reactions2\"),sep=\"\\\\|\",fill = \"right\")\n   \n\ncores$enzyme=gsub(\"\\\\(|\\\\)\",replacement = \"\",cores$enzyme)\ncores\n\n# A tibble: 3,993 × 3\n   reactions  reactions2 enzyme \n   &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;  \n 1 R00710     &lt;NA&gt;       1.2.1.3\n 2 R00710_rev &lt;NA&gt;       1.2.1.3\n 3 R00711     &lt;NA&gt;       1.2.1.5\n 4 R00711_rev &lt;NA&gt;       1.2.1.5\n 5 R00755     &lt;NA&gt;       4.1.1.1\n 6 R00746     &lt;NA&gt;       1.1.1.2\n 7 R00746_rev &lt;NA&gt;       1.1.1.2\n 8 R00754     &lt;NA&gt;       1.1.1.1\n 9 R00754_rev &lt;NA&gt;       1.1.1.1\n10 R00014     &lt;NA&gt;       4.1.1.1\n# ℹ 3,983 more rows\n\n#algae_core=\n\n\n5.3.1 Comparion 4 kingdoms and 4 cluster for MSA and Munkrest\n\nclust4_MSA2=tibble(mDAG_Id=names(clust4_MSA), clust4_MSA=clust4_MSA)\nclust4_Mun2=tibble(mDAG_Id=names(clust4_Mun), clust4_Mun=clust4_Mun)\nmeta_taxo2=meta_taxo\nmeta_taxo2=meta_taxo2 %&gt;% left_join(clust4_MSA2,by= \"mDAG_Id\") %&gt;% \n  left_join(clust4_Mun2,by= \"mDAG_Id\")\nmeta_taxo2$combined_cluster_MSA_Kingdom=paste0(meta_taxo2$Kingdom,meta_taxo2$clust4_MSA)\nmeta_taxo2$combined_cluster_Mun_Kingdom=paste0(meta_taxo2$Kingdom,meta_taxo2$clust4_MSA)\nwrite.csv(meta_taxo2,file=\"meta_taxo_4_clusters.csv\")\n\n\nknitr::kable(table(meta_taxo2$Kingdom,meta_taxo2$clust4_MSA))\n\n\n\n\n\n1\n2\n3\n4\n\n\n\n\nAnimals\n331\n195\n9\n0\n\n\nFungi\n0\n0\n154\n0\n\n\nPlants\n0\n0\n14\n125\n\n\nProtists\n0\n0\n56\n0\n\n\n\n\n\n\nknitr::kable(table(meta_taxo2$Kingdom,meta_taxo2$clust4_Mun))\n\n\n\n\n\n1\n2\n3\n4\n\n\n\n\nAnimals\n331\n197\n7\n0\n\n\nFungi\n0\n0\n154\n0\n\n\nPlants\n0\n0\n14\n125\n\n\nProtists\n0\n0\n56\n0\n\n\n\n\n\n\nknitr::kable(table(meta_taxo2$clust4_Mun,meta_taxo2$clust4_MSA))\n\n\n\n\n1\n2\n3\n4\n\n\n\n\n331\n0\n0\n0\n\n\n0\n195\n2\n0\n\n\n0\n0\n231\n0\n\n\n0\n0\n0\n125\n\n\n\n\n\n\n\n\nlibrary(reshape2)\nMSA_table=melt(table(meta_taxo2$Kingdom,meta_taxo2$Phylum,meta_taxo2$clust4_MSA))\nnames(MSA_table)=c(\"Kingdom\",\"Phylum\",\"cluster_MSA\",\"N\")\nMSA_table=MSA_table %&gt;% filter(N!=0)\n\n\nknitr::kable(MSA_table)\n\n\n\n\nKingdom\nPhylum\ncluster_MSA\nN\n\n\n\n\nAnimals\nVertebrates\n1\n331\n\n\nAnimals\nAnnelids\n2\n1\n\n\nAnimals\nArthropods\n2\n158\n\n\nAnimals\nBrachiopodas\n2\n1\n\n\nAnimals\nCephalochordates\n2\n2\n\n\nAnimals\nCnidarians\n2\n10\n\n\nAnimals\nEchinoderms\n2\n3\n\n\nAnimals\nHemichordates\n2\n1\n\n\nAnimals\nMollusks\n2\n14\n\n\nAnimals\nNematodes\n2\n1\n\n\nAnimals\nPlacozoans\n2\n1\n\n\nAnimals\nPoriferans\n2\n1\n\n\nAnimals\nTunicates\n2\n2\n\n\nProtists\nAlveolates\n3\n25\n\n\nProtists\nAmoebozoa\n3\n7\n\n\nFungi\nAscomycetes\n3\n113\n\n\nFungi\nBasidiomycetes\n3\n36\n\n\nProtists\nChoanoflagellates\n3\n2\n\n\nProtists\nCryptomonads\n3\n1\n\n\nProtists\nEuglenozoa\n3\n9\n\n\nAnimals\nFlatworms\n3\n4\n\n\nPlants\nGreen\n3\n11\n\n\nProtists\nHaptophyta\n3\n1\n\n\nProtists\nHeterolobosea\n3\n1\n\n\nProtists\nMetamonada\n3\n2\n\n\nFungi\nMicrosporidians\n3\n5\n\n\nAnimals\nNematodes\n3\n5\n\n\nPlants\nRed\n3\n3\n\n\nProtists\nStramenopiles\n3\n8\n\n\nPlants\nBasal\n4\n2\n\n\nPlants\nEudicots\n4\n98\n\n\nPlants\nFerns\n4\n1\n\n\nPlants\nMonocots\n4\n23\n\n\nPlants\nMosses\n4\n1"
  },
  {
    "objectID": "index.html#comparison-cores-all-algaes-fungi-and-archaea-1",
    "href": "index.html#comparison-cores-all-algaes-fungi-and-archaea-1",
    "title": "MetaDAG experiment example",
    "section": "5.4 Comparison core’s all algaes, fungi and archaea",
    "text": "5.4 Comparison core’s all algaes, fungi and archaea\n\nreactions=names(Results)[-c(1:4)]\ncores=tibble(reactions)\ncores=cores %&gt;%  separate(reactions, into=c(\"reactions\",\"enzyme\"),sep=\"\\\\(\")\n\n#cores= cores %&gt;% separate(reactions,into=c(\"reactions\",\"reactions2\"),sep=\"\\\\|\",fill = \"right\")\n   \n\ncores$enzyme=gsub(\"\\\\(|\\\\)\",replacement = \"\",cores$enzyme)\ncores\n\n# A tibble: 3,993 × 2\n   reactions  enzyme \n   &lt;chr&gt;      &lt;chr&gt;  \n 1 R00710     1.2.1.3\n 2 R00710_rev 1.2.1.3\n 3 R00711     1.2.1.5\n 4 R00711_rev 1.2.1.5\n 5 R00755     4.1.1.1\n 6 R00746     1.1.1.2\n 7 R00746_rev 1.1.1.2\n 8 R00754     1.1.1.1\n 9 R00754_rev 1.1.1.1\n10 R00014     4.1.1.1\n# ℹ 3,983 more rows\n\n#algae_core=\n\n\nResults\n\n# A tibble: 884 × 3,997\n   Organism Categories mDAG_Id Full_Name `R00710(1.2.1.3)` `R00710_rev(1.2.1.3)`\n   &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;             &lt;chr&gt;                \n 1 aaf      Protists|… 0036    Aureococ… 0.0.15            0.0.15               \n 2 aag      Animals|A… 0035    Aedes ae… 0.2.33.36.14      0.2.33.36.14         \n 3 aalb     Animals|A… 0276    Aedes al… 0.2.33.36.18      0.2.33.36.18         \n 4 aali     Animals|A… 0267    Anophele… 0.2.33.36.65      0.2.33.36.65         \n 5 aalt     Fungi|Asc… 0240    Alternar… 0.3.5.6.7         0.3.5.6.7            \n 6 aam      Animals|V… 0040    Apteryx … 0.2.40.15.46      0.2.40.15.46         \n 7 aamp     Animals|V… 0313    Arvicola… 0.2.40.18.2.0     0.2.40.18.2.0        \n 8 aang     Animals|V… 0317    Anguilla… 0.2.40.17.0.0     0.2.40.17.0.0        \n 9 aara     Animals|A… 0362    Anophele… 0.2.33.36.34      0.2.33.36.34         \n10 abe      Fungi|Asc… 0060    Trichoph… 0.3.5.7.0         0.3.5.7.0            \n# ℹ 874 more rows\n# ℹ 3,991 more variables: `R00711(1.2.1.5)` &lt;chr&gt;, `R00711_rev(1.2.1.5)` &lt;chr&gt;,\n#   `R00755(4.1.1.1)` &lt;chr&gt;, `R00746(1.1.1.2)` &lt;chr&gt;,\n#   `R00746_rev(1.1.1.2)` &lt;chr&gt;, `R00754(1.1.1.1)` &lt;chr&gt;,\n#   `R00754_rev(1.1.1.1)` &lt;chr&gt;, `R00014(4.1.1.1)` &lt;chr&gt;,\n#   `R00014(1.2.4.1)` &lt;chr&gt;, `R03270(1.2.4.1)` &lt;chr&gt;, `R02569(2.3.1.12)` &lt;chr&gt;,\n#   `R02569_rev(2.3.1.12)` &lt;chr&gt;, `R00703(1.1.1.27)` &lt;chr&gt;, …\n\ncores\n\n# A tibble: 3,993 × 2\n   reactions  enzyme \n   &lt;chr&gt;      &lt;chr&gt;  \n 1 R00710     1.2.1.3\n 2 R00710_rev 1.2.1.3\n 3 R00711     1.2.1.5\n 4 R00711_rev 1.2.1.5\n 5 R00755     4.1.1.1\n 6 R00746     1.1.1.2\n 7 R00746_rev 1.1.1.2\n 8 R00754     1.1.1.1\n 9 R00754_rev 1.1.1.1\n10 R00014     4.1.1.1\n# ℹ 3,983 more rows\n\nmeta_taxo\n\n# A tibble: 884 × 8\n   Organism Kingdom Phylum      Class   mDAG_Id Full_Name Freq_Phylum Freq_Class\n   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;table[1d]&gt; &lt;table[1d&gt;\n 1 aamp     Animals Vertebrates Mammals 0313    Arvicola… 331         139       \n 2 afz      Animals Vertebrates Mammals 0143    Antechin… 331         139       \n 3 ajm      Animals Vertebrates Mammals 0221    Artibeus… 331         139       \n 4 aju      Animals Vertebrates Mammals 0224    Acinonyx… 331         139       \n 5 aml      Animals Vertebrates Mammals 0279    Ailuropo… 331         139       \n 6 anu      Animals Vertebrates Mammals 0310    Arvicant… 331         139       \n 7 bacu     Animals Vertebrates Mammals 0600    Balaenop… 331         139       \n 8 bbis     Animals Vertebrates Mammals 0193    Bison bi… 331         139       \n 9 bbub     Animals Vertebrates Mammals 0416    Bubalus … 331         139       \n10 biu      Animals Vertebrates Mammals 0622    Bos indi… 331         139       \n# ℹ 874 more rows\n\ncores_names=unique(meta_taxo2$combined_cluster_MSA_Kingdom)\ncores_names\n\n[1] \"Animals1\"  \"Animals2\"  \"Animals3\"  \"Fungi3\"    \"Plants4\"   \"Plants3\"  \n[7] \"Protists3\"\n\ncores_combi=function(x){\n#x=cores_names[º]  \nId=meta_taxo2 %&gt;% filter(combined_cluster_MSA_Kingdom==x) %&gt;% select(mDAG_Id)\nId=as.character(Id$mDAG_Id)\nbin_NA=function(x) {case_when(is.na(x) ~ 0, !is.na(x) ~ 1)}\nmda_filter= Results %&gt;%\n  filter(mDAG_Id %in% Id)%&gt;%\n  select(starts_with(\"R\")) %&gt;%   \n  mutate_all(bin_NA) \n#%&gt;%\n# mutate(mDag_id=Id,.before=1)\naux=colSums(mda_filter)\naux=case_when(aux&gt;0 ~ 1, aux==0~0)\nreturn(aux)\n}\ncores_list=lapply(cores_names,cores_combi)\n\naux=cores_list  %&gt;% as_tibble(.name_repair =\"universal\")\nnames(aux)=cores_names\ncores = cbind(cores,aux)\n\n\nA2_A_3_F3=  cores$Animals2*cores$Animals3-cores$Animals3*cores$Fungi3\n#cores[A2_A_3_F3==1,]\n#cores[A2_A_3_F3==-1,]"
  }
]