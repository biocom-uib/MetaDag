[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "",
    "text": "1 Load data\nexperiment=\n  \"result_0a845f74-826e-3b46-aed9-e7ecf74db262/\"\npath_exp=paste0(\"data/\",experiment)\nknitr::kable(data.frame(\n  Directory_files_and_folders=dir(path_exp),\n  Type=c(rep(\"Data file\",2),\n  rep(\"Directory\",3),\n  rep(\"Data file\",6),\n  \"Directory\")))\n\n\n\n\nDirectory_files_and_folders\nType\n\n\n\n\nDifferent_MBB.csv\nData file\n\n\nDifferent_mDAG.csv\nData file\n\n\nGlobal\nDirectory\n\n\nGroups\nDirectory\n\n\nIndividuals\nDirectory\n\n\nReport.pdf\nData file\n\n\nResults.csv\nData file\n\n\nSimilarities_MBB_MSAMethod.csv\nData file\n\n\nSimilarities_MBB_MunkresMethod.csv\nData file\n\n\nSimilarities_mDAG_MSAMethod.csv\nData file\n\n\nSimilarities_mDAG_MunkresMethod.csv\nData file\n\n\nTaxonomyLevels\nDirectory\nMBB=read_csv(paste0(path_exp,\"Different_MBB.csv\"),\n             show_col_types = FALSE)\nmDAG=read_csv(paste0(path_exp,\"Different_mDAG.csv\"),\n              show_col_types = FALSE)\nResults=read_csv(paste0(path_exp,\"Results.csv\"),\n                 show_col_types = FALSE)\nsave(MBB,mDAG,Results,\n     file=\"MBB_mDag_Results.Rdata\")\nSome analysis examples of generated graphs in GraphML format.\nWe will first load the metadata and adapt them to the structure of the similarities to facilitate the creation of the graphs and statistics.\nRemenber de path of the experiment:\npath_exp\n\n[1] \"data/result_0a845f74-826e-3b46-aed9-e7ecf74db262/\"\nlibrary(dendextend)\nlibrary(ggraph)\nlibrary(ape)\n\nD=as.dist(sqrt(1-Sim_MSA_mDAG^2))\nhc_MSA=hclust(as.dist(D),method =\"ward.D\")\nlibrary(circlize)\ncirclize_dendrogram(as.dendrogram(hc_MSA))\nclust4_MSA=cutree(hc_MSA,4)\ntable(clust4_MSA,meta_taxo$Kingdom[1:884])\n\n          \nclust4_MSA Animals Fungi Plants Protists\n         1     331     0      0        0\n         2     197     0      0        0\n         3       7   154     14       56\n         4       0     0    125        0\nclust5_MSA=cutree(hc_MSA,5)\ntable(clust5_MSA,meta_taxo$Kingdom[1:884])\n\n          \nclust5_MSA Animals Fungi Plants Protists\n         1     129     0      0        0\n         2     202     0      0        0\n         3     197     0      0        0\n         4       7   154     14       56\n         5       0     0    125        0\nclust6_MSA=cutree(hc_MSA,6)\ntable(clust6_MSA,meta_taxo$Kingdom[1:884])\n\n          \nclust6_MSA Animals Fungi Plants Protists\n         1     129     0      0        0\n         2     202     0      0        0\n         3     197     0      0        0\n         4       7   149     14       34\n         5       0     5      0       22\n         6       0     0    125        0\naux=meta_taxo[1:884,] %&gt;%\n  select(Organism,Kingdom,Phylum,Class,Full_Name)\naux$clust4_MSA=clust4_MSA\naux_Animals_cluster_1_2 = aux %&gt;%\n  filter(Kingdom==\"Animals\",clust4_MSA %in% c(1,2))\n\ntable(aux_Animals_cluster_1_2$Phylum,aux_Animals_cluster_1_2$clust4_MSA)\n\n                  \n                     1   2\n  Annelids           0   1\n  Arthropods         0 158\n  Brachiopodas       0   1\n  Cephalochordates   0   2\n  Cnidarians         0  10\n  Echinoderms        0   3\n  Hemichordates      0   1\n  Mollusks           0  14\n  Nematodes          0   3\n  Placozoans         0   1\n  Poriferans         0   1\n  Tunicates          0   2\n  Vertebrates      331   0\n\naux_9_Animals_cluster_3= filter(aux,\n                                clust4_MSA==3,\n                                Kingdom==\"Animals\")\naux_9_Animals_cluster_3\n\n# A tibble: 7 × 6\n  Organism Kingdom Phylum    Class     Full_Name                      clust4_MSA\n  &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                               &lt;int&gt;\n1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                 3\n2 loa      Animals Nematodes Nematodes Loa loa (eye worm)                      3\n3 tsp      Animals Nematodes Nematodes Trichinella spiralis                    3\n4 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyda…          3\n5 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (South…          3\n6 shx      Animals Flatworms Flatworms Schistosoma haematobium (urin…          3\n7 smm      Animals Flatworms Flatworms Schistosoma mansoni                     3\n\naux_all_Nematodes_Flatworns= aux %&gt;% \n  filter(Kingdom==\"Animals\",\n         Phylum %in% c(\"Nematodes\",\"Flatworms\"))\naux_all_Nematodes_Flatworns\n\n# A tibble: 10 × 6\n   Organism Kingdom Phylum    Class     Full_Name                     clust4_MSA\n   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                              &lt;int&gt;\n 1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                3\n 2 cbr      Animals Nematodes Nematodes Caenorhabditis briggsae (nem…          2\n 3 cel      Animals Nematodes Nematodes Caenorhabditis elegans (nema…          2\n 4 loa      Animals Nematodes Nematodes Loa loa (eye worm)                     3\n 5 nai      Animals Nematodes Nematodes Necator americanus (New Worl…          2\n 6 tsp      Animals Nematodes Nematodes Trichinella spiralis                   3\n 7 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyd…          3\n 8 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (Sout…          3\n 9 shx      Animals Flatworms Flatworms Schistosoma haematobium (uri…          3\n10 smm      Animals Flatworms Flatworms Schistosoma mansoni                    3\n\naux_14_Plants_clust2= filter(aux,clust4_MSA==3,\n                             Kingdom==\"Plants\")\naux_14_Plants_clust2\n\n# A tibble: 14 × 6\n   Organism Kingdom Phylum Class Full_Name                      clust4_MSA\n   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                               &lt;int&gt;\n 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3\n 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3\n 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3\n 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3\n 5 cvr      Plants  Green  algae Chlorella variabilis                    3\n 6 mis      Plants  Green  algae Micromonas commoda                      3\n 7 mng      Plants  Green  algae Monoraphidium neglectum                 3\n 8 mpp      Plants  Green  algae Micromonas pusilla                      3\n 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3\n10 ota      Plants  Green  algae Ostreococcus tauri                      3\n11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3\n12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3\n13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3\n14 gsl      Plants  Red    algae Galdieria sulphuraria                   3\n\naux_all_algae_class= aux %&gt;% \n  filter(Kingdom==\"Plants\",\n         Class %in% c(\"algae\"))\naux_all_algae_class\n\n# A tibble: 14 × 6\n   Organism Kingdom Phylum Class Full_Name                      clust4_MSA\n   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                               &lt;int&gt;\n 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3\n 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3\n 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3\n 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3\n 5 cvr      Plants  Green  algae Chlorella variabilis                    3\n 6 mis      Plants  Green  algae Micromonas commoda                      3\n 7 mng      Plants  Green  algae Monoraphidium neglectum                 3\n 8 mpp      Plants  Green  algae Micromonas pusilla                      3\n 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3\n10 ota      Plants  Green  algae Ostreococcus tauri                      3\n11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3\n12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3\n13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3\n14 gsl      Plants  Red    algae Galdieria sulphuraria                   3\nThe hierarchical classification by Ward’s method recovers the kingdom Animal clusters 1 (all vertebrates) and 2 (invertebrate animals), cluster 4 the Plants and in cluster 3 are all protists and fungi together with 9 animals and 14 plants.\nThe 9 Animals are all from the Phylum Nematodes or Flatworns, out of the total of the 10 species of these phylums considered in the experiment. Only the Nematode Necator americanus (New World hookworm) is classified in Animals.\nThe 14 plants in cluster 2 are all algae considered in the experiment.\nSome statistics for graphs\nreactions=names(Results)\nreactions=reactions[grep(\"(^R\\\\d{5})\",reactions)]\nreactions=tibble(reactions)\nreactions=reactions %&gt;% separate(reactions, into=c(\"r_id\",\"enzyme\"),sep=\"\\\\(\",remove=FALSE)\nreactions=reactions %&gt;% mutate(enzyme=gsub(\"\\\\(|\\\\)\",\"\",enzyme))\n#reactions=reactions[,-3]\nreactions$rev=stringr::str_detect(reactions$r_id,\"v\")"
  },
  {
    "objectID": "index.html#table-of-mbbs",
    "href": "index.html#table-of-mbbs",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "1.1 Table of MBBs",
    "text": "1.1 Table of MBBs\nIn this example MBB is a table with 5149 rows and 4122 columns. It shows, for every MBB, the selected groups (Kingdoms, families, etc.) where it appears.\n\n#100\nknitr::kable(MBB[1:20,1:10]) %&gt;%   \n  scroll_box(width = \"100%\", height = \"200px\")\n\n\n\n\n\nMBB Id\nnatural\n#pathways\nProtists\nFungi\nPlants\nAnimals\nAlveolates\nAmoebozoa\nAnnelids\n\n\n\n\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n0.0.0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n0.0.0.0\n1\n1\n0\n0\n0\n1\n0\n0\n0\n\n\n0.0.0.0.0\n1\n1\n0\n0\n0\n1\n0\n0\n0\n\n\n0.0.0.0.0.0\n1\n1\n0\n0\n0\n1\n0\n0\n0\n\n\n0.0.0.1\n1\n1\n0\n0\n0\n1\n0\n0\n0\n\n\n0.0.0.2\n1\n1\n0\n0\n0\n1\n0\n0\n0\n\n\n0.0.1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n0.0.1.0\n1\n1\n0\n0\n0\n1\n0\n0\n1\n\n\n0.0.1.1\n1\n1\n1\n0\n0\n0\n0\n0\n0\n\n\n0.0.1.1.0\n1\n1\n1\n0\n0\n0\n0\n0\n0\n\n\n0.0.1.2\n1\n1\n0\n0\n0\n1\n0\n0\n0\n\n\n0.0.1.3\n1\n1\n0\n0\n0\n1\n0\n0\n0\n\n\n0.0.1.4\n1\n1\n0\n0\n0\n1\n0\n0\n0\n\n\n0.0.1.4.0\n1\n1\n0\n0\n0\n1\n0\n0\n0\n\n\n0.0.1.4.0.0\n1\n1\n0\n0\n0\n1\n0\n0\n0\n\n\n0.0.1.5\n1\n1\n1\n0\n0\n0\n0\n0\n0\n\n\n0.0.1.6\n1\n4\n3\n0\n0\n1\n0\n0\n0\n\n\n0.0.1.6.0\n1\n3\n0\n0\n3\n0\n0\n0\n0"
  },
  {
    "objectID": "index.html#table-of-m-dags",
    "href": "index.html#table-of-m-dags",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "1.2 Table of m-DAGs",
    "text": "1.2 Table of m-DAGs\nIn this example mDAG is a table with 884 rows and 5278 columns. It shows, for every m-DAG, the selected groups (Kingdoms, families, etc.) where it belongs.\n\nkable(mDAG[1:20,1:10]) %&gt;%   scroll_box(width = \"100%\", height = \"200px\")\n\n\n\n\n\nmDAG Id\n#Categories\nAnimals\nPlants\nFungi\nProtists\nAlveolates\nAmoebozoa\nAnnelids\nArthropods\n\n\n\n\n0001\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0002\n2\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n0003\n2\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0004\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0005\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0006\n3\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n0007\n2\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n0008\n3\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n0009\n3\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n0010\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0011\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0012\n3\n0\n0\n0\n1\n0\n0\n0\n0\n\n\n0013\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0014\n3\n0\n0\n0\n1\n1\n0\n0\n0\n\n\n0015\n2\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n0016\n3\n0\n0\n0\n1\n0\n1\n0\n0\n\n\n0017\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0018\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n0019\n3\n1\n0\n0\n0\n0\n0\n0\n1\n\n\n0020\n3\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n\ndim(mDAG)\n\n[1]  884 5278\n\nnames(mDAG)[1:6]\n\n[1] \"mDAG Id\"     \"#Categories\" \"Animals\"     \"Plants\"      \"Fungi\"      \n[6] \"Protists\"   \n\nhead(names(mDAG)[7:(dim(mDAG)[2]-1150)])\n\n[1] \"Alveolates\"        \"Amoebozoa\"         \"Annelids\"         \n[4] \"Arthropods\"        \"Ascomycetes\"       \"Basal angiosperms\"\n\n# 28 to 1213  code MBB: 1 if MBB in mDAG 0"
  },
  {
    "objectID": "index.html#results-table",
    "href": "index.html#results-table",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "1.3 Results Table",
    "text": "1.3 Results Table\nTabular data Results contains for every organism (row), its category (taxonomy), selected group, Full name, m-DAG id and all reactions name id with its enzyme. When the reaction is present in the corresponding m-DAG the MBB where it belongs is shown in this column.\n\nkable(Results[1:20,1:10])%&gt;%\n  row_spec(0, angle = 0) %&gt;%   \n  scroll_box(width = \"300%\", height = \"1000px\")\n\n\n\n\n\norganism\nCategories\nGroups\nmDAG Id\nFull Name\nR00710(1.2.1.3)\nR00710_rev(1.2.1.3)\nR00711(1.2.1.5)\nR00711_rev(1.2.1.5)\nR00755(4.1.1.1)\n\n\n\n\naaf\nProtists|Stramenopiles|Pelagophytes\nMSA Cluster 3|MUN Cluster 3\n0036\nAureococcus anophagefferens\n0.0.10.0.15\n0.0.10.0.15\nNA\nNA\nNA\n\n\naag\nAnimals|Arthropods|Insects\nMSA Cluster 2|MUN Cluster 2\n0035\nAedes aegypti (yellow fever mosquito)\n0.9.27.7.36.14\n0.9.27.7.36.14\nNA\nNA\nNA\n\n\naalb\nAnimals|Arthropods|Insects\nMSA Cluster 2|MUN Cluster 2\n0276\nAedes albopictus (Asian tiger mosquito)\n0.9.27.7.36.18\n0.9.27.7.36.18\nNA\nNA\nNA\n\n\naali\nAnimals|Arthropods|Insects\nMSA Cluster 2|MUN Cluster 2\n0267\nAnopheles albimanus\n0.9.27.7.36.65\n0.9.27.7.36.65\n0.9.27.7.36.65\n0.9.27.7.36.65\nNA\n\n\naalt\nFungi|Ascomycetes|Dothideomycetes\nFungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms\n0240\nAlternaria alternata\n0.0.9.20.0.5.6.7\n0.0.9.20.0.5.6.7\nNA\nNA\n0.0.9.20.0.5.6.7\n\n\naam\nAnimals|Vertebrates|Birds\nCluster 1\n0040\nApteryx mantelli mantelli (North Island brown kiwi)\n0.9.26.15.46\n0.9.26.15.46\n0.9.26.15.46\n0.9.26.15.46\nNA\n\n\naamp\nAnimals|Vertebrates|Mammals\nCluster 1\n0313\nArvicola amphibius (Eurasian water vole)\n0.9.26.18.2.0\n0.9.26.18.2.0\n0.9.26.18.2.0\n0.9.26.18.2.0\nNA\n\n\naang\nAnimals|Vertebrates|Fishes\nCluster 1\n0317\nAnguilla anguilla (European eel)\n0.9.26.17.0.0\n0.9.26.17.0.0\n0.9.26.17.0.0\n0.9.26.17.0.0\nNA\n\n\naara\nAnimals|Arthropods|Insects\nMSA Cluster 2|MUN Cluster 2\n0362\nAnopheles arabiensis\n0.9.27.7.36.34\n0.9.27.7.36.34\n0.9.27.7.36.34\n0.9.27.7.36.34\nNA\n\n\nabe\nFungi|Ascomycetes|Eurotiomycetes\nFungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms\n0060\nTrichophyton benhamiae\n0.0.9.20.0.5.7.0\n0.0.9.20.0.5.7.0\nNA\nNA\n0.0.9.20.0.5.7.0\n\n\nabp\nFungi|Basidiomycetes\nFungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms\n0068\nAgaricus bisporus var. burnettii JB137-S8\n0.0.9.20.0.6.1\n0.0.9.20.0.6.1\nNA\nNA\n0.0.9.20.0.6.1\n\n\nabv\nFungi|Basidiomycetes\nFungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms\n0073\nAgaricus bisporus var. bisporus H97\n0.0.9.20.0.6.3\n0.0.9.20.0.6.3\nNA\nNA\n0.0.9.20.0.6.3\n\n\nacan\nProtists|Amoebozoa|Acanthamoeba\nMSA Cluster 3|MUN Cluster 3\n0873\nAcanthamoeba castellanii\n0.0.10.0.3\n0.0.10.0.3\nNA\nNA\nNA\n\n\nacar\nAnimals|Vertebrates|Birds\nCluster 1\n0884\nAntrostomus carolinensis (chuck-will's-widow)\n0.9.26.15.59\n0.9.26.15.59\n0.9.26.15.59\n0.9.26.15.59\nNA\n\n\nacep\nAnimals|Arthropods|Insects\nMSA Cluster 2|MUN Cluster 2\n0054\nAtta cephalotes (leaf cutting ant)\n0.9.27.7.36.56\n0.9.27.7.36.56\nNA\nNA\nNA\n\n\nacer\nAnimals|Arthropods|Insects\nMSA Cluster 2|MUN Cluster 2\n0057\nApis cerana (Asiatic honeybee)\n0.9.27.7.35.34\n0.9.27.7.35.34\n0.9.27.7.35.34\n0.9.27.7.35.34\nNA\n\n\nachc\nAnimals|Vertebrates|Birds\nCluster 1\n0103\nAquila chrysaetos chrysaetos (golden eagle)\n0.9.26.15.2.0\n0.9.26.15.2.0\n0.9.26.15.2.0\n0.9.26.15.2.0\nNA\n\n\nache\nFungi|Ascomycetes|Eurotiomycetes\nFungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms\n0106\nAspergillus chevalieri\n0.0.9.20.0.5.7.2\n0.0.9.20.0.5.7.2\nNA\nNA\n0.0.9.20.0.5.7.2\n\n\nachl\nAnimals|Vertebrates|Birds\nCluster 1\n0081\nAcanthisitta chloris (rifleman)\n0.9.26.15.1.1.0.0\n0.9.26.15.1.1.0.0\nNA\nNA\nNA\n\n\nacoz\nAnimals|Arthropods|Insects\nMSA Cluster 2|MUN Cluster 2\n0255\nAnopheles coluzzii\n0.9.27.7.36.22\n0.9.27.7.36.22\n0.9.27.7.36.22\n0.9.27.7.36.22\nNA\n\n\n\n\n\n\n\n\ndim(Results)\n\n[1]  884 3998\n\nnames(Results)[1]# organisms  kegg id  class representant of mDAG\n\n[1] \"organism\"\n\nnames(Results)[2]# taxonomy separate by |\n\n[1] \"Categories\"\n\nnames(Results)[3]# groups \n\n[1] \"Groups\"\n\nnames(Results)[4]# mDAG_Id \n\n[1] \"mDAG Id\"\n\nnames(Results)[5]# Full name representant\n\n[1] \"Full Name\"\n\nnames(Results)[6:36]# columns 6 to 3998 \n\n [1] \"R00710(1.2.1.3)\"      \"R00710_rev(1.2.1.3)\"  \"R00711(1.2.1.5)\"     \n [4] \"R00711_rev(1.2.1.5)\"  \"R00755(4.1.1.1)\"      \"R00746(1.1.1.2)\"     \n [7] \"R00746_rev(1.1.1.2)\"  \"R00754(1.1.1.1)\"      \"R00754_rev(1.1.1.1)\" \n[10] \"R00014(4.1.1.1)\"      \"R00014(1.2.4.1)\"      \"R03270(1.2.4.1)\"     \n[13] \"R02569(2.3.1.12)\"     \"R02569_rev(2.3.1.12)\" \"R00703(1.1.1.27)\"    \n[16] \"R00703_rev(1.1.1.27)\" \"R00200(2.7.1.40)\"     \"R00658(4.2.1.11)\"    \n[19] \"R00658_rev(4.2.1.11)\" \"R01518(5.4.2.11)\"     \"R01518_rev(5.4.2.11)\"\n[22] \"R01061(1.2.1.12)\"     \"R01061_rev(1.2.1.12)\" \"R01015(5.3.1.1)\"     \n[25] \"R01015_rev(5.3.1.1)\"  \"R01070(4.1.2.13)\"     \"R01070_rev(4.1.2.13)\"\n[28] \"R04779(2.7.1.11)\"     \"R04780(3.1.3.11)\"     \"R02740(5.3.1.9)\"     \n[31] \"R02740_rev(5.3.1.9)\" \n\n# reactions name id with its enzyme.\n\n\nreactions=names(Results)[-c(1:5)]\nreverse_reactions=stringr::str_detect(reactions,\"rev\")\nreverse_reactions=table(reverse_reactions)\ndimnames(reverse_reactions)$reverse_reactions=\n  c(\"Non reverse reaction\",\"Reverse reaction\")\nreverse_reactions\n\nreverse_reactions\nNon reverse reaction     Reverse reaction \n                3399                  594"
  },
  {
    "objectID": "index.html#read-graph-for-each-organism",
    "href": "index.html#read-graph-for-each-organism",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "2.1 Read graph for each organism",
    "text": "2.1 Read graph for each organism\nRead the individual graphs generated for Homo sapiens (KEGG id: hsa) at directory(Individuals/hsa)\n\nfiles_hsa=dir(paste0(path_exp,\"Individuals/hsa\"))\nfiles_hsa\n\n [1] \"hsa_mDAG.graphml\"       \"hsa_mDAG.pdf\"           \"hsa_mDAG.svg\"          \n [4] \"hsa_mDAG_adj.csv\"       \"hsa_mDAG_biggerDAG.pdf\" \"hsa_mDAG_biggerDAG.svg\"\n [7] \"hsa_mDAG_nl.csv\"        \"hsa_mDAG_structure.csv\" \"hsa_R_adj.csv\"         \n[10] \"hsa_R_nl.csv\"           \"hsa_RC.graphml\"         \"hsa_RC.pdf\"            \n[13] \"hsa_RC.svg\"             \"hsa_summary.txt\"       \n\n\n\n\n\n\n\nfiles_Individual_hsa\nDescription\n\n\n\n\nhsa_mDAG.graphml\nm-DAG GraphML format\n\n\nhsa_mDAG.pdf\nm-DAG pdf graphic\n\n\nhsa_mDAG.svg\nm-DAG svg graphic\n\n\nhsa_mDAG_adj.csv\ncsv file with the adjacency matrix of the m-DAG\n\n\nhsa_mDAG_biggerDAG.pdf\nbigger conected componet of the m-DAG pdf graphic\n\n\nhsa_mDAG_biggerDAG.svg\nbigger conected componet of the m-DAG svg graphic\n\n\nhsa_mDAG_nl.csv\ncsv file with node (MBBs) labels of the m-DAG\n\n\nhsa_mDAG_structure.csv\ncsv file with all connected components of the m-DAG ???????\n\n\nhsa_R_adj.csv\ncsv file with the adjacency matrix of the reaction graph\n\n\nhsa_R_nl.csv\ncsv file with node (reactions) labels of the reaction graph\n\n\nhsa_RC.graphml\nreaction graph GraphML format\n\n\nhsa_RC.pdf\nreaction graph pdf graphic\n\n\nhsa_RC.svg\nreaction graph svg graphic\n\n\nhsa_summary.txt\ntext file with number of nodes, reactions, etc."
  },
  {
    "objectID": "index.html#graphs-topology",
    "href": "index.html#graphs-topology",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "2.2 Graph’s topology",
    "text": "2.2 Graph’s topology\nFrom the GraphML files one can extract topological information such as the nodes degree. The following diagram shows the nodes degree distribution for an m-DAG.\n\ngraph_mDAG=read.graph(\n  paste0(path_exp,\n         \"Individuals/hsa/hsa_mDAG.graphml\"),\n  format= \"graphml\")\nsummary(graph_mDAG)\n\nIGRAPH a39f261 D--- 1026 1086 -- \n+ attr: color (v/c), label (v/c), id (v/c), id (e/c)\n\nbarplot(table(igraph::degree(graph_mDAG,mode=\"all\")),\n              ylim=c(0,350),col=\"blue\",\n              main=\"Frequency of nodes degree\",\n              ylab=\"Frequency\",xlab=\"degree\")"
  },
  {
    "objectID": "index.html#pan-core-metabolic-graphs",
    "href": "index.html#pan-core-metabolic-graphs",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "2.3 Pan & core metabolic graphs",
    "text": "2.3 Pan & core metabolic graphs\nXXXX\n\n2.3.1 Core m-DAG\nThe global core m-DAG, i.e., the core of all organisms in this example is empty.\n\ngraph_core_mDAG=read.graph(\n  paste0(path_exp,\"Global/core/core_mDAG.graphml\"),\n  format = \"graphml\")\nsummary(graph_core_mDAG)\n\nIGRAPH a3bbff3 D--- 0 0 -- \n+ attr: color (v/c), label (v/c), id (v/c)\n\n\nThe core metabolic DAG for the Algae group is:\n\nknitr::include_graphics(paste0(path_exp,                              \"Groups/Algae/core/Algae_core_mDAG.pdf\"))\n\n\n\n\nCore m-DAG for Algae\n\n\n\n\nThe graph core mDAG have 0 vertex and 0, is an empty graph.\n\n\n2.3.2 Core reaction graph (RC)\n\ngraph_core_RC=read.graph(\n  paste0(path_exp,\n         \"Global/core/core_RC.graphml\"),\n  format = \"graphml\")\nsummary(graph_core_mDAG)\n\nIGRAPH a3bbff3 D--- 0 0 -- \n+ attr: color (v/c), label (v/c), id (v/c)\n\n\n\nknitr::include_graphics(\n  paste0(path_exp,\"Groups/MSA_Cluster_3/core/MSA_Cluster_3_core_RC.pdf\"))\n\n\n\n\nCore mDAG is empty\n\n\n\n\nThe graph core reaction graph have 0 vertex and 0, is an empty graph."
  },
  {
    "objectID": "index.html#mdag-global-pan-for-eukaryotes",
    "href": "index.html#mdag-global-pan-for-eukaryotes",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "2.4 mDag Global pan for eukaryotes",
    "text": "2.4 mDag Global pan for eukaryotes\n\n2.4.1 Pan mDAG\n\ngraph_pan_mDAG=read.graph(\n  paste0(path_exp,\n         \"TaxonomyLevels/Kingdom/Animals/pan/Animals_pan_mDAG.graphml\"),\n  format = \"graphml\")\nsummary(graph_pan_mDAG)\n\nIGRAPH a3fdd5f D--- 1184 1261 -- \n+ attr: color (v/c), label (v/c), id (v/c), id (e/c)\n\n\nThe graph pan mDAG have 1184 vertex and 1261.\n\n\n2.4.2 Pan Reaction graph (RC)\n\ngraph_pan_RC=read.graph(\n  paste0(path_exp,\n         \"TaxonomyLevels/Kingdom/Animals/pan/Animals_pan_RC.graphml\"),\n  format = \"graphml\")\nsummary(graph_pan_RC)\n\nIGRAPH a40fe94 D--- 4556 5798 -- \n+ attr: color (v/c), label (v/c), id (v/c), id (e/c)\n\n\nThe graph pan reaction graph have 4556 vertex and 5798.\n\ncompo=components(graph_mDAG,mode = \"weak\")\nstr(compo)\n\nList of 3\n $ membership: num [1:1026] 1 1 1 1 1 1 1 1 1 1 ...\n $ csize     : num [1:167] 589 1 1 1 1 1 4 3 4 3 ...\n $ no        : int 167\n\ncompo$csize\n\n  [1] 589   1   1   1   1   1   4   3   4   3   2   3   3   1   1   1   2   6\n [19]   3   1   3   6   1   1   1   1   1   3   1   6   2   1   1   1   2   1\n [37]   1  14   1  16   1   6   2   2   4   1   1   1   1   1   1   1   1   1\n [55]  13   1   1   1   1   2   6   5   5   2   2  10   1   1   1   2   2   1\n [73]   1   1  62   6   2   1   2   1   1   1   2   1   2  14   3   1   1   1\n [91]   1   1   1   1   1   1   3   6   1   3   1   3   2   1   1   1   2   2\n[109]   3   1   1   2   5   1   1   2   3   2   1   1   2   3   4   1   1   2\n[127]   1   1   2   1   1   1   1   1   3   1   2   2   1   6   1   1   1   2\n[145]   1   1   1   1   1   2   7   1  15   3   1   1   1   1   2   1   3   1\n[163]   1   1   1   1   2\n\nk=which.max(compo$csize==max(compo$csize))\nk\n\n[1] 1\n\ntable(compo$membership)\n\n\n  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20 \n589   1   1   1   1   1   4   3   4   3   2   3   3   1   1   1   2   6   3   1 \n 21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40 \n  3   6   1   1   1   1   1   3   1   6   2   1   1   1   2   1   1  14   1  16 \n 41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60 \n  1   6   2   2   4   1   1   1   1   1   1   1   1   1  13   1   1   1   1   2 \n 61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80 \n  6   5   5   2   2  10   1   1   1   2   2   1   1   1  62   6   2   1   2   1 \n 81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 \n  1   1   2   1   2  14   3   1   1   1   1   1   1   1   1   1   3   6   1   3 \n101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 \n  1   3   2   1   1   1   2   2   3   1   1   2   5   1   1   2   3   2   1   1 \n121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 \n  2   3   4   1   1   2   1   1   2   1   1   1   1   1   3   1   2   2   1   6 \n141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 \n  1   1   1   2   1   1   1   1   1   2   7   1  15   3   1   1   1   1   2   1 \n161 162 163 164 165 166 167 \n  3   1   1   1   1   1   2 \n\nvertex=which(compo$membership==k)\nlength(vertex)\n\n[1] 589\n\nBig_Component=induced_subgraph(graph_mDAG, vids=vertex)\nigraph::vcount(Big_Component)\n\n[1] 589\n\nigraph::ecount(Big_Component)\n\n[1] 774\n\n\nThe curated plot of the bigger component of hsa mDAG\n\nknitr::include_graphics(paste0(path_exp,\n                            \"Individuals/hsa/hsa_mDAG_biggerDAG.pdf\"))"
  },
  {
    "objectID": "index.html#load-meta-data-from-eukariotes-experimet",
    "href": "index.html#load-meta-data-from-eukariotes-experimet",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "3.1 Load meta data from eukariotes experimet",
    "text": "3.1 Load meta data from eukariotes experimet\nMeta data mDa_Id and taxonomy sort by Kingdom,Filum,Class,mDAG_Id\n\npath_exp\n\n[1] \"data/result_0a845f74-826e-3b46-aed9-e7ecf74db262/\"\n\nResults=read_csv(paste0(path_exp,\"Results.csv\"))\n#arreglo los nombres de MEtaDag\nnames(Results)[c(1,2,3,4,5)]=c(\"Organism\",\"Categories\",\"Groups\",\"mDAG_Id\",\"Full_Name\")\ntaxo=Results %&gt;% select(Organism:Full_Name)\ntaxo=taxo %&gt;% separate(Categories,into=c(\"Kingdom\",\"Phylum\",\"Class\"))\nindex=which(is.na(taxo$Class))\ntaxo$Class[index]=paste(taxo$Phylum[index])\nmeta_taxo=taxo\naux=table(meta_taxo$Phylum)\nFreq_Phylum=tibble(Phylum=names(aux),Freq_Phylum=aux)\nnames(Freq_Phylum)=c(\"Phylum\",\"Freq_Phylum\")\naux=table(meta_taxo$Class)\nFreq_Class=tibble(Class=names(aux),Freq_Class=aux)\nnames(Freq_Class)=c(\"Class\",\"Freq_Class\")\n\n\nmeta_taxo = meta_taxo %&gt;% \n  left_join(Freq_Phylum) %&gt;%\n  left_join(Freq_Class)\nmeta_taxo = meta_taxo %&gt;% \n  arrange(Kingdom,desc(Freq_Phylum),Phylum,\n          desc(Freq_Class),Class)\nhead(meta_taxo)\n\n# A tibble: 6 × 9\n  Organism Kingdom Phylum  Class Groups mDAG_Id Full_Name Freq_Phylum Freq_Class\n  &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;     &lt;table[1d]&gt; &lt;table[1d&gt;\n1 aamp     Animals Verteb… Mamm… Clust… 0313    Arvicola… 331         139       \n2 afz      Animals Verteb… Mamm… Clust… 0143    Antechin… 331         139       \n3 ajm      Animals Verteb… Mamm… Clust… 0221    Artibeus… 331         139       \n4 aju      Animals Verteb… Mamm… Clust… 0224    Acinonyx… 331         139       \n5 aml      Animals Verteb… Mamm… Clust… 0279    Ailuropo… 331         139       \n6 anu      Animals Verteb… Mamm… Clust… 0310    Arvicant… 331         139       \n\n\n\ntable(meta_taxo$Kingdom) %&gt;% kable %&gt;%\n  kable_styling(\"striped\", full_width = F,position=\"left\")%&gt;% \n scroll_box(width = \"400px\", height = \"200px\")\n\n\n\n\n\nVar1\nFreq\n\n\n\n\nAnimals\n535\n\n\nFungi\n154\n\n\nPlants\n139\n\n\nProtists\n56\n\n\n\n\n\n\ntable(meta_taxo$Phylum,meta_taxo$Kingdom) %&gt;% kable %&gt;%\n  kable_styling(\"striped\", full_width = F,position=\"left\")%&gt;% \n scroll_box(width = \"500px\", height = \"500px\")\n\n\n\n\n\n\nAnimals\nFungi\nPlants\nProtists\n\n\n\n\nAlveolates\n0\n0\n0\n25\n\n\nAmoebozoa\n0\n0\n0\n7\n\n\nAnnelids\n1\n0\n0\n0\n\n\nArthropods\n158\n0\n0\n0\n\n\nAscomycetes\n0\n113\n0\n0\n\n\nBasal\n0\n0\n2\n0\n\n\nBasidiomycetes\n0\n36\n0\n0\n\n\nBrachiopodas\n1\n0\n0\n0\n\n\nCephalochordates\n2\n0\n0\n0\n\n\nChoanoflagellates\n0\n0\n0\n2\n\n\nCnidarians\n10\n0\n0\n0\n\n\nCryptomonads\n0\n0\n0\n1\n\n\nEchinoderms\n3\n0\n0\n0\n\n\nEudicots\n0\n0\n98\n0\n\n\nEuglenozoa\n0\n0\n0\n9\n\n\nFerns\n0\n0\n1\n0\n\n\nFlatworms\n4\n0\n0\n0\n\n\nGreen\n0\n0\n11\n0\n\n\nHaptophyta\n0\n0\n0\n1\n\n\nHemichordates\n1\n0\n0\n0\n\n\nHeterolobosea\n0\n0\n0\n1\n\n\nMetamonada\n0\n0\n0\n2\n\n\nMicrosporidians\n0\n5\n0\n0\n\n\nMollusks\n14\n0\n0\n0\n\n\nMonocots\n0\n0\n23\n0\n\n\nMosses\n0\n0\n1\n0\n\n\nNematodes\n6\n0\n0\n0\n\n\nPlacozoans\n1\n0\n0\n0\n\n\nPoriferans\n1\n0\n0\n0\n\n\nRed\n0\n0\n3\n0\n\n\nStramenopiles\n0\n0\n0\n8\n\n\nTunicates\n2\n0\n0\n0\n\n\nVertebrates\n331\n0\n0\n0"
  },
  {
    "objectID": "index.html#similarities-msamunkres-methods",
    "href": "index.html#similarities-msamunkres-methods",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "3.2 Similarities MSA,Munkres methods",
    "text": "3.2 Similarities MSA,Munkres methods\nIn this section we will show the similarities between mDAG’s using different methods.\nThe experiment data set consists of 1132 eurkaryotes from the animal, plant, fungus, and protist kingdoms.\n\n\n\n\n\nKingdom\nAbs. Freq.\n\n\n\n\nAnimals\n535\n\n\nFungi\n154\n\n\nPlants\n139\n\n\nProtists\n56\n\n\n\n\n\n\n\n\nlist_Sim=dir(path_exp,pattern=\"^Similarities\")\nlist_Sim\n\n[1] \"Similarities_MBB_MSAMethod.csv\"      \"Similarities_MBB_MunkresMethod.csv\" \n[3] \"Similarities_mDAG_MSAMethod.csv\"     \"Similarities_mDAG_MunkresMethod.csv\"\n\n\nLoad MDAG similarities\n\nSim_MSA_mDAG=read_csv(paste0(path_exp,\n                             \"Similarities_mDAG_MSAMethod.csv\"))\nSim_MSA_mDAG=as.matrix(Sim_MSA_mDAG[,-1])\nrownames(Sim_MSA_mDAG)=colnames(Sim_MSA_mDAG)\nSim_MSA_mDAG=Sim_MSA_mDAG[meta_taxo$mDAG_Id[1:884],\n                          meta_taxo$mDAG_Id[1:884]]\n\n\nSim_Mun_mDAG=read_csv(paste0(path_exp,\"Similarities_mDAG_MunkresMethod.csv\"))\nSim_Mun_mDAG=as.matrix(Sim_Mun_mDAG[,-1])\nrownames(Sim_Mun_mDAG)=colnames(Sim_Mun_mDAG)\nSim_Mun_mDAG=Sim_Mun_mDAG[meta_taxo$mDAG_Id[1:884],meta_taxo$mDAG_Id[1:884]]"
  },
  {
    "objectID": "index.html#heatmaps",
    "href": "index.html#heatmaps",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "3.3 Heatmaps",
    "text": "3.3 Heatmaps\n\n3.3.1 Heatmap Similarity MSA and Munkres method\n\ndff&lt;-meta_taxo[1:884,] %&gt;% select(Kingdom)  %&gt;% as.data.frame()\ncolorsK &lt;- list(Kingdom= c(\"Animals\"=\"red\",\n                           \"Plants\"=\"green\",\n                           \"Fungi\"=\"yellow\",\n                           \"Protists\"=\"black\"))\nannotationK &lt;- HeatmapAnnotation(df=dff, col = colorsK,show_legend = TRUE)\n\nMSA_heat_1 &lt;- Heatmap(matrix = Sim_MSA_mDAG, \n                      column_title=\n                        \"m-DAGs MSA-similarity Eukaryotes by Kingdoms\",\n                      heatmap_legend_param=list(\n                        title=\"Similarity\",\n                        at = seq(0,1,by=0.1)),\n                      col=rev(viridis(256)),\n                      cluster_rows = FALSE,\n                      cluster_columns = FALSE,\n                      top_annotation = annotationK,\n                      show_column_names = FALSE, \n                      show_row_names = FALSE,\n                      left_annotation =\n                        rowAnnotation(df = dff,\n                                      col = colorsK,\n                                    show_annotation_name=FALSE,\n                                    show_legend=FALSE\n                                      ))\n\n\n\n\n\n\n\nMun_heat_1&lt;- Heatmap(matrix = Sim_Mun_mDAG, \n             column_title=\"mDAGs Munkres-similarity  Eukaryotes by Kingdoms\",\n            name = \"Munkres Similarity\",\n            heatmap_legend_param=list(\n                        title=\"Similarity\",\n                        at = seq(0,1,by=0.1)),\n                      col=rev(viridis(256)),\n                      cluster_rows = FALSE,\n                      cluster_columns = FALSE,\n                      top_annotation = annotationK,\n                      show_column_names = FALSE, \n                      show_row_names = FALSE,\n                      left_annotation =\n                        rowAnnotation(df = dff,\n                                      col = colorsK,\n                                    show_annotation_name=FALSE,\n                                    show_legend=FALSE\n                                      ))\n\n\nmeta_animals= meta_taxo[1:884,] %&gt;% filter(Kingdom==\"Animals\")\n\ndff&lt;-meta_taxo %&gt;%\n  filter(Kingdom==\"Animals\") %&gt;% \n  select(Phylum,Freq_Phylum) %&gt;%   \n  as.data.frame() %&gt;% select(Phylum)\n\nnamesP=dff %&gt;% distinct( Phylum, .keep_all = TRUE) \nnamesP=namesP$Phylum\ndff$Phylum=ordered(dff$Phylum,labels=namesP)\ncol=rainbow(length(namesP))\ncolorsP=list(Phylum=col)\nnames(colorsP$Phylum)=namesP\nannotation_H2 &lt;- HeatmapAnnotation(df=dff, col = colorsP)\nMSA_heat_2 &lt;- Heatmap(matrix =\n                        Sim_MSA_mDAG[1:nrow(dff),1:nrow(dff)],\n                      column_title=\"mDAGs MSA-similarity  Animals by Phyla\",\n                      col=rev(viridis(256)),\n                      cluster_rows = FALSE,\n                      show_heatmap_legend=FALSE, \n                      cluster_columns = FALSE,\n                      top_annotation = annotation_H2,\n                      show_column_names = FALSE, \n                      show_row_names = FALSE,\n                      left_annotation = \n                        rowAnnotation(df = dff,\n                                      col = colorsP,\n                                      show_annotation_name=FALSE,\n                                      show_legend =FALSE\n                                      ))\n\n\n\nMun_heat_2 &lt;- Heatmap(matrix = Sim_Mun_mDAG[1:nrow(dff),1:nrow(dff)], \n              column_title=\"mDAGs Munkres-similarity  Animals by Phyla\",\n        col=rev(viridis(256)),\n    show_heatmap_legend=FALSE, \n        cluster_rows = FALSE,\n        cluster_columns = FALSE,\n        top_annotation = annotation_H2,\n        show_column_names = FALSE, \n        show_row_names = FALSE,\n        left_annotation = rowAnnotation(df = dff,\n                                        col = colorsP,\n                                    show_annotation_name=FALSE,\n                                        show_legend =FALSE\n                                        ))\n\n\nMSA_heat_1\n\n\n\nMSA_heat_2\n\n\n\nMun_heat_1\n\n\n\nMun_heat_2"
  },
  {
    "objectID": "index.html#mds-multidimensional-scaling-msa",
    "href": "index.html#mds-multidimensional-scaling-msa",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "3.4 MDS (Multidimensional Scaling) MSA",
    "text": "3.4 MDS (Multidimensional Scaling) MSA\n\n## Metric multidimensional scaling (mMDS)\nmds7 &lt;- cmdscale(sqrt(1-Sim_MSA_mDAG^2),k=7,eig=TRUE)\n#pairs(mds7$points[,1:4])\nmds7$GOF\n\n[1] 0.4449519 0.5570199\n\nmds &lt;- mds7$points %&gt;%  as_tibble()\ncolnames(mds) &lt;-paste0(\"Dim.\",1:dim(mds7$points)[2])\n\n\ncooordinates=as_tibble(mds7$points)\ncolnames(cooordinates)=paste(\"Component\",1:7)\nggpairs(cooordinates,columns=1:4,\n        aes(color=meta_taxo$Kingdom[1:884],alpha=0.5,\n            title=\"MDS 4 dimensions projection\",\n            legend=1),upper=list(continuous=\"points\")) +\n  scale_fill_manual(values = colorsK$Kingdom) + \n  theme(legend.position = \"left\")"
  },
  {
    "objectID": "index.html#mds-multidimensional-scaling-munkres",
    "href": "index.html#mds-multidimensional-scaling-munkres",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "4.1 MDS (Multidimensional Scaling) Munkres",
    "text": "4.1 MDS (Multidimensional Scaling) Munkres\n\n## Metric multidimensional scaling\nmds7 &lt;- cmdscale(sqrt(1-Sim_Mun_mDAG^2),k=7,eig=TRUE)\nmds7$GOF\n\n[1] 0.5605691 0.5800736\n\nmds &lt;- mds7$points %&gt;%  as_tibble()\ncolnames(mds) &lt;-paste0(\"Dim.\",1:dim(mds7$points)[2])\n\ncooordinates=as_tibble(mds7$points)\ncolnames(cooordinates)=paste(\"Component\",1:7)\nggpairs(cooordinates,columns=1:4,\n        aes(color=meta_taxo$Kingdom[1:884],\n            title=\"MDS 4 dimensions projection\",legend=1),\n        lower=list(continuous=\"points\")) + \n  scale_fill_manual(values = colorsK$Kingdom) + \n  theme(legend.position = \"left\")"
  },
  {
    "objectID": "index.html#hierarchical-cluster-munkres",
    "href": "index.html#hierarchical-cluster-munkres",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "4.2 Hierarchical cluster Munkres",
    "text": "4.2 Hierarchical cluster Munkres\n\nD=as.dist(sqrt(1-Sim_Mun_mDAG^2))\nhc_Mun=hclust(as.dist(D),method =\"ward.D\")\nggplot(as.ggdend(as.dendrogram(hc_Mun)))\n\n\n\n\n\nclust4_Mun=cutree(hc_Mun,4)\ntable(clust4_Mun,meta_taxo$Kingdom[1:884])\n\n          \nclust4_Mun Animals Fungi Plants Protists\n         1     331     0      0        0\n         2     197     0      0        0\n         3       7   154     14       56\n         4       0     0    125        0\n\n\nOnly two nematodes of the 9 return to the invertebrate animal cluster for Munkrest; all algae remain in the fungi and archaea cluster.\n\naux=meta_taxo[1:884,] %&gt;%\n  select(Organism,Kingdom,Phylum,Class,Full_Name)\naux$clust4_Mun=clust4_Mun\naux_Animals_cluster_1_2_Mun = aux %&gt;%\n  filter(Kingdom==\"Animals\",clust4_Mun %in% c(1,2))\n\ntable(aux_Animals_cluster_1_2_Mun$Phylum,\n      aux_Animals_cluster_1_2_Mun$clust4_Mun)\n\n                  \n                     1   2\n  Annelids           0   1\n  Arthropods         0 158\n  Brachiopodas       0   1\n  Cephalochordates   0   2\n  Cnidarians         0  10\n  Echinoderms        0   3\n  Hemichordates      0   1\n  Mollusks           0  14\n  Nematodes          0   3\n  Placozoans         0   1\n  Poriferans         0   1\n  Tunicates          0   2\n  Vertebrates      331   0\n\naux_7_Animals_cluster_3_Mun= filter(aux,\n                                clust4_Mun==3,\n                                Kingdom==\"Animals\")\naux_7_Animals_cluster_3_Mun\n\n# A tibble: 7 × 6\n  Organism Kingdom Phylum    Class     Full_Name                      clust4_Mun\n  &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                               &lt;int&gt;\n1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                 3\n2 loa      Animals Nematodes Nematodes Loa loa (eye worm)                      3\n3 tsp      Animals Nematodes Nematodes Trichinella spiralis                    3\n4 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyda…          3\n5 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (South…          3\n6 shx      Animals Flatworms Flatworms Schistosoma haematobium (urin…          3\n7 smm      Animals Flatworms Flatworms Schistosoma mansoni                     3\n\naux_all_Nematodes_Flatworns= aux %&gt;% \n  filter(Kingdom==\"Animals\",\n         Phylum %in% c(\"Nematodes\",\"Flatworms\"))\naux_all_Nematodes_Flatworns\n\n# A tibble: 10 × 6\n   Organism Kingdom Phylum    Class     Full_Name                     clust4_Mun\n   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                              &lt;int&gt;\n 1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                3\n 2 cbr      Animals Nematodes Nematodes Caenorhabditis briggsae (nem…          2\n 3 cel      Animals Nematodes Nematodes Caenorhabditis elegans (nema…          2\n 4 loa      Animals Nematodes Nematodes Loa loa (eye worm)                     3\n 5 nai      Animals Nematodes Nematodes Necator americanus (New Worl…          2\n 6 tsp      Animals Nematodes Nematodes Trichinella spiralis                   3\n 7 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyd…          3\n 8 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (Sout…          3\n 9 shx      Animals Flatworms Flatworms Schistosoma haematobium (uri…          3\n10 smm      Animals Flatworms Flatworms Schistosoma mansoni                    3\n\naux_14_Plants_clust2_Mun= filter(aux,clust4_Mun==3,\n                             Kingdom==\"Plants\")\naux_14_Plants_clust2_Mun\n\n# A tibble: 14 × 6\n   Organism Kingdom Phylum Class Full_Name                      clust4_Mun\n   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                               &lt;int&gt;\n 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3\n 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3\n 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3\n 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3\n 5 cvr      Plants  Green  algae Chlorella variabilis                    3\n 6 mis      Plants  Green  algae Micromonas commoda                      3\n 7 mng      Plants  Green  algae Monoraphidium neglectum                 3\n 8 mpp      Plants  Green  algae Micromonas pusilla                      3\n 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3\n10 ota      Plants  Green  algae Ostreococcus tauri                      3\n11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3\n12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3\n13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3\n14 gsl      Plants  Red    algae Galdieria sulphuraria                   3\n\naux_all_algae_class= aux %&gt;% \n  filter(Kingdom==\"Plants\",\n         Class %in% c(\"algae\"))\naux_all_algae_class\n\n# A tibble: 14 × 6\n   Organism Kingdom Phylum Class Full_Name                      clust4_Mun\n   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                               &lt;int&gt;\n 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3\n 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3\n 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3\n 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3\n 5 cvr      Plants  Green  algae Chlorella variabilis                    3\n 6 mis      Plants  Green  algae Micromonas commoda                      3\n 7 mng      Plants  Green  algae Monoraphidium neglectum                 3\n 8 mpp      Plants  Green  algae Micromonas pusilla                      3\n 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3\n10 ota      Plants  Green  algae Ostreococcus tauri                      3\n11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3\n12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3\n13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3\n14 gsl      Plants  Red    algae Galdieria sulphuraria                   3"
  },
  {
    "objectID": "index.html#similarity-comparison-eukaryotes",
    "href": "index.html#similarity-comparison-eukaryotes",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "4.3 Similarity comparison Eukaryotes",
    "text": "4.3 Similarity comparison Eukaryotes\nComparison of two similarities\nLoad the similarities for pairs and comparison\n\nn=length(meta_taxo$mDAG_Id[1:884])\nn\n\n[1] 884\n\ndim(Sim_MSA_mDAG)\n\n[1] 884 884\n\naux=as_tibble(Sim_MSA_mDAG)\naux$mDag=names(aux)\naux=aux %&gt;% pivot_longer(cols=`0313`:`0300`,\n                         names_to=\"mDag_2\",\n                         values_to=\"Sim_MSA\")\n\naux_2= aux %&gt;%  mutate(i=pmax(as.integer(mDag),\n                              as.integer(mDag_2)),\n                       j=pmin(as.integer(mDag),\n                       as.integer(mDag_2))) %&gt;% unite(\"ij\",i:j) %&gt;%\n  filter(duplicated(ij))\n\n\naux=as_tibble(Sim_Mun_mDAG)\naux$mDag=names(aux)\naux=aux %&gt;% pivot_longer(cols=`0313`:`0300`,\n                         names_to=\"mDag_2\",\n                         values_to=\"Sim_Mun\")\naux_2 = aux_2 %&gt;% left_join(aux)\n\nSim_comp=aux_2\nrm(aux,aux_2)\n\nSpearman and Pearson correlations\n\ncor(Sim_comp[,c(3,5)],method=\"spearman\")\n\n          Sim_MSA   Sim_Mun\nSim_MSA 1.0000000 0.8930995\nSim_Mun 0.8930995 1.0000000\n\ncor(Sim_comp[,c(3,5)],method=\"pearson\")\n\n          Sim_MSA   Sim_Mun\nSim_MSA 1.0000000 0.9203871\nSim_Mun 0.9203871 1.0000000\n\n\n\nGGally::ggpairs(Sim_comp[,c(3,5)])\n\n\n\n\n\naux= Sim_comp%&gt;% pivot_longer(\n  cols=c(Sim_MSA,Sim_Mun),\n  names_to=\"Method\",\n  values_to=\"Similarity\")\n\nggstatsplot::ggbetweenstats(\n  data = aux,\n  x = Method,\n  y = Similarity,\n  centrality.plotting=TRUE)"
  },
  {
    "objectID": "index.html#read-all-graphs-from-a-level-of-the-experiment",
    "href": "index.html#read-all-graphs-from-a-level-of-the-experiment",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "5.1 Read all graphs from a level of the experiment",
    "text": "5.1 Read all graphs from a level of the experiment\nRead all graphs from a level from experiment; for example individuals. We read only firts (alphabetic) two graph\n\n#path_exp=\"data/result_bb261b6e-95c6-3e39-b82b-b68eea80e30b/data/\"\nlist_names=dir(paste0(path_exp,\"Individuals/\"))\n\nlist_names= list_names[-1] # filter 0000_RefPw\nlength(list_names)\n\n[1] 884\n\ngraphs_list=paste0(path_exp,\"Individuals/\",\n                   list_names,\"/\",list_names,\n                   \"_MDAG.graphml\")\n\n\nknitr::include_graphics(\n  paste0(path_exp,\"Individuals/cang/cang_RC.pdf\"))"
  },
  {
    "objectID": "index.html#graph-statistics",
    "href": "index.html#graph-statistics",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "5.2 Graph statistics",
    "text": "5.2 Graph statistics\n\nread_mDAG=function(x) {DAG=read.graph(file=x,\n                                  format=\"graphml\")\n  return(DAG)}\nmDAG_componets=function(x) {\n  sort(components(x,mode = \"weak\")$csize,\n       decreasing=TRUE)\n  }\n\ncompo_list=lapply(graphs_list,\n                  FUN=function(x) {\n                    gg=read_mDAG(x)\n                  aux=list(\n                    mDAG_componets=mDAG_componets(gg),\n                    degree_count=igraph::degree(gg,mode=\"total\"))\n                    return(aux)}\n                  )\n\nnames(compo_list)=list_names\nn=max(sapply(compo_list,FUN=function(x) {length(x[[1]])}))\nn\n\n[1] 234\n\nsize_compo_list=lapply(compo_list,FUN=function(x) {\n  return(c(x[[1]],rep(NA,n-length(x[[1]]))))})\n\naux=do.call(bind_cols,size_compo_list)\naux2=pivot_longer(aux,aaf:zvi,names_to=\"Organism\",\n                  values_to=\"csize\") %&gt;%\n  arrange(Organism,-csize)\naux2$index=rep(1:n,times=dim(aux)[2])\naux2=aux2 %&gt;%\n  left_join(meta_taxo,by=\"Organism\")\n\n\nOrganism=names(compo_list)\nbig_MBB=function(org){\n  x=Results %&gt;% filter(Organism==org)\n  x=as.character(x[1,5:dim(Results)[2]])\n  x=x[x!=\"NA\"]\n  tt=sort(table(x),decreasing=TRUE)\n  return(tt)\n  }\nbig_MBB_list= lapply(Organism,FUN=function(x) big_MBB(x))\nnMBB=max(sapply(big_MBB_list,FUN=function(x) length(x)))\nnMBB\n\n[1] 1042\n\nbig_MBB_list=lapply(big_MBB_list,\n                    FUN=function(x){\n                      x=c(x,rep(NA,nMBB-length(x)))\n                      return(x)}\n)\nnames(big_MBB_list)=Organism\nbig_MBB_list=do.call(bind_cols,big_MBB_list)\n\nkMBB=nrow(big_MBB_list)\nindex=rep(1:kMBB,times=length(Organism))\n\nbig_MBB_list2=pivot_longer(big_MBB_list,\n                           cols=names(big_MBB_list),\n                           values_to = \"MBBsize\",\n                           names_to = \"Organism\") %&gt;% \n  arrange(Organism,-MBBsize) %&gt;%  \n  mutate(index=index) %&gt;% \n  left_join(meta_taxo,by=\"Organism\")\n\n\n5.2.1 Sizes of MBB for each mDAG\n\nCOLOR_KINGDOM=c(\"red\",\"green\",\"yellow\",\"black\")\ncolors_kingdom=big_MBB_list2 %&gt;%\n  select(Organism,Kingdom) %&gt;%\n  distinct()\n\nnames(COLOR_KINGDOM)=sort(unique(colors_kingdom$Kingdom))\n\np0&lt;-ggplot(data=big_MBB_list2) + \n  geom_line(mapping=aes(x=index,\n                        y=MBBsize,\n                        group = Organism,\n                        color=Kingdom)) + \n  scale_y_continuous(trans='log10') + \n  scale_x_continuous(trans='identity') +\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom]) +\n   ggtitle(\"Plot log-identity of MBB \\n  decreasing index.\") +\n  ylab(\"Log10 MBB size\") + xlab(\"Index\")\n\n\np1&lt;- ggplot(data=big_MBB_list2) + \n  geom_line(mapping=aes(x=index,\n                        y=MBBsize,\n                        group = Organism,color=Kingdom),\n                        na.rm=TRUE) + \n  scale_x_continuous(trans='log10') + \n  scale_y_continuous(trans='log10') +\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom]) +\n   ggtitle(\"Plot log10-log10identity of MBB \\n  decreasing index.\") +\n  ylab(\"Log10 MBB size\") + xlab(\"Log10 Index\")\n\np2&lt;- ggplot(data=big_MBB_list2) + \n  geom_line(mapping=aes(x=index,\n                        y=MBBsize,\n                        group = Organism, \n                        color=Kingdom),\n            na.rm=TRUE)+\n   scale_x_continuous(trans=\"identity\") + \n   scale_y_continuous(trans=\"identity\") + \n  ylim(0,1039)+ \n  ggtitle(\"Plot  of MBB sized  decreasing index.\") +\n  ylab(\"MBB size\") + xlab(\"Index\") +\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom])\n\n\np0\n\n\n\np1\n\n\n\np2\n\n\n\n\n\n\n5.2.2 Sizes of weak components for each mDAG\n\nCOLOR_KINGDOM=c(\"red\",\"yellow\",\"green\",\"yellow\",\"black\")\ncolors_kingdom=aux2%&gt;% select(Organism,Kingdom) %&gt;% distinct()\nnames(COLOR_KINGDOM)=sort(unique(colors_kingdom$Kingdom))\n\np0&lt;-ggplot(data=aux2) + \n  geom_line(mapping=aes(x=index,\n                        y=csize,\n                        group = Organism,\n                        color=Kingdom),\n            na.rm=TRUE) + \n  scale_x_continuous(trans='log10') + \n  scale_y_continuous(trans='identity') +\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom]) +\n   ggtitle(\"Plot log-identity of size  weak components decreasing index.\") +\n  ylab(\"Log10 Weak componente size\") + xlab(\"Index\")\n\n\np1&lt;- ggplot(data=aux2) + \n  geom_line(mapping=aes(x=index,\n                        y=csize,group = Organism,\n                        color=Kingdom),\n            na.rm=TRUE) + \n  scale_y_continuous(trans='log10') + \n  scale_x_continuous(trans='log10') +\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom])+\n   ggtitle(\"Plot log-log of size  weak components decreasing index.\") +\n  ylab(\"Log10 weak component size\") + xlab(\"Log10 Index\")\n\np2&lt;- ggplot(data=aux2) + \n  geom_line(mapping=aes(x=index,\n                        y=csize,group = Organism,\n                        color=Kingdom),\n            na.rm=TRUE) + \n   scale_x_continuous(trans=\"identity\") + \n  scale_y_continuous(trans=\"identity\") +\n  ylim(0,1039)+\n   ggtitle(\"Plot  of size  weak components decreasing index.\")+\n  ylab(\"Weak components size\") + xlab(\"Index\")+\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom])\n\n\np0\n\n\n\np1\n\n\n\np2\n\n\n\n\n\ndata2=big_MBB_list2 %&gt;% filter(index %in% 2:20)\np3&lt;- ggplot(data=data2) + \n  geom_line(mapping=aes(x=index,\n                        y=MBBsize,\n                        group = Organism,\n                        color=Kingdom),\n            na.rm=TRUE)+\n  scale_x_continuous(trans=\"identity\") + \n  scale_y_continuous(trans=\"identity\") +\n  ylim(0,25)+\n  ggtitle(\"Plot  of size  weak components  decreasing index 2 to 20.\")+\n  ylab(\"Weak components size\") + xlab(\"Index\")+\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom])\n\np3"
  },
  {
    "objectID": "index.html#comparion-4-kingdoms-and-4-cluster-for-msa-and-munkrest",
    "href": "index.html#comparion-4-kingdoms-and-4-cluster-for-msa-and-munkrest",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "6.1 Comparion 4 kingdoms and 4 cluster for MSA and Munkrest",
    "text": "6.1 Comparion 4 kingdoms and 4 cluster for MSA and Munkrest\n\nclust4_MSA2=tibble(mDAG_Id=names(clust4_MSA), clust4_MSA=clust4_MSA)\nclust4_Mun2=tibble(mDAG_Id=names(clust4_Mun), clust4_Mun=clust4_Mun)\nmeta_taxo2=meta_taxo\nmeta_taxo2=meta_taxo2 %&gt;% left_join(clust4_MSA2,by= \"mDAG_Id\") %&gt;% \n  left_join(clust4_Mun2,by= \"mDAG_Id\")\nmeta_taxo2$combined_cluster_MSA_Kingdom=paste0(meta_taxo2$Kingdom,meta_taxo2$clust4_MSA)\nmeta_taxo2$combined_cluster_Mun_Kingdom=paste0(meta_taxo2$Kingdom,meta_taxo2$clust4_MSA)\nwrite.csv(meta_taxo2,file=\"meta_taxo_4_clusters.csv\")\n\n\nknitr::kable(table(meta_taxo2$Kingdom,meta_taxo2$clust4_MSA))\n\n\n\n\n\n1\n2\n3\n4\n\n\n\n\nAnimals\n331\n197\n7\n0\n\n\nFungi\n0\n0\n154\n0\n\n\nPlants\n0\n0\n14\n125\n\n\nProtists\n0\n0\n56\n0\n\n\n\n\n\n\nknitr::kable(table(meta_taxo2$Kingdom,meta_taxo2$clust4_Mun))\n\n\n\n\n\n1\n2\n3\n4\n\n\n\n\nAnimals\n331\n197\n7\n0\n\n\nFungi\n0\n0\n154\n0\n\n\nPlants\n0\n0\n14\n125\n\n\nProtists\n0\n0\n56\n0\n\n\n\n\n\n\nknitr::kable(table(meta_taxo2$clust4_Mun,meta_taxo2$clust4_MSA))\n\n\n\n\n1\n2\n3\n4\n\n\n\n\n331\n0\n0\n0\n\n\n0\n197\n0\n0\n\n\n0\n0\n231\n0\n\n\n0\n0\n0\n125\n\n\n\n\n\n\n\n\nlibrary(reshape2)\nMSA_table=melt(table(meta_taxo2$Kingdom,meta_taxo2$Phylum,meta_taxo2$clust4_MSA))\nnames(MSA_table)=c(\"Kingdom\",\"Phylum\",\"cluster_MSA\",\"N\")\nMSA_table=MSA_table %&gt;% filter(N!=0)\n\n\nknitr::kable(MSA_table)\n\n\n\n\nKingdom\nPhylum\ncluster_MSA\nN\n\n\n\n\nAnimals\nVertebrates\n1\n331\n\n\nAnimals\nAnnelids\n2\n1\n\n\nAnimals\nArthropods\n2\n158\n\n\nAnimals\nBrachiopodas\n2\n1\n\n\nAnimals\nCephalochordates\n2\n2\n\n\nAnimals\nCnidarians\n2\n10\n\n\nAnimals\nEchinoderms\n2\n3\n\n\nAnimals\nHemichordates\n2\n1\n\n\nAnimals\nMollusks\n2\n14\n\n\nAnimals\nNematodes\n2\n3\n\n\nAnimals\nPlacozoans\n2\n1\n\n\nAnimals\nPoriferans\n2\n1\n\n\nAnimals\nTunicates\n2\n2\n\n\nProtists\nAlveolates\n3\n25\n\n\nProtists\nAmoebozoa\n3\n7\n\n\nFungi\nAscomycetes\n3\n113\n\n\nFungi\nBasidiomycetes\n3\n36\n\n\nProtists\nChoanoflagellates\n3\n2\n\n\nProtists\nCryptomonads\n3\n1\n\n\nProtists\nEuglenozoa\n3\n9\n\n\nAnimals\nFlatworms\n3\n4\n\n\nPlants\nGreen\n3\n11\n\n\nProtists\nHaptophyta\n3\n1\n\n\nProtists\nHeterolobosea\n3\n1\n\n\nProtists\nMetamonada\n3\n2\n\n\nFungi\nMicrosporidians\n3\n5\n\n\nAnimals\nNematodes\n3\n3\n\n\nPlants\nRed\n3\n3\n\n\nProtists\nStramenopiles\n3\n8\n\n\nPlants\nBasal\n4\n2\n\n\nPlants\nEudicots\n4\n98\n\n\nPlants\nFerns\n4\n1\n\n\nPlants\nMonocots\n4\n23\n\n\nPlants\nMosses\n4\n1"
  },
  {
    "objectID": "index.html#comparison-cores-all-algaes-fungi-and-archaea",
    "href": "index.html#comparison-cores-all-algaes-fungi-and-archaea",
    "title": "A Guide to Interpreting the Results of MetaDAG Analysis",
    "section": "6.2 Comparison core’s all algaes, fungi and archaea",
    "text": "6.2 Comparison core’s all algaes, fungi and archaea\n\n#reactions=names(Results)[-c(1:5)]\n#cores=tibble(reactions)\n#cores=cores %&gt;%  separate(reactions, into=c(\"reactions\",\"enzyme\"),sep=\"\\\\(\")\n#cores$enzyme=gsub(\"\\\\(|\\\\)\",replacement = \"\",cores$enzyme)\n#cores\n#algae_core=\n\n\n#Results\n#cores\n#meta_taxo\ncores_names=unique(Results$Groups)\ncores_names\n\n [1] \"MSA Cluster 3|MUN Cluster 3\"                                                                                                                                                                                                                                     \n [2] \"MSA Cluster 2|MUN Cluster 2\"                                                                                                                                                                                                                                     \n [3] \"Fungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms\"                                                                                                                                      \n [4] \"Cluster 1\"                                                                                                                                                                                                                                                       \n [5] \"Cluster 4\"                                                                                                                                                                                                                                                       \n [6] \"Algae|Fungui and Algae|MSA Algae and Nematodes and Flatworms|MSA Cluster 3|MUN Algae and Nematodes and Flatworms|MUN Cluster 3\"                                                                                                                                  \n [7] \"MSA Algae and Nematodes and Flatworms|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MSA Nematodes and Flatworms|MUN Algae and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms|MUN Nematodes and Flatworms|whole set of worms\"\n [8] \"MSA Algae and Nematodes and Flatworms|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MSA Nematodes and Flatworms|MUN Cluster 2|two worms|whole set of worms\"                                                                                               \n [9] \"MSA Cluster 2|MUN Cluster 2|whole set of worms\"                                                                                                                                                                                                                  \n[10] NA                                                                                                                                                                                                                                                                \n\ncores_combi=function(x){\n#x=cores_names[1]  \nId=meta_taxo2 %&gt;% filter(Groups==x) %&gt;% select(mDAG_Id)\nId=as.character(Id$mDAG_Id)\n#bin_NA=function(x) {case_when(!is.na(x) ~ 0 ,default=1)}\nnot_NA= function(x) {!is.na(x)}\n\nmda_filter= Results %&gt;%\n  filter(mDAG_Id %in% Id) %&gt;%\n  select(starts_with(\"R\")) %&gt;%   \n  mutate_all(not_NA) %&gt;% mutate_all(as.integer)\n\n#%&gt;%\n# mutate(mDag_id=Id,.before=1)\n#aux=colSums(mda_filter)\n#aux=as.integer(aux==length(Id))\nreturn(mda_filter)\n}\n\n#cores_combi(\"Cluster1\")\ncores_list=lapply(cores_names,cores_combi)\nnames(cores_list)=cores_names\nlapply(cores_list,dim)\n\n$`MSA Cluster 3|MUN Cluster 3`\n[1]   56 3993\n\n$`MSA Cluster 2|MUN Cluster 2`\n[1]  194 3993\n\n$`Fungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms`\n[1]  154 3993\n\n$`Cluster 1`\n[1]  331 3993\n\n$`Cluster 4`\n[1]  125 3993\n\n$`Algae|Fungui and Algae|MSA Algae and Nematodes and Flatworms|MSA Cluster 3|MUN Algae and Nematodes and Flatworms|MUN Cluster 3`\n[1]   14 3993\n\n$`MSA Algae and Nematodes and Flatworms|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MSA Nematodes and Flatworms|MUN Algae and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms|MUN Nematodes and Flatworms|whole set of worms`\n[1]    7 3993\n\n$`MSA Algae and Nematodes and Flatworms|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MSA Nematodes and Flatworms|MUN Cluster 2|two worms|whole set of worms`\n[1]    2 3993\n\n$`MSA Cluster 2|MUN Cluster 2|whole set of worms`\n[1]    1 3993\n\n$&lt;NA&gt;\n[1]    0 3993\n\ncores_raw=lapply(cores_list,FUN=function(X){apply(X,2,prod)})\n\naux=cores_raw %&gt;% as_tibble(.name_repair =\"universal\")\n#names(aux)=cores_names\ncores_reactions = cbind(reactions,aux)\n\n\n#names(cores)\n#knitr::kable(colSums(cores[,-c(1,2)]),col.names = c(\"Freq\"))\n\n\n cores_reactions %&gt;% select(reactions,`MSA.Cluster.3.MUN.Cluster.3`) %&gt;%\n  filter(`MSA.Cluster.3.MUN.Cluster.3`==1) %&gt;%\n  mutate(http=paste0(\"https://www.genome.jp/entry/\",\n                     reactions))-&gt; aux\n\n\nknitr::kable(aux)\n\n\n\n\nreactions\nMSA.Cluster.3.MUN.Cluster.3\nhttp\n\n\n\n\nR00127(2.7.4.3)\n1\nhttps://www.genome.jp/entry/R00127(2.7.4.3)\n\n\nR00127_rev(2.7.4.3)\n1\nhttps://www.genome.jp/entry/R00127_rev(2.7.4.3)\n\n\nR00139(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R00139(2.7.4.6)\n\n\nR00156(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R00156(2.7.4.6)\n\n\nR00156_rev(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R00156_rev(2.7.4.6)\n\n\nR00330(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R00330(2.7.4.6)\n\n\nR00330_rev(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R00330_rev(2.7.4.6)\n\n\nR00331(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R00331(2.7.4.6)\n\n\nR00331_rev(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R00331_rev(2.7.4.6)\n\n\nR00332(2.7.4.8)\n1\nhttps://www.genome.jp/entry/R00332(2.7.4.8)\n\n\nR00332_rev(2.7.4.8)\n1\nhttps://www.genome.jp/entry/R00332_rev(2.7.4.8)\n\n\nR00570(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R00570(2.7.4.6)\n\n\nR00570_rev(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R00570_rev(2.7.4.6)\n\n\nR00722(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R00722(2.7.4.6)\n\n\nR00722_rev(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R00722_rev(2.7.4.6)\n\n\nR01015(5.3.1.1)\n1\nhttps://www.genome.jp/entry/R01015(5.3.1.1)\n\n\nR01015_rev(5.3.1.1)\n1\nhttps://www.genome.jp/entry/R01015_rev(5.3.1.1)\n\n\nR01137(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R01137(2.7.4.6)\n\n\nR01137_rev(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R01137_rev(2.7.4.6)\n\n\nR01547(2.7.4.3)\n1\nhttps://www.genome.jp/entry/R01547(2.7.4.3)\n\n\nR01547_rev(2.7.4.3)\n1\nhttps://www.genome.jp/entry/R01547_rev(2.7.4.3)\n\n\nR01857(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R01857(2.7.4.6)\n\n\nR01857_rev(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R01857_rev(2.7.4.6)\n\n\nR02090(2.7.4.8)\n1\nhttps://www.genome.jp/entry/R02090(2.7.4.8)\n\n\nR02090_rev(2.7.4.8)\n1\nhttps://www.genome.jp/entry/R02090_rev(2.7.4.8)\n\n\nR02093(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R02093(2.7.4.6)\n\n\nR02093_rev(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R02093_rev(2.7.4.6)\n\n\nR02326(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R02326(2.7.4.6)\n\n\nR02326_rev(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R02326_rev(2.7.4.6)\n\n\nR02331(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R02331(2.7.4.6)\n\n\nR02331_rev(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R02331_rev(2.7.4.6)\n\n\nR03530(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R03530(2.7.4.6)\n\n\nR03530_rev(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R03530_rev(2.7.4.6)\n\n\nR03659(6.1.1.10)\n1\nhttps://www.genome.jp/entry/R03659(6.1.1.10)\n\n\nR03663(6.1.1.3)\n1\nhttps://www.genome.jp/entry/R03663(6.1.1.3)\n\n\nR03664(6.1.1.2)\n1\nhttps://www.genome.jp/entry/R03664(6.1.1.2)\n\n\nR04773(6.1.1.10)\n1\nhttps://www.genome.jp/entry/R04773(6.1.1.10)\n\n\nR09844(2.5.1.58)\n1\nhttps://www.genome.jp/entry/R09844(2.5.1.58)\n\n\nR11319(2.7.4.3)\n1\nhttps://www.genome.jp/entry/R11319(2.7.4.3)\n\n\nR12852(2.7.4.8)\n1\nhttps://www.genome.jp/entry/R12852(2.7.4.8)\n\n\nR12853(2.7.4.6)\n1\nhttps://www.genome.jp/entry/R12853(2.7.4.6)"
  }
]