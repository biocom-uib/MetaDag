<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>A Guide to Interpreting the Results of MetaDAG Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Load data</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">A Guide to Interpreting the Results of MetaDAG Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Load data</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#load-data" id="toc-load-data" class="nav-link active" data-scroll-target="#load-data"><span class="header-section-number">1</span> Load data</a>
  <ul class="collapse">
  <li><a href="#load-metadata" id="toc-load-metadata" class="nav-link" data-scroll-target="#load-metadata"><span class="header-section-number">1.1</span> Load metadata</a></li>
  <li><a href="#table-of-mbbs" id="toc-table-of-mbbs" class="nav-link" data-scroll-target="#table-of-mbbs"><span class="header-section-number">1.2</span> Table of MBBs</a></li>
  <li><a href="#table-of-m-dags" id="toc-table-of-m-dags" class="nav-link" data-scroll-target="#table-of-m-dags"><span class="header-section-number">1.3</span> Table of m-DAGs</a></li>
  <li><a href="#results-table" id="toc-results-table" class="nav-link" data-scroll-target="#results-table"><span class="header-section-number">1.4</span> Results Table</a></li>
  </ul></li>
  <li><a href="#metabolic-graphs" id="toc-metabolic-graphs" class="nav-link" data-scroll-target="#metabolic-graphs"><span class="header-section-number">2</span> Metabolic Graphs</a>
  <ul class="collapse">
  <li><a href="#metabolic-graphs-for-each-organism" id="toc-metabolic-graphs-for-each-organism" class="nav-link" data-scroll-target="#metabolic-graphs-for-each-organism"><span class="header-section-number">2.1</span> Metabolic graphs for each organism</a></li>
  <li><a href="#pan-core-metabolic-graphs" id="toc-pan-core-metabolic-graphs" class="nav-link" data-scroll-target="#pan-core-metabolic-graphs"><span class="header-section-number">2.2</span> Pan &amp; core metabolic graphs</a></li>
  <li><a href="#graphs-topology" id="toc-graphs-topology" class="nav-link" data-scroll-target="#graphs-topology"><span class="header-section-number">2.3</span> Graph’s topology</a></li>
  <li><a href="#graph-statistics" id="toc-graph-statistics" class="nav-link" data-scroll-target="#graph-statistics"><span class="header-section-number">2.4</span> Graph statistics</a></li>
  </ul></li>
  <li><a href="#m-dags-similarities-and-metadata" id="toc-m-dags-similarities-and-metadata" class="nav-link" data-scroll-target="#m-dags-similarities-and-metadata"><span class="header-section-number">3</span> m-DAGs similarities and Metadata</a>
  <ul class="collapse">
  <li><a href="#msa-munkres-similarities" id="toc-msa-munkres-similarities" class="nav-link" data-scroll-target="#msa-munkres-similarities"><span class="header-section-number">3.1</span> MSA &amp; Munkres similarities</a></li>
  <li><a href="#heatmaps" id="toc-heatmaps" class="nav-link" data-scroll-target="#heatmaps"><span class="header-section-number">3.2</span> Heatmaps</a></li>
  <li><a href="#mds-multidimensional-scaling-msa-munkres-similarity" id="toc-mds-multidimensional-scaling-msa-munkres-similarity" class="nav-link" data-scroll-target="#mds-multidimensional-scaling-msa-munkres-similarity"><span class="header-section-number">3.3</span> MDS (Multidimensional Scaling) MSA &amp; Munkres similarity</a></li>
  <li><a href="#hierarchical-clustering-msa-similarity" id="toc-hierarchical-clustering-msa-similarity" class="nav-link" data-scroll-target="#hierarchical-clustering-msa-similarity"><span class="header-section-number">3.4</span> Hierarchical clustering MSA similarity</a></li>
  <li><a href="#hierarchical-clustering-munkres-similarity" id="toc-hierarchical-clustering-munkres-similarity" class="nav-link" data-scroll-target="#hierarchical-clustering-munkres-similarity"><span class="header-section-number">3.5</span> Hierarchical clustering Munkres similarity</a></li>
  <li><a href="#comparison-between-msa-and-munkres-similarities" id="toc-comparison-between-msa-and-munkres-similarities" class="nav-link" data-scroll-target="#comparison-between-msa-and-munkres-similarities"><span class="header-section-number">3.6</span> Comparison between MSA and Munkres similarities</a></li>
  </ul></li>
  <li><a href="#clusters-analysis" id="toc-clusters-analysis" class="nav-link" data-scroll-target="#clusters-analysis"><span class="header-section-number">4</span> Clusters analysis</a>
  <ul class="collapse">
  <li><a href="#comparison-cores-all-algaes-fungi-and-archaea" id="toc-comparison-cores-all-algaes-fungi-and-archaea" class="nav-link" data-scroll-target="#comparison-cores-all-algaes-fungi-and-archaea"><span class="header-section-number">4.1</span> Comparison core’s all algaes, fungi and archaea</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">A Guide to Interpreting the Results of MetaDAG Analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>As an illustrative example for interpreting <a href="https://bioinfo.uib.es/metadag/">metaDAG</a> results, we consider here the Eukaryotes test presented in Section 2.5. Namely, we consider all Eukaryotes from the KEGG database.</p>
<p>First of all, results must be downloaded from:</p>
<p>Hash: <a href="https://bioinfo.uib.es/metadag/handleExperiment/result_0a845f74-826e-3b46-aed9-e7ecf74db262" class="uri">0a845f74-826e-3b46-aed9-e7ecf74db262</a></p>
<p>URL: (https://bioinfo.uib.es/metadag/handleExperiment/result_0a845f74-826e-3b46-aed9-e7ecf74db262)</p>
<p>and saved in the folder:</p>
<p>“data/result_0a845f74-826e-3b46-aed9-e7ecf74db262”.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomcoloR)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="figures/screen_2.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="figures/screen_3.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="figures/screen_4.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<section id="load-data" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Load data</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>experiment<span class="ot">=</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"result_0a845f74-826e-3b46-aed9-e7ecf74db262/"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>path_exp<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">"data/"</span>,experiment)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">data.frame</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Directory_files_and_folders=</span><span class="fu">dir</span>(path_exp),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Data file"</span>,<span class="dv">2</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">"Directory"</span>,<span class="dv">3</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">"Data file"</span>,<span class="dv">6</span>),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Directory"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Directory_files_and_folders</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Different_MBB.csv</td>
<td style="text-align: left;">Data file</td>
</tr>
<tr class="even">
<td style="text-align: left;">Different_mDAG.csv</td>
<td style="text-align: left;">Data file</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Global</td>
<td style="text-align: left;">Directory</td>
</tr>
<tr class="even">
<td style="text-align: left;">Groups</td>
<td style="text-align: left;">Directory</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Individuals</td>
<td style="text-align: left;">Directory</td>
</tr>
<tr class="even">
<td style="text-align: left;">Report.pdf</td>
<td style="text-align: left;">Data file</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Results.csv</td>
<td style="text-align: left;">Data file</td>
</tr>
<tr class="even">
<td style="text-align: left;">Similarities_MBB_MSAMethod.csv</td>
<td style="text-align: left;">Data file</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Similarities_MBB_MunkresMethod.csv</td>
<td style="text-align: left;">Data file</td>
</tr>
<tr class="even">
<td style="text-align: left;">Similarities_mDAG_MSAMethod.csv</td>
<td style="text-align: left;">Data file</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Similarities_mDAG_MunkresMethod.csv</td>
<td style="text-align: left;">Data file</td>
</tr>
<tr class="even">
<td style="text-align: left;">TaxonomyLevels</td>
<td style="text-align: left;">Directory</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>MBB<span class="ot">=</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Different_MBB.csv"</span>),</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>mDAG<span class="ot">=</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Different_mDAG.csv"</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="load-metadata" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="load-metadata"><span class="header-section-number">1.1</span> Load metadata</h2>
<p>Organisms are sorted by Kingdom, Phylum and Class:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>path_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data/result_0a845f74-826e-3b46-aed9-e7ecf74db262/"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Results<span class="ot">=</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Results.csv"</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#rename MetaDaG variables</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)]<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Organism"</span>,<span class="st">"Categories"</span>,<span class="st">"Groups"</span>,<span class="st">"mDAG_Id"</span>,<span class="st">"Full_Name"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>taxo<span class="ot">=</span>Results <span class="sc">%&gt;%</span> <span class="fu">select</span>(Organism<span class="sc">:</span>Full_Name)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>taxo<span class="ot">=</span>taxo <span class="sc">%&gt;%</span> <span class="fu">separate</span>(Categories,<span class="at">into=</span><span class="fu">c</span>(<span class="st">"Kingdom"</span>,<span class="st">"Phylum"</span>,<span class="st">"Class"</span>))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>index<span class="ot">=</span><span class="fu">which</span>(<span class="fu">is.na</span>(taxo<span class="sc">$</span>Class))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>taxo<span class="sc">$</span>Class[index]<span class="ot">=</span><span class="fu">paste</span>(taxo<span class="sc">$</span>Phylum[index])</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>meta_taxo<span class="ot">=</span>taxo</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">table</span>(meta_taxo<span class="sc">$</span>Phylum)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>Freq_Phylum<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">Phylum=</span><span class="fu">names</span>(aux),<span class="at">Freq_Phylum=</span>aux)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Freq_Phylum)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Phylum"</span>,<span class="st">"Freq_Phylum"</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">table</span>(meta_taxo<span class="sc">$</span>Class)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>Freq_Class<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">Class=</span><span class="fu">names</span>(aux),<span class="at">Freq_Class=</span>aux)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Freq_Class)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Class"</span>,<span class="st">"Freq_Class"</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>meta_taxo <span class="ot">=</span> meta_taxo <span class="sc">%&gt;%</span> </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Freq_Phylum) <span class="sc">%&gt;%</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Freq_Class)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>meta_taxo <span class="ot">=</span> meta_taxo <span class="sc">%&gt;%</span> </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Kingdom,<span class="fu">desc</span>(Freq_Phylum),Phylum,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>          <span class="fu">desc</span>(Freq_Class),Class)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(meta_taxo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  Organism Kingdom Phylum  Class Groups mDAG_Id Full_Name Freq_Phylum Freq_Class
  &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;     &lt;table[1d]&gt; &lt;table[1d&gt;
1 aamp     Animals Verteb… Mamm… Clust… 0313    Arvicola… 331         139       
2 afz      Animals Verteb… Mamm… Clust… 0143    Antechin… 331         139       
3 ajm      Animals Verteb… Mamm… Clust… 0221    Artibeus… 331         139       
4 aju      Animals Verteb… Mamm… Clust… 0224    Acinonyx… 331         139       
5 aml      Animals Verteb… Mamm… Clust… 0279    Ailuropo… 331         139       
6 anu      Animals Verteb… Mamm… Clust… 0310    Arvicant… 331         139       </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(meta_taxo<span class="sc">$</span>Kingdom) <span class="sc">%&gt;%</span> kable <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, <span class="at">full_width =</span> F,<span class="at">position=</span><span class="st">"left"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"400px"</span>, <span class="at">height =</span> <span class="st">"200px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:400px; ">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Var1</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Animals</td>
<td style="text-align: right;">535</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fungi</td>
<td style="text-align: right;">154</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Plants</td>
<td style="text-align: right;">139</td>
</tr>
<tr class="even">
<td style="text-align: left;">Protists</td>
<td style="text-align: right;">56</td>
</tr>
</tbody>
</table>
</div>

</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(meta_taxo<span class="sc">$</span>Phylum,meta_taxo<span class="sc">$</span>Kingdom) <span class="sc">%&gt;%</span> kable <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, <span class="at">full_width =</span> F,<span class="at">position=</span><span class="st">"left"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"500px"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:500px; ">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;"></th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Animals</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Fungi</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Plants</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Protists</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Alveolates</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Amoebozoa</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Annelids</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arthropods</td>
<td style="text-align: right;">158</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ascomycetes</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">113</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Basal</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Basidiomycetes</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brachiopodas</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cephalochordates</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Choanoflagellates</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cnidarians</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cryptomonads</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Echinoderms</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Eudicots</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Euglenozoa</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ferns</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flatworms</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Green</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Haptophyta</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hemichordates</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Heterolobosea</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Metamonada</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Microsporidians</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mollusks</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Monocots</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mosses</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nematodes</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Placozoans</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Poriferans</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Red</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Stramenopiles</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tunicates</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vertebrates</td>
<td style="text-align: right;">331</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
</section>
<section id="table-of-mbbs" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="table-of-mbbs"><span class="header-section-number">1.2</span> Table of MBBs</h2>
<p>In this example <code>MBB</code> is a table with 5149 rows and 4122 columns. It displays, for every MBB, the selected groups (Kingdoms, families, etc.) to which it belongs.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#100</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(MBB[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]) <span class="sc">%&gt;%</span>   </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"200px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">MBB Id</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">natural</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">#pathways</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Protists</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Fungi</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Plants</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Animals</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Alveolates</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Amoebozoa</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Annelids</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.0.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.0.0.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.0.0.0.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.0.0.0.0.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.0.0.1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.0.0.2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.0.1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.0.1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.0.1.1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.0.1.1.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.0.1.2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.0.1.3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.0.1.4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.0.1.4.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.0.1.4.0.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.0.1.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.0.1.6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.0.1.6.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
</section>
<section id="table-of-m-dags" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="table-of-m-dags"><span class="header-section-number">1.3</span> Table of m-DAGs</h2>
<p>In this example <code>mDAG</code> is a table with 1132 rows and 5278 columns. It displays, for every m-DAG, the selected groups (Kingdoms, families, etc.) in which it belongs.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(mDAG[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]) <span class="sc">%&gt;%</span>   <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"200px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">mDAG Id</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">#Categories</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Animals</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Plants</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Fungi</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Protists</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Alveolates</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Amoebozoa</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Annelids</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Arthropods</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0001</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0002</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0003</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0004</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0005</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0006</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0007</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0008</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0009</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0010</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0011</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0012</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0013</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0014</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0015</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0016</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0017</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">0018</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0019</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">0020</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(mDAG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1132 5278</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mDAG)[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "mDAG Id"     "#Categories" "Animals"     "Plants"      "Fungi"      
[6] "Protists"   </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">names</span>(mDAG)[<span class="dv">7</span><span class="sc">:</span>(<span class="fu">dim</span>(mDAG)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1150</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Alveolates"        "Amoebozoa"         "Annelids"         
[4] "Arthropods"        "Ascomycetes"       "Basal angiosperms"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 28 to 1213  code MBB: 1 if MBB in mDAG 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="results-table" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="results-table"><span class="header-section-number">1.4</span> Results Table</h2>
<p>The <code>Results</code> table contains for every organism (row) the following information: its category (taxonomy), selected group, Full name, m-DAG id and all reactions name id with their corresponding enzyme. When a reaction is present in the corresponding m-DAG, the MBB to which it belongs is displayed in this column.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Results[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])<span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">angle =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"300%"</span>, <span class="at">height =</span> <span class="st">"1000px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:1000px; overflow-x: scroll; width:300%; ">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; -webkit-transform: rotate(0deg); -moz-transform: rotate(0deg); -ms-transform: rotate(0deg); -o-transform: rotate(0deg); transform: rotate(0deg); position: sticky; top: 0; background-color: #FFFFFF;">Organism</th>
<th data-quarto-table-cell-role="th" style="text-align: left; -webkit-transform: rotate(0deg); -moz-transform: rotate(0deg); -ms-transform: rotate(0deg); -o-transform: rotate(0deg); transform: rotate(0deg); position: sticky; top: 0; background-color: #FFFFFF;">Categories</th>
<th data-quarto-table-cell-role="th" style="text-align: left; -webkit-transform: rotate(0deg); -moz-transform: rotate(0deg); -ms-transform: rotate(0deg); -o-transform: rotate(0deg); transform: rotate(0deg); position: sticky; top: 0; background-color: #FFFFFF;">Groups</th>
<th data-quarto-table-cell-role="th" style="text-align: left; -webkit-transform: rotate(0deg); -moz-transform: rotate(0deg); -ms-transform: rotate(0deg); -o-transform: rotate(0deg); transform: rotate(0deg); position: sticky; top: 0; background-color: #FFFFFF;">mDAG_Id</th>
<th data-quarto-table-cell-role="th" style="text-align: left; -webkit-transform: rotate(0deg); -moz-transform: rotate(0deg); -ms-transform: rotate(0deg); -o-transform: rotate(0deg); transform: rotate(0deg); position: sticky; top: 0; background-color: #FFFFFF;">Full_Name</th>
<th data-quarto-table-cell-role="th" style="text-align: left; -webkit-transform: rotate(0deg); -moz-transform: rotate(0deg); -ms-transform: rotate(0deg); -o-transform: rotate(0deg); transform: rotate(0deg); position: sticky; top: 0; background-color: #FFFFFF;">R00005(3.5.1.54)</th>
<th data-quarto-table-cell-role="th" style="text-align: right; -webkit-transform: rotate(0deg); -moz-transform: rotate(0deg); -ms-transform: rotate(0deg); -o-transform: rotate(0deg); transform: rotate(0deg); position: sticky; top: 0; background-color: #FFFFFF;">R00009(1.11.1.6)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; -webkit-transform: rotate(0deg); -moz-transform: rotate(0deg); -ms-transform: rotate(0deg); -o-transform: rotate(0deg); transform: rotate(0deg); position: sticky; top: 0; background-color: #FFFFFF;">R00010(3.2.1.28)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; -webkit-transform: rotate(0deg); -moz-transform: rotate(0deg); -ms-transform: rotate(0deg); -o-transform: rotate(0deg); transform: rotate(0deg); position: sticky; top: 0; background-color: #FFFFFF;">R00014(1.2.4.1)</th>
<th data-quarto-table-cell-role="th" style="text-align: left; -webkit-transform: rotate(0deg); -moz-transform: rotate(0deg); -ms-transform: rotate(0deg); -o-transform: rotate(0deg); transform: rotate(0deg); position: sticky; top: 0; background-color: #FFFFFF;">R00014(4.1.1.1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">aaf</td>
<td style="text-align: left;">Protists|Stramenopiles|Pelagophytes</td>
<td style="text-align: left;">MSA Cluster 3|MUN Cluster 3</td>
<td style="text-align: left;">0036</td>
<td style="text-align: left;">Aureococcus anophagefferens</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">0.0.10.0.15</td>
<td style="text-align: left;">0.0.10.0.15</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">aag</td>
<td style="text-align: left;">Animals|Arthropods|Insects</td>
<td style="text-align: left;">MSA Cluster 2|MUN Cluster 2</td>
<td style="text-align: left;">0035</td>
<td style="text-align: left;">Aedes aegypti (yellow fever mosquito)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.9.27.7.36.14</td>
<td style="text-align: left;">0.9.27.7.36.14</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aalb</td>
<td style="text-align: left;">Animals|Arthropods|Insects</td>
<td style="text-align: left;">MSA Cluster 2|MUN Cluster 2</td>
<td style="text-align: left;">0276</td>
<td style="text-align: left;">Aedes albopictus (Asian tiger mosquito)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.9.27.7.36.18</td>
<td style="text-align: left;">0.9.27.7.36.18</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">aali</td>
<td style="text-align: left;">Animals|Arthropods|Insects</td>
<td style="text-align: left;">MSA Cluster 2|MUN Cluster 2</td>
<td style="text-align: left;">0267</td>
<td style="text-align: left;">Anopheles albimanus</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.9.27.7.36.65</td>
<td style="text-align: left;">0.9.27.7.36.65</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aalt</td>
<td style="text-align: left;">Fungi|Ascomycetes|Dothideomycetes</td>
<td style="text-align: left;">Fungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms</td>
<td style="text-align: left;">0240</td>
<td style="text-align: left;">Alternaria alternata</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.0.9.20.0.5.6.7</td>
<td style="text-align: left;">0.0.9.20.0.5.6.7</td>
<td style="text-align: left;">0.0.9.20.0.5.6.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">aam</td>
<td style="text-align: left;">Animals|Vertebrates|Birds</td>
<td style="text-align: left;">Cluster 1</td>
<td style="text-align: left;">0040</td>
<td style="text-align: left;">Apteryx mantelli mantelli (North Island brown kiwi)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.9.26.15.46</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aamp</td>
<td style="text-align: left;">Animals|Vertebrates|Mammals</td>
<td style="text-align: left;">Cluster 1</td>
<td style="text-align: left;">0313</td>
<td style="text-align: left;">Arvicola amphibius (Eurasian water vole)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.0.9.20.0.6.0.39</td>
<td style="text-align: left;">0.9.26.18.2.0</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">aang</td>
<td style="text-align: left;">Animals|Vertebrates|Fishes</td>
<td style="text-align: left;">Cluster 1</td>
<td style="text-align: left;">0317</td>
<td style="text-align: left;">Anguilla anguilla (European eel)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.0.9.20.0.6.0.39</td>
<td style="text-align: left;">0.9.26.17.0.0</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aara</td>
<td style="text-align: left;">Animals|Arthropods|Insects</td>
<td style="text-align: left;">MSA Cluster 2|MUN Cluster 2</td>
<td style="text-align: left;">0362</td>
<td style="text-align: left;">Anopheles arabiensis</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.9.27.7.36.34</td>
<td style="text-align: left;">0.9.27.7.36.34</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">abe</td>
<td style="text-align: left;">Fungi|Ascomycetes|Eurotiomycetes</td>
<td style="text-align: left;">Fungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms</td>
<td style="text-align: left;">0060</td>
<td style="text-align: left;">Trichophyton benhamiae</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.0.9.20.0.5.7.0</td>
<td style="text-align: left;">0.0.9.20.0.5.7.0</td>
<td style="text-align: left;">0.0.9.20.0.5.7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">abp</td>
<td style="text-align: left;">Fungi|Basidiomycetes</td>
<td style="text-align: left;">Fungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms</td>
<td style="text-align: left;">0068</td>
<td style="text-align: left;">Agaricus bisporus var. burnettii JB137-S8</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.0.9.20.0.6.1</td>
<td style="text-align: left;">0.0.9.20.0.6.1</td>
<td style="text-align: left;">0.0.9.20.0.6.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">abv</td>
<td style="text-align: left;">Fungi|Basidiomycetes</td>
<td style="text-align: left;">Fungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms</td>
<td style="text-align: left;">0073</td>
<td style="text-align: left;">Agaricus bisporus var. bisporus H97</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.0.9.20.0.6.3</td>
<td style="text-align: left;">0.0.9.20.0.6.3</td>
<td style="text-align: left;">0.0.9.20.0.6.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">acan</td>
<td style="text-align: left;">Protists|Amoebozoa|Acanthamoeba</td>
<td style="text-align: left;">MSA Cluster 3|MUN Cluster 3</td>
<td style="text-align: left;">0873</td>
<td style="text-align: left;">Acanthamoeba castellanii</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.0.10.0.3</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">acar</td>
<td style="text-align: left;">Animals|Vertebrates|Birds</td>
<td style="text-align: left;">Cluster 1</td>
<td style="text-align: left;">0884</td>
<td style="text-align: left;">Antrostomus carolinensis (chuck-will's-widow)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.9.26.15.59</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">acep</td>
<td style="text-align: left;">Animals|Arthropods|Insects</td>
<td style="text-align: left;">MSA Cluster 2|MUN Cluster 2</td>
<td style="text-align: left;">0054</td>
<td style="text-align: left;">Atta cephalotes (leaf cutting ant)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.9.27.7.36.56</td>
<td style="text-align: left;">0.9.27.7.36.56</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">acer</td>
<td style="text-align: left;">Animals|Arthropods|Insects</td>
<td style="text-align: left;">MSA Cluster 2|MUN Cluster 2</td>
<td style="text-align: left;">0057</td>
<td style="text-align: left;">Apis cerana (Asiatic honeybee)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.9.27.7.35.34</td>
<td style="text-align: left;">0.9.27.7.35.34</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">achc</td>
<td style="text-align: left;">Animals|Vertebrates|Birds</td>
<td style="text-align: left;">Cluster 1</td>
<td style="text-align: left;">0103</td>
<td style="text-align: left;">Aquila chrysaetos chrysaetos (golden eagle)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.9.26.15.2.0</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">ache</td>
<td style="text-align: left;">Fungi|Ascomycetes|Eurotiomycetes</td>
<td style="text-align: left;">Fungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms</td>
<td style="text-align: left;">0106</td>
<td style="text-align: left;">Aspergillus chevalieri</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.0.9.20.0.5.7.2</td>
<td style="text-align: left;">0.0.9.20.0.5.7.2</td>
<td style="text-align: left;">0.0.9.20.0.5.7.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">achl</td>
<td style="text-align: left;">Animals|Vertebrates|Birds</td>
<td style="text-align: left;">Cluster 1</td>
<td style="text-align: left;">0081</td>
<td style="text-align: left;">Acanthisitta chloris (rifleman)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.9.26.15.1.1.0.0</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">acoz</td>
<td style="text-align: left;">Animals|Arthropods|Insects</td>
<td style="text-align: left;">MSA Cluster 2|MUN Cluster 2</td>
<td style="text-align: left;">0255</td>
<td style="text-align: left;">Anopheles coluzzii</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3936</td>
<td style="text-align: left;">0.9.27.7.36.22</td>
<td style="text-align: left;">0.9.27.7.36.22</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1132 3998</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="dv">1</span>]<span class="co"># organisms  kegg id  class representant of mDAG</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Organism"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="dv">2</span>]<span class="co"># taxonomy separate by |</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Categories"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="dv">3</span>]<span class="co"># groups </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Groups"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="dv">4</span>]<span class="co"># mDAG_Id </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "mDAG_Id"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="dv">5</span>]<span class="co"># Full name representant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Full_Name"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="dv">6</span><span class="sc">:</span><span class="dv">36</span>]<span class="co"># columns 6 to 3998 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "R00005(3.5.1.54)"   "R00009(1.11.1.6)"   "R00010(3.2.1.28)"  
 [4] "R00014(1.2.4.1)"    "R00014(4.1.1.1)"    "R00021(1.4.7.1)"   
 [7] "R00022(3.2.1.52)"   "R00024(4.1.1.39)"   "R00028(3.2.1.20)"  
[10] "R00031(1.10.3.1)"   "R00032(1.13.11.63)" "R00036(4.2.1.24)"  
[13] "R00045(1.10.3.1)"   "R00066(2.5.1.9)"    "R00068(1.10.3.3)"  
[16] "R00073(1.14.99.1)"  "R00075(2.5.1.43)"   "R00078(1.16.3.1)"  
[19] "R00084(2.5.1.61)"   "R00086(3.6.1.15)"   "R00086(3.6.1.5)"   
[22] "R00087(3.6.1.9)"    "R00093(1.4.1.14)"   "R00095(1.6.5.4)"   
[25] "R00100(1.6.2.2)"    "R00102(3.2.2.5)"    "R00102(3.2.2.6)"   
[28] "R00103(3.6.1.22)"   "R00103(3.6.1.9)"    "R00104(2.7.1.23)"  
[31] "R00111(1.14.13.39)"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reactions name id with its enzyme.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>reactions<span class="ot">=</span><span class="fu">names</span>(Results)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)]</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>reverse_reactions<span class="ot">=</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(reactions,<span class="st">"rev"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>reverse_reactions<span class="ot">=</span><span class="fu">table</span>(reverse_reactions)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(reverse_reactions)<span class="sc">$</span>reverse_reactions<span class="ot">=</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"Non reverse reaction"</span>,<span class="st">"Reverse reaction"</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>reverse_reactions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>reverse_reactions
Non reverse reaction     Reverse reaction 
                3399                  594 </code></pre>
</div>
</div>
</section>
</section>
<section id="metabolic-graphs" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Metabolic Graphs</h1>
<p>We present here some analysis examples of the metabolic graphs generated in GraphML format.</p>
<section id="metabolic-graphs-for-each-organism" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="metabolic-graphs-for-each-organism"><span class="header-section-number">2.1</span> Metabolic graphs for each organism</h2>
<p>Read the individual metabolic graphs generated for Homo sapiens (KEGG id: hsa) in the directory(Individuals/hsa)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>experiment<span class="ot">=</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"result_0a845f74-826e-3b46-aed9-e7ecf74db262/"</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>path_exp<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">"data/"</span>,experiment)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>files_hsa<span class="ot">=</span><span class="fu">dir</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Individuals/hsa"</span>))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>files_hsa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "hsa_mDAG.graphml"       "hsa_mDAG.pdf"           "hsa_mDAG.svg"          
 [4] "hsa_mDAG_adj.csv"       "hsa_mDAG_biggerDAG.pdf" "hsa_mDAG_biggerDAG.svg"
 [7] "hsa_mDAG_nl.csv"        "hsa_mDAG_structure.csv" "hsa_R_adj.csv"         
[10] "hsa_R_nl.csv"           "hsa_RC.graphml"         "hsa_RC.pdf"            
[13] "hsa_RC.svg"             "hsa_summary.txt"       </code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">files_Individual_hsa</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">hsa_mDAG.graphml</td>
<td style="text-align: left;">m-DAG GraphML format</td>
</tr>
<tr class="even">
<td style="text-align: left;">hsa_mDAG.pdf</td>
<td style="text-align: left;">m-DAG pdf graphic</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hsa_mDAG.svg</td>
<td style="text-align: left;">m-DAG svg graphic</td>
</tr>
<tr class="even">
<td style="text-align: left;">hsa_mDAG_adj.csv</td>
<td style="text-align: left;">csv file with the adjacency matrix of the m-DAG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hsa_mDAG_biggerDAG.pdf</td>
<td style="text-align: left;">pdf graphic with the biggest conected componet of the m-DAG</td>
</tr>
<tr class="even">
<td style="text-align: left;">hsa_mDAG_biggerDAG.svg</td>
<td style="text-align: left;">svg graphic with the biggest conected componet of the m-DAG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hsa_mDAG_nl.csv</td>
<td style="text-align: left;">csv file with the node (MBBs) labels of the m-DAG</td>
</tr>
<tr class="even">
<td style="text-align: left;">hsa_mDAG_structure.csv</td>
<td style="text-align: left;">csv file with all connected components of the m-DAG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hsa_R_adj.csv</td>
<td style="text-align: left;">csv file with the adjacency matrix of the reaction graph</td>
</tr>
<tr class="even">
<td style="text-align: left;">hsa_R_nl.csv</td>
<td style="text-align: left;">csv file with the node (reactions) labels of the reaction graph</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hsa_RC.graphml</td>
<td style="text-align: left;">reaction graph GraphML format</td>
</tr>
<tr class="even">
<td style="text-align: left;">hsa_RC.pdf</td>
<td style="text-align: left;">reaction graph pdf graphic</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hsa_RC.svg</td>
<td style="text-align: left;">reaction graph svg graphic</td>
</tr>
<tr class="even">
<td style="text-align: left;">hsa_summary.txt</td>
<td style="text-align: left;">text summary file with the number of MBBs, reactions, etc. in the previous graphs</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="pan-core-metabolic-graphs" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="pan-core-metabolic-graphs"><span class="header-section-number">2.2</span> Pan &amp; core metabolic graphs</h2>
<p>Pan and core metabolic graphs for every group were generated. For instance, one can read the pan and core metabolic graphs generated for the group Algae in the directory (Groups/Algae).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>files_Algae<span class="ot">=</span><span class="fu">dir</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Groups/Algae"</span>))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>files_Algae</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "core" "pan" </code></pre>
</div>
</div>
<p>The global core reaction graph, which is the core of all the organisms’ reaction graphs in this Eukaryotes test, is empty.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>graph_core_RC<span class="ot">=</span><span class="fu">read.graph</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(path_exp,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Global/core/core_RC.graphml"</span>),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">"graphml"</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(graph_core_RC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH bd1096a D--- 0 0 -- 
+ attr: color (v/c), label (v/c), id (v/c)</code></pre>
</div>
</div>
<p>The global core reaction graph has 0 vertex and 0 edges. It is an empty graph.</p>
<p>The core reaction graph for the Algae group is:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(path_exp,<span class="st">"Groups/MSA_Cluster_3/core/MSA_Cluster_3_core_RC.pdf"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><embed src="data/result_0a845f74-826e-3b46-aed9-e7ecf74db262/Groups/MSA_Cluster_3/core/MSA_Cluster_3_core_RC.pdf" class="img-fluid" style="width:100.0%"></p>
<figcaption class="figure-caption">Algae core reaction graph</figcaption>
</figure>
</div>
</div>
</div>
<p>The global core m-DAG, i.e., the core of all organisms in this example is empty.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>graph_core_mDAG<span class="ot">=</span><span class="fu">read.graph</span>(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(path_exp,<span class="st">"Global/core/core_mDAG.graphml"</span>),</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">"graphml"</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(graph_core_mDAG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH bd1696b D--- 0 0 -- 
+ attr: color (v/c), label (v/c), id (v/c)</code></pre>
</div>
</div>
<p>The global core m-DAG has 0 vertex and 0 edges. It is an empty graph.</p>
<p>The core metabolic DAG for the Algae group is:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">paste0</span>(path_exp,                              <span class="st">"Groups/Algae/core/Algae_core_mDAG.pdf"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><embed src="data/result_0a845f74-826e-3b46-aed9-e7ecf74db262/Groups/Algae/core/Algae_core_mDAG.pdf" class="img-fluid" style="width:100.0%"></p>
<figcaption class="figure-caption">Core m-DAG for Algae</figcaption>
</figure>
</div>
</div>
</div>
<p>The global pan reaction graph for the Animals Kingdom is:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>graph_pan_RC<span class="ot">=</span><span class="fu">read.graph</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(path_exp,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"TaxonomyLevels/Kingdom/Animals/pan/Animals_pan_RC.graphml"</span>),</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">"graphml"</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(graph_pan_RC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH bd201c2 D--- 4556 5798 -- 
+ attr: color (v/c), label (v/c), id (v/c), id (e/c)</code></pre>
</div>
</div>
<p>This pan reaction graph has 4556 nodes and 5798 edges.</p>
</section>
<section id="graphs-topology" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="graphs-topology"><span class="header-section-number">2.3</span> Graph’s topology</h2>
<p>From the GraphML files, one can extract topological information. Some examples are as follows.</p>
<p>The diagram below illustrates the distribution of node degrees for an m-DAG.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>graph_mDAG<span class="ot">=</span><span class="fu">read.graph</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(path_exp,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Individuals/hsa/hsa_mDAG.graphml"</span>),</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">format=</span> <span class="st">"graphml"</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(graph_mDAG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH bd24330 D--- 1026 1086 -- 
+ attr: color (v/c), label (v/c), id (v/c), id (e/c)</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(graph_mDAG,<span class="at">mode=</span><span class="st">"all"</span>)),</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">350</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">main=</span><span class="st">"Frequency of Node Degrees"</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylab=</span><span class="st">"Frequency"</span>,<span class="at">xlab=</span><span class="st">"Degree"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>The connected components of every graph as well as the size of every connected component can be obtained as:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>compo<span class="ot">=</span><span class="fu">components</span>(graph_mDAG,<span class="at">mode =</span> <span class="st">"weak"</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(compo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>List of 3
 $ membership: num [1:1026] 1 1 1 1 1 1 1 1 1 1 ...
 $ csize     : num [1:167] 589 1 1 1 1 1 4 3 4 3 ...
 $ no        : int 167</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>compo<span class="sc">$</span>csize</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 589   1   1   1   1   1   4   3   4   3   2   3   3   1   1   1   2   6
 [19]   3   1   3   6   1   1   1   1   1   3   1   6   2   1   1   1   2   1
 [37]   1  14   1  16   1   6   2   2   4   1   1   1   1   1   1   1   1   1
 [55]  13   1   1   1   1   2   6   5   5   2   2  10   1   1   1   2   2   1
 [73]   1   1  62   6   2   1   2   1   1   1   2   1   2  14   3   1   1   1
 [91]   1   1   1   1   1   1   3   6   1   3   1   3   2   1   1   1   2   2
[109]   3   1   1   2   5   1   1   2   3   2   1   1   2   3   4   1   1   2
[127]   1   1   2   1   1   1   1   1   3   1   2   2   1   6   1   1   1   2
[145]   1   1   1   1   1   2   7   1  15   3   1   1   1   1   2   1   3   1
[163]   1   1   1   1   2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="fu">which.max</span>(compo<span class="sc">$</span>csize<span class="sc">==</span><span class="fu">max</span>(compo<span class="sc">$</span>csize))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>k</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(compo<span class="sc">$</span>membership)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20 
589   1   1   1   1   1   4   3   4   3   2   3   3   1   1   1   2   6   3   1 
 21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40 
  3   6   1   1   1   1   1   3   1   6   2   1   1   1   2   1   1  14   1  16 
 41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60 
  1   6   2   2   4   1   1   1   1   1   1   1   1   1  13   1   1   1   1   2 
 61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80 
  6   5   5   2   2  10   1   1   1   2   2   1   1   1  62   6   2   1   2   1 
 81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 
  1   1   2   1   2  14   3   1   1   1   1   1   1   1   1   1   3   6   1   3 
101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 
  1   3   2   1   1   1   2   2   3   1   1   2   5   1   1   2   3   2   1   1 
121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 
  2   3   4   1   1   2   1   1   2   1   1   1   1   1   3   1   2   2   1   6 
141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 
  1   1   1   2   1   1   1   1   1   2   7   1  15   3   1   1   1   1   2   1 
161 162 163 164 165 166 167 
  3   1   1   1   1   1   2 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>vertex<span class="ot">=</span><span class="fu">which</span>(compo<span class="sc">$</span>membership<span class="sc">==</span>k)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(vertex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 589</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>Big_Component<span class="ot">=</span><span class="fu">induced_subgraph</span>(graph_mDAG, <span class="at">vids=</span>vertex)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">vcount</span>(Big_Component)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 589</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">ecount</span>(Big_Component)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 774</code></pre>
</div>
</div>
<p>And the plot of the bigger component of the m-DAG in Homo sapiens is:</p>
<div class="cell" data-layout-align="center" title="Bigger componet of hsa mDAG">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">paste0</span>(path_exp,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Individuals/hsa/hsa_mDAG_biggerDAG.pdf"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><embed src="data/result_0a845f74-826e-3b46-aed9-e7ecf74db262/Individuals/hsa/hsa_mDAG_biggerDAG.pdf" class="img-fluid" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#path_exp="data/result_bb261b6e-95c6-3e39-b82b-b68eea80e30b/data/" </span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>list_names<span class="ot">=</span><span class="fu">dir</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Individuals/"</span>))</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>list_names<span class="ot">=</span> list_names[<span class="sc">-</span><span class="dv">1</span>] <span class="co"># filter 0000_RefPw</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(list_names) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 884</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>graphs_list<span class="ot">=</span><span class="fu">paste0</span>(path_exp,<span class="st">"Individuals/"</span>, list_names,<span class="st">"/"</span>,list_names, <span class="st">"_MDAG.graphml"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(path_exp,<span class="st">"Individuals/cang/cang_RC.pdf"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><embed src="data/result_0a845f74-826e-3b46-aed9-e7ecf74db262/Individuals/cang/cang_RC.pdf" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section>
<section id="graph-statistics" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="graph-statistics"><span class="header-section-number">2.4</span> Graph statistics</h2>
<p>The number of connected component in each generated m-DAG with their frequency in the entire set of m-DAGs, can be obtained as follows:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>read_mDAG<span class="ot">=</span><span class="cf">function</span>(x) {DAG<span class="ot">=</span><span class="fu">read.graph</span>(<span class="at">file=</span>x,</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">format=</span><span class="st">"graphml"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(DAG)}</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>mDAG_componets<span class="ot">=</span><span class="cf">function</span>(x) {</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="fu">components</span>(x,<span class="at">mode =</span> <span class="st">"weak"</span>)<span class="sc">$</span>csize,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>compo_list<span class="ot">=</span><span class="fu">lapply</span>(graphs_list,</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">FUN=</span><span class="cf">function</span>(x) {</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>                    gg<span class="ot">=</span><span class="fu">read_mDAG</span>(x)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>                  aux<span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mDAG_componets=</span><span class="fu">mDAG_componets</span>(gg),</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">degree_count=</span>igraph<span class="sc">::</span><span class="fu">degree</span>(gg,<span class="at">mode=</span><span class="st">"total"</span>))</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">return</span>(aux)}</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(compo_list)<span class="ot">=</span>list_names</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">max</span>(<span class="fu">sapply</span>(compo_list,<span class="at">FUN=</span><span class="cf">function</span>(x) {<span class="fu">length</span>(x[[<span class="dv">1</span>]])}))</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 234</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>size_compo_list<span class="ot">=</span><span class="fu">lapply</span>(compo_list,<span class="at">FUN=</span><span class="cf">function</span>(x) {</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(x[[<span class="dv">1</span>]],<span class="fu">rep</span>(<span class="cn">NA</span>,n<span class="sc">-</span><span class="fu">length</span>(x[[<span class="dv">1</span>]]))))})</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">do.call</span>(bind_cols,size_compo_list)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>aux2<span class="ot">=</span><span class="fu">pivot_longer</span>(aux,aaf<span class="sc">:</span>zvi,<span class="at">names_to=</span><span class="st">"Organism"</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">values_to=</span><span class="st">"csize"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Organism,<span class="sc">-</span>csize)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>aux2<span class="sc">$</span>index<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">times=</span><span class="fu">dim</span>(aux)[<span class="dv">2</span>])</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>aux2<span class="ot">=</span>aux2 <span class="sc">%&gt;%</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(meta_taxo,<span class="at">by=</span><span class="st">"Organism"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>Organism<span class="ot">=</span><span class="fu">names</span>(compo_list)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>big_MBB<span class="ot">=</span><span class="cf">function</span>(org){</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  org<span class="ot">=</span><span class="st">"hsa"</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span>Results <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Organism<span class="sc">==</span>org)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">as.character</span>(x[<span class="dv">1</span>,<span class="dv">5</span><span class="sc">:</span><span class="fu">dim</span>(Results)[<span class="dv">2</span>]])</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span>x[x<span class="sc">!=</span><span class="st">"NA"</span>]</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  tt<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">table</span>(x),<span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tt)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>big_MBB_list<span class="ot">=</span> <span class="fu">lapply</span>(Organism,<span class="at">FUN=</span><span class="cf">function</span>(x) <span class="fu">big_MBB</span>(x))</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>nMBB<span class="ot">=</span><span class="fu">max</span>(<span class="fu">sapply</span>(big_MBB_list,<span class="at">FUN=</span><span class="cf">function</span>(x) <span class="fu">length</span>(x)))</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>nMBB</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1028</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>big_MBB_list<span class="ot">=</span><span class="fu">lapply</span>(big_MBB_list,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FUN=</span><span class="cf">function</span>(x){</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                      x<span class="ot">=</span><span class="fu">c</span>(x,<span class="fu">rep</span>(<span class="cn">NA</span>,nMBB<span class="sc">-</span><span class="fu">length</span>(x)))</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">return</span>(x)}</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(big_MBB_list)<span class="ot">=</span>Organism</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>big_MBB_list<span class="ot">=</span><span class="fu">do.call</span>(bind_cols,big_MBB_list)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>kMBB<span class="ot">=</span><span class="fu">nrow</span>(big_MBB_list)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>index<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>kMBB,<span class="at">times=</span><span class="fu">length</span>(Organism))</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>big_MBB_list2<span class="ot">=</span><span class="fu">pivot_longer</span>(big_MBB_list,</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cols=</span><span class="fu">names</span>(big_MBB_list),</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">values_to =</span> <span class="st">"MBBsize"</span>,</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">names_to =</span> <span class="st">"Organism"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Organism,<span class="sc">-</span>MBBsize) <span class="sc">%&gt;%</span>  </span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index=</span>index) <span class="sc">%&gt;%</span> </span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(meta_taxo,<span class="at">by=</span><span class="st">"Organism"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can visualize the sizes of the MBBs for each m-DAG, using colors to represent the different Kingdoms:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>COLOR_KINGDOM<span class="ot">=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"green"</span>,<span class="st">"yellow"</span>,<span class="st">"black"</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>colors_kingdom<span class="ot">=</span>big_MBB_list2 <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Organism,Kingdom) <span class="sc">%&gt;%</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(COLOR_KINGDOM)<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">unique</span>(colors_kingdom<span class="sc">$</span>Kingdom))</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>p0<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data=</span>big_MBB_list2) <span class="sc">+</span> </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>MBBsize,</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group =</span> Organism,</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span>Kingdom)) <span class="sc">+</span> </span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> </span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'identity'</span>) <span class="sc">+</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom]) <span class="sc">+</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Plot log-identity of MBB </span><span class="sc">\n</span><span class="st">  decreasing index."</span>) <span class="sc">+</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Log10 MBB size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Index"</span>)</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>big_MBB_list2) <span class="sc">+</span> </span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>MBBsize,</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group =</span> Organism,<span class="at">color=</span>Kingdom),</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> </span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span></span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom]) <span class="sc">+</span></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Plot log10-log10identity of MBB </span><span class="sc">\n</span><span class="st">  decreasing index."</span>) <span class="sc">+</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Log10 MBB size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Log10 Index"</span>)</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>big_MBB_list2) <span class="sc">+</span> </span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>MBBsize,</span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group =</span> Organism, </span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span>Kingdom),</span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1039</span>)<span class="sc">+</span> </span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Plot  of MBB sized  decreasing index."</span>) <span class="sc">+</span></span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"MBB size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Index"</span>) <span class="sc">+</span></span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom])</span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true" tabindex="-1"></a>p0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-34-3.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Additionally, we visualize the sizes of the MBBs of each m-DAG, using colors to represent the different Kingdoms:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>COLOR_KINGDOM<span class="ot">=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"yellow"</span>,<span class="st">"green"</span>,<span class="st">"yellow"</span>,<span class="st">"black"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>colors_kingdom<span class="ot">=</span>aux2<span class="sc">%&gt;%</span> <span class="fu">select</span>(Organism,Kingdom) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(COLOR_KINGDOM)<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">unique</span>(colors_kingdom<span class="sc">$</span>Kingdom))</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>p0<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data=</span>aux2) <span class="sc">+</span> </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>csize,</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group =</span> Organism,</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span>Kingdom),</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> </span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'identity'</span>) <span class="sc">+</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom]) <span class="sc">+</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Plot log-identity of size  weak components decreasing order"</span>) <span class="sc">+</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Log10 Weak componente size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Order"</span>)</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>aux2) <span class="sc">+</span> </span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>csize,<span class="at">group =</span> Organism,</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span>Kingdom),</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> </span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom])<span class="sc">+</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Plot log10-log10 of size  weak components decreasing order."</span>) <span class="sc">+</span></span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Log10 weak component size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Log10 order"</span>)</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>aux2) <span class="sc">+</span> </span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>csize,<span class="at">group =</span> Organism,</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span>Kingdom),</span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1039</span>)<span class="sc">+</span></span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Plot  of size  weak components decreasing order."</span>)<span class="sc">+</span></span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Weak components size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Order"</span>)<span class="sc">+</span></span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom])</span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a>p0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-35-3.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>data2<span class="ot">=</span>big_MBB_list2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(index <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>data2) <span class="sc">+</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>MBBsize,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group =</span> Organism,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span>Kingdom),</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">25</span>)<span class="sc">+</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Plot  of size  weak components  decreasing order 2 to 20."</span>)<span class="sc">+</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Weak components size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Order"</span>)<span class="sc">+</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom])</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section>
</section>
<section id="m-dags-similarities-and-metadata" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> m-DAGs similarities and Metadata</h1>
<p>First, we will load the metadata and adjust them to match the structure of the similarities. This will facilitate the creation of graphs and statistics.</p>
<p>Keep in mind the path of the experiment:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>experiment<span class="ot">=</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"result_0a845f74-826e-3b46-aed9-e7ecf74db262/"</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>path_exp<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">"data/"</span>,experiment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="msa-munkres-similarities" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="msa-munkres-similarities"><span class="header-section-number">3.1</span> MSA &amp; Munkres similarities</h2>
<p>In this section, we will present the similarities between m-DAGs considering the two similarity meausures described in the paper. Namely, the MSA and Munkres similarities.</p>
<p>The experimental data set consists of 1132 Eukaryotes from the animal, plant, fungus, and protists kingdoms.</p>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Kingdom</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Abs. Freq.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Animals</td>
<td style="text-align: right;">535</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fungi</td>
<td style="text-align: right;">154</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Plants</td>
<td style="text-align: right;">139</td>
</tr>
<tr class="even">
<td style="text-align: left;">Protists</td>
<td style="text-align: right;">56</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The similarity values are provided in the following files:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>list_Sim<span class="ot">=</span><span class="fu">dir</span>(path_exp,<span class="at">pattern=</span><span class="st">"^Similarities"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>list_Sim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Similarities_MBB_MSAMethod.csv"      "Similarities_MBB_MunkresMethod.csv" 
[3] "Similarities_mDAG_MSAMethod.csv"     "Similarities_mDAG_MunkresMethod.csv"</code></pre>
</div>
</div>
<p>Load the m-DAGs similarities</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>Sim_MSA_mDAG<span class="ot">=</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(path_exp,</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Similarities_mDAG_MSAMethod.csv"</span>))</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>Sim_MSA_mDAG<span class="ot">=</span><span class="fu">as.matrix</span>(Sim_MSA_mDAG[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Sim_MSA_mDAG)<span class="ot">=</span><span class="fu">colnames</span>(Sim_MSA_mDAG)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>Sim_MSA_mDAG<span class="ot">=</span>Sim_MSA_mDAG[meta_taxo<span class="sc">$</span>mDAG_Id[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>],</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>                          meta_taxo<span class="sc">$</span>mDAG_Id[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>Sim_Mun_mDAG<span class="ot">=</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Similarities_mDAG_MunkresMethod.csv"</span>))</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>Sim_Mun_mDAG<span class="ot">=</span><span class="fu">as.matrix</span>(Sim_Mun_mDAG[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Sim_Mun_mDAG)<span class="ot">=</span><span class="fu">colnames</span>(Sim_Mun_mDAG)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>Sim_Mun_mDAG<span class="ot">=</span>Sim_Mun_mDAG[meta_taxo<span class="sc">$</span>mDAG_Id[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>],meta_taxo<span class="sc">$</span>mDAG_Id[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="heatmaps" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="heatmaps"><span class="header-section-number">3.2</span> Heatmaps</h2>
<p>Here, we provide examples of heatmaps to visualize the similarities betweem m-DAGs. We again consider colors to represent the different Kingdoms.</p>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/unnamed-chunk-44_2950dd257ce18a693cfadb73cace69df">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>dff<span class="ot">&lt;-</span>meta_taxo[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>,] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Kingdom)  <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>colorsK <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Kingdom=</span> <span class="fu">c</span>(<span class="st">"Animals"</span><span class="ot">=</span><span class="st">"red"</span>,</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Plants"</span><span class="ot">=</span><span class="st">"green"</span>,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Fungi"</span><span class="ot">=</span><span class="st">"yellow"</span>,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Protists"</span><span class="ot">=</span><span class="st">"black"</span>))</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>annotationK <span class="ot">&lt;-</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">df=</span>dff, <span class="at">col =</span> colorsK,<span class="at">show_legend =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>MSA_heat_1 <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(<span class="at">matrix =</span> Sim_MSA_mDAG, </span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">column_title=</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"m-DAGs MSA-similarity Eukaryotes by Kingdoms"</span>,</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">heatmap_legend_param=</span><span class="fu">list</span>(</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title=</span><span class="st">"Similarity"</span>,</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>)),</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col=</span><span class="fu">rev</span>(<span class="fu">viridis</span>(<span class="dv">256</span>)),</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cluster_columns =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">top_annotation =</span> annotationK,</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_column_names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_row_names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">left_annotation =</span></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">rowAnnotation</span>(<span class="at">df =</span> dff,</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">col =</span> colorsK,</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">show_annotation_name=</span><span class="cn">FALSE</span>,</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">show_legend=</span><span class="cn">FALSE</span></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>                                      ))</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a>Mun_heat_1<span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(<span class="at">matrix =</span> Sim_Mun_mDAG, </span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">column_title=</span><span class="st">"m-DAGs Munkres-similarity  Eukaryotes by Kingdoms"</span>,</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">name =</span> <span class="st">"Munkres Similarity"</span>,</span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">heatmap_legend_param=</span><span class="fu">list</span>(</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title=</span><span class="st">"Similarity"</span>,</span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a>                        <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>)),</span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col=</span><span class="fu">rev</span>(<span class="fu">viridis</span>(<span class="dv">256</span>)),</span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cluster_columns =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a>                      <span class="at">top_annotation =</span> annotationK,</span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_column_names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_row_names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true" tabindex="-1"></a>                      <span class="at">left_annotation =</span></span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">rowAnnotation</span>(<span class="at">df =</span> dff,</span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">col =</span> colorsK,</span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">show_annotation_name=</span><span class="cn">FALSE</span>,</span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">show_legend=</span><span class="cn">FALSE</span></span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true" tabindex="-1"></a>                                      ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/unnamed-chunk-45_3a8d525f942542b1b12226f9e3701483">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>meta_animals<span class="ot">=</span> meta_taxo[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>,] <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Animals"</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>dff<span class="ot">&lt;-</span>meta_taxo <span class="sc">%&gt;%</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Animals"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Phylum,Freq_Phylum) <span class="sc">%&gt;%</span>   </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(Phylum)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>namesP<span class="ot">=</span>dff <span class="sc">%&gt;%</span> <span class="fu">distinct</span>( Phylum, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) </span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>namesP<span class="ot">=</span>namesP<span class="sc">$</span>Phylum</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>dff<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">ordered</span>(dff<span class="sc">$</span>Phylum,<span class="at">labels=</span>namesP)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>col<span class="ot">=</span><span class="fu">rainbow</span>(<span class="fu">length</span>(namesP))</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>colorsP<span class="ot">=</span><span class="fu">list</span>(<span class="at">Phylum=</span>col)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(colorsP<span class="sc">$</span>Phylum)<span class="ot">=</span>namesP</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>annotation_H2 <span class="ot">&lt;-</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">df=</span>dff, <span class="at">col =</span> colorsP)</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>MSA_heat_2 <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(<span class="at">matrix =</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>                        Sim_MSA_mDAG[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dff),<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dff)],</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">column_title=</span><span class="st">"m-DAGs MSA-similarity  Animals by Phyla"</span>,</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col=</span><span class="fu">rev</span>(<span class="fu">viridis</span>(<span class="dv">256</span>)),</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_heatmap_legend=</span><span class="cn">FALSE</span>, </span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cluster_columns =</span> <span class="cn">FALSE</span>,</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">top_annotation =</span> annotation_H2,</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_column_names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_row_names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">left_annotation =</span> </span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">rowAnnotation</span>(<span class="at">df =</span> dff,</span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">col =</span> colorsP,</span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">show_annotation_name=</span><span class="cn">FALSE</span>,</span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">show_legend =</span><span class="cn">FALSE</span></span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a>                                      ))</span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a>Mun_heat_2 <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(<span class="at">matrix =</span> Sim_Mun_mDAG[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dff),<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dff)], </span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a>              <span class="at">column_title=</span><span class="st">"m-DAGs Munkres-similarity  Animals by Phyla"</span>,</span>
<span id="cb90-36"><a href="#cb90-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">rev</span>(<span class="fu">viridis</span>(<span class="dv">256</span>)),</span>
<span id="cb90-37"><a href="#cb90-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_heatmap_legend=</span><span class="cn">FALSE</span>, </span>
<span id="cb90-38"><a href="#cb90-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb90-39"><a href="#cb90-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster_columns =</span> <span class="cn">FALSE</span>,</span>
<span id="cb90-40"><a href="#cb90-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">top_annotation =</span> annotation_H2,</span>
<span id="cb90-41"><a href="#cb90-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">show_column_names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb90-42"><a href="#cb90-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">show_row_names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb90-43"><a href="#cb90-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">left_annotation =</span> <span class="fu">rowAnnotation</span>(<span class="at">df =</span> dff,</span>
<span id="cb90-44"><a href="#cb90-44" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">col =</span> colorsP,</span>
<span id="cb90-45"><a href="#cb90-45" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">show_annotation_name=</span><span class="cn">FALSE</span>,</span>
<span id="cb90-46"><a href="#cb90-46" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">show_legend =</span><span class="cn">FALSE</span></span>
<span id="cb90-47"><a href="#cb90-47" aria-hidden="true" tabindex="-1"></a>                                        ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>MSA_heat_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/heatmaps-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>MSA_heat_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/heatmaps-2.png" class="img-fluid" style="width:100.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>Mun_heat_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/heatmaps-3.png" class="img-fluid" style="width:100.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>Mun_heat_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/heatmaps-4.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section>
<section id="mds-multidimensional-scaling-msa-munkres-similarity" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="mds-multidimensional-scaling-msa-munkres-similarity"><span class="header-section-number">3.3</span> MDS (Multidimensional Scaling) MSA &amp; Munkres similarity</h2>
<p>Multi-dimensional Scaling (MDS) is a classic multivariate data analysis technique that allows for obtaining a low-dimensional representation of the observed similarities. First, we transform each similarity measure into a distance measure as follows: let <span class="math inline">\(s_{ij}\)</span> be a similarity measure between a pair <span class="math inline">\(i,j\)</span>, we define its distance measure as <span class="math inline">\(d_{ij}=\sqrt{1-s_{ij}^2}\)</span>.</p>
<p>The following is the MDS for the MSA similarity:</p>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/unnamed-chunk-47_23877002771c13439356a4c151e43058">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Metric multidimensional scaling (mMDS)</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>mds7 <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>Sim_MSA_mDAG<span class="sc">^</span><span class="dv">2</span>),<span class="at">k=</span><span class="dv">7</span>,<span class="at">eig=</span><span class="cn">TRUE</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>mds7<span class="sc">$</span>GOF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4449519 0.5570199</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>mds <span class="ot">&lt;-</span> mds7<span class="sc">$</span>points <span class="sc">%&gt;%</span>  <span class="fu">as_tibble</span>()</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mds) <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">"Dim."</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(mds7<span class="sc">$</span>points)[<span class="dv">2</span>])</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>cooordinates<span class="ot">=</span><span class="fu">as_tibble</span>(mds7<span class="sc">$</span>points)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cooordinates)<span class="ot">=</span><span class="fu">paste</span>(<span class="st">"Component"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(cooordinates,<span class="at">columns=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color=</span>meta_taxo<span class="sc">$</span>Kingdom[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>],</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">title=</span><span class="st">"MDS 4 dimensions projection"</span>,<span class="at">legend=</span><span class="dv">1</span>),</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower=</span><span class="fu">list</span>(<span class="at">continuous=</span><span class="st">"points"</span>)) <span class="sc">+</span> </span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colorsK<span class="sc">$</span>Kingdom) <span class="sc">+</span> </span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The following is the MDS for the Munkres similarity:</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Metric multidimensional scaling</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>mds7 <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>Sim_Mun_mDAG<span class="sc">^</span><span class="dv">2</span>),<span class="at">k=</span><span class="dv">7</span>,<span class="at">eig=</span><span class="cn">TRUE</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>mds7<span class="sc">$</span>GOF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5605691 0.5800736</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>mds <span class="ot">&lt;-</span> mds7<span class="sc">$</span>points <span class="sc">%&gt;%</span>  <span class="fu">as_tibble</span>()</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mds) <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">"Dim."</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(mds7<span class="sc">$</span>points)[<span class="dv">2</span>])</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>cooordinates<span class="ot">=</span><span class="fu">as_tibble</span>(mds7<span class="sc">$</span>points)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cooordinates)<span class="ot">=</span><span class="fu">paste</span>(<span class="st">"Component"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(cooordinates,<span class="at">columns=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color=</span>meta_taxo<span class="sc">$</span>Kingdom[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>],</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">title=</span><span class="st">"MDS 4 dimensions projection"</span>,<span class="at">legend=</span><span class="dv">1</span>),</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower=</span><span class="fu">list</span>(<span class="at">continuous=</span><span class="st">"points"</span>)) <span class="sc">+</span> </span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colorsK<span class="sc">$</span>Kingdom) <span class="sc">+</span> </span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hierarchical-clustering-msa-similarity" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="hierarchical-clustering-msa-similarity"><span class="header-section-number">3.4</span> Hierarchical clustering MSA similarity</h2>
<p>Through hierarchical clustering using the Ward method, we have derived a partition of the m-DAGs into 4, 5, and 6 clusters, respectively. The corresponding information has been organized into a table, as follows:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>D<span class="ot">=</span><span class="fu">as.dist</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>Sim_MSA_mDAG<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>hc_MSA<span class="ot">=</span><span class="fu">hclust</span>(<span class="fu">as.dist</span>(D),<span class="at">method =</span><span class="st">"ward.D"</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>clust4_MSA<span class="ot">=</span><span class="fu">cutree</span>(hc_MSA,<span class="dv">4</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clust4_MSA,meta_taxo<span class="sc">$</span>Kingdom[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          
clust4_MSA Animals Fungi Plants Protists
         1     331     0      0        0
         2     197     0      0        0
         3       7   154     14       56
         4       0     0    125        0</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>clust5_MSA<span class="ot">=</span><span class="fu">cutree</span>(hc_MSA,<span class="dv">5</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clust5_MSA,meta_taxo<span class="sc">$</span>Kingdom[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          
clust5_MSA Animals Fungi Plants Protists
         1     129     0      0        0
         2     202     0      0        0
         3     197     0      0        0
         4       7   154     14       56
         5       0     0    125        0</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>clust6_MSA<span class="ot">=</span><span class="fu">cutree</span>(hc_MSA,<span class="dv">6</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clust6_MSA,meta_taxo<span class="sc">$</span>Kingdom[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          
clust6_MSA Animals Fungi Plants Protists
         1     129     0      0        0
         2     202     0      0        0
         3     197     0      0        0
         4       7   149     14       34
         5       0     5      0       22
         6       0     0    125        0</code></pre>
</div>
</div>
<p>We can also create a table that correlates the clusters (in this case, two clusters) with the Phylum classification:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span>meta_taxo[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Organism,Kingdom,Phylum,Class,Full_Name)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>aux<span class="sc">$</span>clust4_MSA<span class="ot">=</span>clust4_MSA</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>aux_Animals_cluster_1_2 <span class="ot">=</span> aux <span class="sc">%&gt;%</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Animals"</span>,clust4_MSA <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(aux_Animals_cluster_1_2<span class="sc">$</span>Phylum,aux_Animals_cluster_1_2<span class="sc">$</span>clust4_MSA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  
                     1   2
  Annelids           0   1
  Arthropods         0 158
  Brachiopodas       0   1
  Cephalochordates   0   2
  Cnidarians         0  10
  Echinoderms        0   3
  Hemichordates      0   1
  Mollusks           0  14
  Nematodes          0   3
  Placozoans         0   1
  Poriferans         0   1
  Tunicates          0   2
  Vertebrates      331   0</code></pre>
</div>
</div>
<p>We can retrieve the information of the elements belonging to a specific classification (Animals and Plants) that are part of a particular cluster as follows:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>aux_7_Animals_cluster_3<span class="ot">=</span> <span class="fu">filter</span>(aux,</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>                                clust4_MSA<span class="sc">==</span><span class="dv">3</span>,</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>                                Kingdom<span class="sc">==</span><span class="st">"Animals"</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>aux_7_Animals_cluster_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 6
  Organism Kingdom Phylum    Class     Full_Name                      clust4_MSA
  &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                               &lt;int&gt;
1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                 3
2 loa      Animals Nematodes Nematodes Loa loa (eye worm)                      3
3 tsp      Animals Nematodes Nematodes Trichinella spiralis                    3
4 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyda…          3
5 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (South…          3
6 shx      Animals Flatworms Flatworms Schistosoma haematobium (urin…          3
7 smm      Animals Flatworms Flatworms Schistosoma mansoni                     3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>aux_14_Plants_clust2<span class="ot">=</span> <span class="fu">filter</span>(aux,clust4_MSA<span class="sc">==</span><span class="dv">3</span>,</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>                             Kingdom<span class="sc">==</span><span class="st">"Plants"</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>aux_14_Plants_clust2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   Organism Kingdom Phylum Class Full_Name                      clust4_MSA
   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                               &lt;int&gt;
 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3
 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3
 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3
 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3
 5 cvr      Plants  Green  algae Chlorella variabilis                    3
 6 mis      Plants  Green  algae Micromonas commoda                      3
 7 mng      Plants  Green  algae Monoraphidium neglectum                 3
 8 mpp      Plants  Green  algae Micromonas pusilla                      3
 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3
10 ota      Plants  Green  algae Ostreococcus tauri                      3
11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3
12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3
13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3
14 gsl      Plants  Red    algae Galdieria sulphuraria                   3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>aux_all_algae_class<span class="ot">=</span> aux <span class="sc">%&gt;%</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Plants"</span>,</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>         Class <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"algae"</span>))</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>aux_all_algae_class</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   Organism Kingdom Phylum Class Full_Name                      clust4_MSA
   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                               &lt;int&gt;
 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3
 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3
 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3
 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3
 5 cvr      Plants  Green  algae Chlorella variabilis                    3
 6 mis      Plants  Green  algae Micromonas commoda                      3
 7 mng      Plants  Green  algae Monoraphidium neglectum                 3
 8 mpp      Plants  Green  algae Micromonas pusilla                      3
 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3
10 ota      Plants  Green  algae Ostreococcus tauri                      3
11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3
12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3
13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3
14 gsl      Plants  Red    algae Galdieria sulphuraria                   3</code></pre>
</div>
</div>
<p>We can retrieve the information of the elements from a specific Phylum or Class, and the cluster they belong to, as follows:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>aux_all_Nematodes_Flatworns<span class="ot">=</span> aux <span class="sc">%&gt;%</span> </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Animals"</span>,</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>         Phylum <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nematodes"</span>,<span class="st">"Flatworms"</span>))</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>aux_all_Nematodes_Flatworns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
   Organism Kingdom Phylum    Class     Full_Name                     clust4_MSA
   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                              &lt;int&gt;
 1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                3
 2 cbr      Animals Nematodes Nematodes Caenorhabditis briggsae (nem…          2
 3 cel      Animals Nematodes Nematodes Caenorhabditis elegans (nema…          2
 4 loa      Animals Nematodes Nematodes Loa loa (eye worm)                     3
 5 nai      Animals Nematodes Nematodes Necator americanus (New Worl…          2
 6 tsp      Animals Nematodes Nematodes Trichinella spiralis                   3
 7 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyd…          3
 8 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (Sout…          3
 9 shx      Animals Flatworms Flatworms Schistosoma haematobium (uri…          3
10 smm      Animals Flatworms Flatworms Schistosoma mansoni                    3</code></pre>
</div>
</div>
</section>
<section id="hierarchical-clustering-munkres-similarity" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="hierarchical-clustering-munkres-similarity"><span class="header-section-number">3.5</span> Hierarchical clustering Munkres similarity</h2>
<p>We obtain a classification of the m-DAGs into different clusters and retrieve the cluster’s information as follows:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>D<span class="ot">=</span><span class="fu">as.dist</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>Sim_Mun_mDAG<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>hc_Mun<span class="ot">=</span><span class="fu">hclust</span>(<span class="fu">as.dist</span>(D),<span class="at">method =</span><span class="st">"ward.D"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>clust4_Mun<span class="ot">=</span><span class="fu">cutree</span>(hc_Mun,<span class="dv">4</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clust4_Mun,meta_taxo<span class="sc">$</span>Kingdom[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          
clust4_Mun Animals Fungi Plants Protists
         1     331     0      0        0
         2     197     0      0        0
         3       7   154     14       56
         4       0     0    125        0</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span>meta_taxo[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Organism,Kingdom,Phylum,Class,Full_Name)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>aux<span class="sc">$</span>clust4_Mun<span class="ot">=</span>clust4_Mun</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>aux_Animals_cluster_1_2_Mun <span class="ot">=</span> aux <span class="sc">%&gt;%</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Animals"</span>,clust4_Mun <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(aux_Animals_cluster_1_2_Mun<span class="sc">$</span>Phylum,</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>      aux_Animals_cluster_1_2_Mun<span class="sc">$</span>clust4_Mun)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  
                     1   2
  Annelids           0   1
  Arthropods         0 158
  Brachiopodas       0   1
  Cephalochordates   0   2
  Cnidarians         0  10
  Echinoderms        0   3
  Hemichordates      0   1
  Mollusks           0  14
  Nematodes          0   3
  Placozoans         0   1
  Poriferans         0   1
  Tunicates          0   2
  Vertebrates      331   0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>aux_7_Animals_cluster_3_Mun<span class="ot">=</span> <span class="fu">filter</span>(aux,</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>                                clust4_Mun<span class="sc">==</span><span class="dv">3</span>,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>                                Kingdom<span class="sc">==</span><span class="st">"Animals"</span>)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>aux_7_Animals_cluster_3_Mun</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 6
  Organism Kingdom Phylum    Class     Full_Name                      clust4_Mun
  &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                               &lt;int&gt;
1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                 3
2 loa      Animals Nematodes Nematodes Loa loa (eye worm)                      3
3 tsp      Animals Nematodes Nematodes Trichinella spiralis                    3
4 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyda…          3
5 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (South…          3
6 shx      Animals Flatworms Flatworms Schistosoma haematobium (urin…          3
7 smm      Animals Flatworms Flatworms Schistosoma mansoni                     3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>aux_all_Nematodes_Flatworns<span class="ot">=</span> aux <span class="sc">%&gt;%</span> </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Animals"</span>,</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>         Phylum <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nematodes"</span>,<span class="st">"Flatworms"</span>))</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>aux_all_Nematodes_Flatworns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
   Organism Kingdom Phylum    Class     Full_Name                     clust4_Mun
   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                              &lt;int&gt;
 1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                3
 2 cbr      Animals Nematodes Nematodes Caenorhabditis briggsae (nem…          2
 3 cel      Animals Nematodes Nematodes Caenorhabditis elegans (nema…          2
 4 loa      Animals Nematodes Nematodes Loa loa (eye worm)                     3
 5 nai      Animals Nematodes Nematodes Necator americanus (New Worl…          2
 6 tsp      Animals Nematodes Nematodes Trichinella spiralis                   3
 7 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyd…          3
 8 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (Sout…          3
 9 shx      Animals Flatworms Flatworms Schistosoma haematobium (uri…          3
10 smm      Animals Flatworms Flatworms Schistosoma mansoni                    3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>aux_14_Plants_clust2_Mun<span class="ot">=</span> <span class="fu">filter</span>(aux,clust4_Mun<span class="sc">==</span><span class="dv">3</span>,</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>                             Kingdom<span class="sc">==</span><span class="st">"Plants"</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>aux_14_Plants_clust2_Mun</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   Organism Kingdom Phylum Class Full_Name                      clust4_Mun
   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                               &lt;int&gt;
 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3
 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3
 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3
 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3
 5 cvr      Plants  Green  algae Chlorella variabilis                    3
 6 mis      Plants  Green  algae Micromonas commoda                      3
 7 mng      Plants  Green  algae Monoraphidium neglectum                 3
 8 mpp      Plants  Green  algae Micromonas pusilla                      3
 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3
10 ota      Plants  Green  algae Ostreococcus tauri                      3
11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3
12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3
13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3
14 gsl      Plants  Red    algae Galdieria sulphuraria                   3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>aux_all_algae_class<span class="ot">=</span> aux <span class="sc">%&gt;%</span> </span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Plants"</span>,</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>         Class <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"algae"</span>))</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>aux_all_algae_class</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   Organism Kingdom Phylum Class Full_Name                      clust4_Mun
   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                               &lt;int&gt;
 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3
 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3
 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3
 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3
 5 cvr      Plants  Green  algae Chlorella variabilis                    3
 6 mis      Plants  Green  algae Micromonas commoda                      3
 7 mng      Plants  Green  algae Monoraphidium neglectum                 3
 8 mpp      Plants  Green  algae Micromonas pusilla                      3
 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3
10 ota      Plants  Green  algae Ostreococcus tauri                      3
11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3
12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3
13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3
14 gsl      Plants  Red    algae Galdieria sulphuraria                   3</code></pre>
</div>
</div>
</section>
<section id="comparison-between-msa-and-munkres-similarities" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="comparison-between-msa-and-munkres-similarities"><span class="header-section-number">3.6</span> Comparison between MSA and Munkres similarities</h2>
<p>In order to compare the two similarities we consider the Spearman and Pearson correlation. First, we load the similarities for every pair of m-DAG and each similarity measure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(meta_taxo<span class="sc">$</span>mDAG_Id[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>])</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 884</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Sim_MSA_mDAG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 884 884</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">as_tibble</span>(Sim_MSA_mDAG)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>aux<span class="sc">$</span>mDag<span class="ot">=</span><span class="fu">names</span>(aux)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span>aux <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="st">`</span><span class="at">0313</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">0300</span><span class="st">`</span>,</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">names_to=</span><span class="st">"mDag_2"</span>,</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values_to=</span><span class="st">"Sim_MSA"</span>)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>aux_2<span class="ot">=</span> aux <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">i=</span><span class="fu">pmax</span>(<span class="fu">as.integer</span>(mDag),</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">as.integer</span>(mDag_2)),</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">j=</span><span class="fu">pmin</span>(<span class="fu">as.integer</span>(mDag),</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">as.integer</span>(mDag_2))) <span class="sc">%&gt;%</span> <span class="fu">unite</span>(<span class="st">"ij"</span>,i<span class="sc">:</span>j) <span class="sc">%&gt;%</span></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">duplicated</span>(ij))</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">as_tibble</span>(Sim_Mun_mDAG)</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>aux<span class="sc">$</span>mDag<span class="ot">=</span><span class="fu">names</span>(aux)</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span>aux <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="st">`</span><span class="at">0313</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">0300</span><span class="st">`</span>,</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">names_to=</span><span class="st">"mDag_2"</span>,</span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values_to=</span><span class="st">"Sim_Mun"</span>)</span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>aux_2 <span class="ot">=</span> aux_2 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(aux)</span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a>Sim_comp<span class="ot">=</span>aux_2</span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(aux,aux_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next we obtain the Spearman and Pearson correlations as follows:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Sim_comp[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)],<span class="at">method=</span><span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          Sim_MSA   Sim_Mun
Sim_MSA 1.0000000 0.8930995
Sim_Mun 0.8930995 1.0000000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Sim_comp[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)],<span class="at">method=</span><span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          Sim_MSA   Sim_Mun
Sim_MSA 1.0000000 0.9203871
Sim_Mun 0.9203871 1.0000000</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(Sim_comp[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>sim_pairs<span class="ot">=</span> Sim_comp<span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols=</span><span class="fu">c</span>(Sim_MSA,Sim_Mun),</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to=</span><span class="st">"Method"</span>,</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to=</span><span class="st">"Similarity"</span>)</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggbetweenstats</span>(</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sim_pairs,</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Method,</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> Similarity,</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">centrality.plotting=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>sim_pairs <span class="sc">%&gt;%</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>Method, <span class="at">y=</span>Similarity, <span class="at">fill=</span>Method)) <span class="sc">+</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Boxplot diagram of the similarities between the two aproaches"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section>
</section>
<section id="clusters-analysis" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Clusters analysis</h1>
<p>In the Eukaryotes test, we aimed to analyze which factors caused some algae and plants to be distinguished from their respective kingdoms. To address this question, we revisited the core metabolism obtained with MetaDAG, focusing on each cluster.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>reactions<span class="ot">=</span><span class="fu">names</span>(Results)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>reactions<span class="ot">=</span>reactions[<span class="fu">grep</span>(<span class="st">"(^R</span><span class="sc">\\</span><span class="st">d{5})"</span>,reactions)]</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>reactions<span class="ot">=</span><span class="fu">tibble</span>(reactions)</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>reactions<span class="ot">=</span>reactions <span class="sc">%&gt;%</span> <span class="fu">separate</span>(reactions, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"r_id"</span>,<span class="st">"enzyme"</span>),<span class="at">sep=</span><span class="st">"</span><span class="sc">\\</span><span class="st">("</span>,<span class="at">remove=</span><span class="cn">FALSE</span>)</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>reactions<span class="ot">=</span>reactions <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">enzyme=</span><span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(|</span><span class="sc">\\</span><span class="st">)"</span>,<span class="st">""</span>,enzyme))</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="co">#reactions=reactions[,-3]</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>reactions<span class="sc">$</span>rev<span class="ot">=</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(reactions<span class="sc">$</span>r_id,<span class="st">"v"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The results of the clusters are compared to the classification of Kingdoms for both similarity measures:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>clust4_MSA2<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">mDAG_Id=</span><span class="fu">names</span>(clust4_MSA), <span class="at">clust4_MSA=</span>clust4_MSA)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>clust4_Mun2<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">mDAG_Id=</span><span class="fu">names</span>(clust4_Mun), <span class="at">clust4_Mun=</span>clust4_Mun)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>meta_taxo2<span class="ot">=</span>meta_taxo</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>meta_taxo2<span class="ot">=</span>meta_taxo2 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(clust4_MSA2,<span class="at">by=</span> <span class="st">"mDAG_Id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(clust4_Mun2,<span class="at">by=</span> <span class="st">"mDAG_Id"</span>)</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>meta_taxo2<span class="sc">$</span>combined_cluster_MSA_Kingdom<span class="ot">=</span><span class="fu">paste0</span>(meta_taxo2<span class="sc">$</span>Kingdom,meta_taxo2<span class="sc">$</span>clust4_MSA)</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>meta_taxo2<span class="sc">$</span>combined_cluster_Mun_Kingdom<span class="ot">=</span><span class="fu">paste0</span>(meta_taxo2<span class="sc">$</span>Kingdom,meta_taxo2<span class="sc">$</span>clust4_MSA)</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(meta_taxo2,<span class="at">file=</span><span class="st">"meta_taxo_4_clusters.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">table</span>(meta_taxo2<span class="sc">$</span>Kingdom,meta_taxo2<span class="sc">$</span>clust4_MSA))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Animals</td>
<td style="text-align: right;">331</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fungi</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Plants</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">125</td>
</tr>
<tr class="even">
<td style="text-align: left;">Protists</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">table</span>(meta_taxo2<span class="sc">$</span>Kingdom,meta_taxo2<span class="sc">$</span>clust4_Mun))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Animals</td>
<td style="text-align: right;">331</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fungi</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Plants</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">125</td>
</tr>
<tr class="even">
<td style="text-align: left;">Protists</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">table</span>(meta_taxo2<span class="sc">$</span>clust4_Mun,meta_taxo2<span class="sc">$</span>clust4_MSA))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">331</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">231</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">125</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The table below correlates the clusters with the Phylum information.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>MSA_table<span class="ot">=</span><span class="fu">melt</span>(<span class="fu">table</span>(meta_taxo2<span class="sc">$</span>Kingdom,meta_taxo2<span class="sc">$</span>Phylum,meta_taxo2<span class="sc">$</span>clust4_MSA))</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(MSA_table)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Kingdom"</span>,<span class="st">"Phylum"</span>,<span class="st">"cluster_MSA"</span>,<span class="st">"N"</span>)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>MSA_table<span class="ot">=</span>MSA_table <span class="sc">%&gt;%</span> <span class="fu">filter</span>(N<span class="sc">!=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(MSA_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Kingdom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Phylum</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cluster_MSA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Vertebrates</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">331</td>
</tr>
<tr class="even">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Annelids</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Arthropods</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">158</td>
</tr>
<tr class="even">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Brachiopodas</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Cephalochordates</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Cnidarians</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Echinoderms</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Hemichordates</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Mollusks</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="even">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Nematodes</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Placozoans</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Poriferans</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Tunicates</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Protists</td>
<td style="text-align: left;">Alveolates</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Protists</td>
<td style="text-align: left;">Amoebozoa</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fungi</td>
<td style="text-align: left;">Ascomycetes</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">113</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fungi</td>
<td style="text-align: left;">Basidiomycetes</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">36</td>
</tr>
<tr class="even">
<td style="text-align: left;">Protists</td>
<td style="text-align: left;">Choanoflagellates</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Protists</td>
<td style="text-align: left;">Cryptomonads</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Protists</td>
<td style="text-align: left;">Euglenozoa</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Flatworms</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Plants</td>
<td style="text-align: left;">Green</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Protists</td>
<td style="text-align: left;">Haptophyta</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Protists</td>
<td style="text-align: left;">Heterolobosea</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Protists</td>
<td style="text-align: left;">Metamonada</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fungi</td>
<td style="text-align: left;">Microsporidians</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Animals</td>
<td style="text-align: left;">Nematodes</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Plants</td>
<td style="text-align: left;">Red</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Protists</td>
<td style="text-align: left;">Stramenopiles</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Plants</td>
<td style="text-align: left;">Basal</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Plants</td>
<td style="text-align: left;">Eudicots</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">98</td>
</tr>
<tr class="even">
<td style="text-align: left;">Plants</td>
<td style="text-align: left;">Ferns</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Plants</td>
<td style="text-align: left;">Monocots</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="even">
<td style="text-align: left;">Plants</td>
<td style="text-align: left;">Mosses</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="comparison-cores-all-algaes-fungi-and-archaea" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="comparison-cores-all-algaes-fungi-and-archaea"><span class="header-section-number">4.1</span> Comparison core’s all algaes, fungi and archaea</h2>
<p>????? Aquí no sé muy bien que hacemos XXXXXX</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reactions=names(Results)[-c(1:5)]</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co">#cores=tibble(reactions)</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co">#cores=cores %&gt;%  separate(reactions, into=c("reactions","enzyme"),sep="\\(")</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="co">#cores$enzyme=gsub("\\(|\\)",replacement = "",cores$enzyme)</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co">#cores</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="co">#algae_core=</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Results</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co">#cores</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="co">#meta_taxo</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>cores_names<span class="ot">=</span><span class="fu">unique</span>(Results<span class="sc">$</span>Groups)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>cores_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "MSA Cluster 3|MUN Cluster 3"                                                                                                                                                                                                                                     
 [2] "MSA Cluster 2|MUN Cluster 2"                                                                                                                                                                                                                                     
 [3] "Fungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms"                                                                                                                                      
 [4] "Cluster 1"                                                                                                                                                                                                                                                       
 [5] "Cluster 4"                                                                                                                                                                                                                                                       
 [6] "Algae|Fungui and Algae|MSA Algae and Nematodes and Flatworms|MSA Cluster 3|MUN Algae and Nematodes and Flatworms|MUN Cluster 3"                                                                                                                                  
 [7] "MSA Algae and Nematodes and Flatworms|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MSA Nematodes and Flatworms|MUN Algae and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms|MUN Nematodes and Flatworms|whole set of worms"
 [8] "MSA Algae and Nematodes and Flatworms|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MSA Nematodes and Flatworms|MUN Cluster 2|two worms|whole set of worms"                                                                                               
 [9] "MSA Cluster 2|MUN Cluster 2|whole set of worms"                                                                                                                                                                                                                  
[10] NA                                                                                                                                                                                                                                                                </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>cores_combi<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="co">#x=cores_names[1]  </span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>Id<span class="ot">=</span>meta_taxo2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Groups<span class="sc">==</span>x) <span class="sc">%&gt;%</span> <span class="fu">select</span>(mDAG_Id)</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>Id<span class="ot">=</span><span class="fu">as.character</span>(Id<span class="sc">$</span>mDAG_Id)</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="co">#bin_NA=function(x) {case_when(!is.na(x) ~ 0 ,default=1)}</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>not_NA<span class="ot">=</span> <span class="cf">function</span>(x) {<span class="sc">!</span><span class="fu">is.na</span>(x)}</span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>mda_filter<span class="ot">=</span> Results <span class="sc">%&gt;%</span></span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mDAG_Id <span class="sc">%in%</span> Id) <span class="sc">%&gt;%</span></span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"R"</span>)) <span class="sc">%&gt;%</span>   </span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(not_NA) <span class="sc">%&gt;%</span> <span class="fu">mutate_all</span>(as.integer)</span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a><span class="co">#%&gt;%</span></span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a><span class="co"># mutate(mDag_id=Id,.before=1)</span></span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a><span class="co">#aux=colSums(mda_filter)</span></span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a><span class="co">#aux=as.integer(aux==length(Id))</span></span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(mda_filter)</span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-20"><a href="#cb152-20" aria-hidden="true" tabindex="-1"></a><span class="co">#cores_combi("Cluster1")</span></span>
<span id="cb152-21"><a href="#cb152-21" aria-hidden="true" tabindex="-1"></a>cores_list<span class="ot">=</span><span class="fu">lapply</span>(cores_names,cores_combi)</span>
<span id="cb152-22"><a href="#cb152-22" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cores_list)<span class="ot">=</span>cores_names</span>
<span id="cb152-23"><a href="#cb152-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(cores_list,dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$`MSA Cluster 3|MUN Cluster 3`
[1]   56 3993

$`MSA Cluster 2|MUN Cluster 2`
[1]  194 3993

$`Fungui and Algae|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms`
[1]  154 3993

$`Cluster 1`
[1]  331 3993

$`Cluster 4`
[1]  125 3993

$`Algae|Fungui and Algae|MSA Algae and Nematodes and Flatworms|MSA Cluster 3|MUN Algae and Nematodes and Flatworms|MUN Cluster 3`
[1]   14 3993

$`MSA Algae and Nematodes and Flatworms|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MSA Nematodes and Flatworms|MUN Algae and Nematodes and Flatworms|MUN Cluster 3|MUN Fungui and Nematodes and Flatworms|MUN Nematodes and Flatworms|whole set of worms`
[1]    7 3993

$`MSA Algae and Nematodes and Flatworms|MSA Cluster 3|MSA Fungui and Nematodes and Flatworms|MSA Nematodes and Flatworms|MUN Cluster 2|two worms|whole set of worms`
[1]    2 3993

$`MSA Cluster 2|MUN Cluster 2|whole set of worms`
[1]    1 3993

$&lt;NA&gt;
[1]    0 3993</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>cores_raw<span class="ot">=</span><span class="fu">lapply</span>(cores_list,<span class="at">FUN=</span><span class="cf">function</span>(X){<span class="fu">apply</span>(X,<span class="dv">2</span>,prod)})</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span>cores_raw <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>(<span class="at">.name_repair =</span><span class="st">"universal"</span>)</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="co">#names(aux)=cores_names</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>cores_reactions <span class="ot">=</span> <span class="fu">cbind</span>(reactions,aux)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">#names(cores)</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="co">#knitr::kable(colSums(cores[,-c(1,2)]),col.names = c("Freq"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a> cores_reactions <span class="sc">%&gt;%</span> <span class="fu">select</span>(reactions,<span class="st">`</span><span class="at">MSA.Cluster.3.MUN.Cluster.3</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">MSA.Cluster.3.MUN.Cluster.3</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">http=</span><span class="fu">paste0</span>(<span class="st">"https://www.genome.jp/entry/"</span>,</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>                     reactions))<span class="ot">-&gt;</span> aux</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(aux)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">reactions</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MSA.Cluster.3.MUN.Cluster.3</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">http</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R00127(2.7.4.3)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00127(2.7.4.3)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R00127_rev(2.7.4.3)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00127_rev(2.7.4.3)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R00139(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00139(2.7.4.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R00156(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00156(2.7.4.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R00156_rev(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00156_rev(2.7.4.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R00330(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00330(2.7.4.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R00330_rev(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00330_rev(2.7.4.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R00331(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00331(2.7.4.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R00331_rev(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00331_rev(2.7.4.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R00332(2.7.4.8)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00332(2.7.4.8)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R00332_rev(2.7.4.8)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00332_rev(2.7.4.8)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R00570(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00570(2.7.4.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R00570_rev(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00570_rev(2.7.4.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R00722(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00722(2.7.4.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R00722_rev(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R00722_rev(2.7.4.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R01015(5.3.1.1)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R01015(5.3.1.1)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R01015_rev(5.3.1.1)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R01015_rev(5.3.1.1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R01137(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R01137(2.7.4.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R01137_rev(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R01137_rev(2.7.4.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R01547(2.7.4.3)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R01547(2.7.4.3)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R01547_rev(2.7.4.3)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R01547_rev(2.7.4.3)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R01857(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R01857(2.7.4.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R01857_rev(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R01857_rev(2.7.4.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R02090(2.7.4.8)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R02090(2.7.4.8)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R02090_rev(2.7.4.8)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R02090_rev(2.7.4.8)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R02093(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R02093(2.7.4.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R02093_rev(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R02093_rev(2.7.4.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R02326(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R02326(2.7.4.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R02326_rev(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R02326_rev(2.7.4.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R02331(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R02331(2.7.4.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R02331_rev(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R02331_rev(2.7.4.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R03530(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R03530(2.7.4.6)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R03530_rev(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R03530_rev(2.7.4.6)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R03659(6.1.1.10)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R03659(6.1.1.10)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R03663(6.1.1.3)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R03663(6.1.1.3)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R03664(6.1.1.2)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R03664(6.1.1.2)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R04773(6.1.1.10)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R04773(6.1.1.10)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R09844(2.5.1.58)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R09844(2.5.1.58)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R11319(2.7.4.3)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R11319(2.7.4.3)</td>
</tr>
<tr class="even">
<td style="text-align: left;">R12852(2.7.4.8)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R12852(2.7.4.8)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R12853(2.7.4.6)</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">https://www.genome.jp/entry/R12853(2.7.4.6)</td>
</tr>
</tbody>
</table>


</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb158" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  include=FALSE,message=FALSE}</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>,</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cache=</span><span class="cn">FALSE</span>,</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">out.width =</span> <span class="st">"100%"</span>)</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>pdf<span class="ot">=</span><span class="st">"TRUE"</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  message=FALSE,echo=FALSE}</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomcoloR)</span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a>As an illustrative example for interpreting <span class="co">[</span><span class="ot">metaDAG</span><span class="co">](https://bioinfo.uib.es/metadag/)</span> results, we consider here the Eukaryotes test presented in Section 2.5. Namely, we consider all Eukaryotes from the KEGG database.</span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a>First of all, results must be downloaded from:</span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-28"><a href="#cb158-28" aria-hidden="true" tabindex="-1"></a>Hash: <span class="co">[</span><span class="ot">0a845f74-826e-3b46-aed9-e7ecf74db262</span><span class="co">](https://bioinfo.uib.es/metadag/handleExperiment/result_0a845f74-826e-3b46-aed9-e7ecf74db262)</span>{.uri}</span>
<span id="cb158-29"><a href="#cb158-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-30"><a href="#cb158-30" aria-hidden="true" tabindex="-1"></a>URL: (https://bioinfo.uib.es/metadag/handleExperiment/result_0a845f74-826e-3b46-aed9-e7ecf74db262)</span>
<span id="cb158-31"><a href="#cb158-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-32"><a href="#cb158-32" aria-hidden="true" tabindex="-1"></a>and saved in the folder:</span>
<span id="cb158-33"><a href="#cb158-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-34"><a href="#cb158-34" aria-hidden="true" tabindex="-1"></a>"data/result_0a845f74-826e-3b46-aed9-e7ecf74db262".</span>
<span id="cb158-35"><a href="#cb158-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-36"><a href="#cb158-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup_load_data, include=FALSE,message=FALSE}</span></span>
<span id="cb158-37"><a href="#cb158-37" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>,</span>
<span id="cb158-38"><a href="#cb158-38" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cache=</span><span class="cn">FALSE</span>,</span>
<span id="cb158-39"><a href="#cb158-39" aria-hidden="true" tabindex="-1"></a>                      <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-40"><a href="#cb158-40" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">out.width =</span> <span class="st">"100%"</span>)</span>
<span id="cb158-41"><a href="#cb158-41" aria-hidden="true" tabindex="-1"></a>pdf<span class="ot">=</span><span class="st">"TRUE"</span></span>
<span id="cb158-42"><a href="#cb158-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-43"><a href="#cb158-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-44"><a href="#cb158-44" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  tidy,message=FALSE}</span></span>
<span id="cb158-45"><a href="#cb158-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb158-46"><a href="#cb158-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb158-47"><a href="#cb158-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb158-48"><a href="#cb158-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb158-49"><a href="#cb158-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb158-50"><a href="#cb158-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb158-51"><a href="#cb158-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomcoloR)</span>
<span id="cb158-52"><a href="#cb158-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb158-53"><a href="#cb158-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb158-54"><a href="#cb158-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb158-55"><a href="#cb158-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb158-56"><a href="#cb158-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb158-57"><a href="#cb158-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-58"><a href="#cb158-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-59"><a href="#cb158-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, echo=FALSE,include=FALSE}</span></span>
<span id="cb158-60"><a href="#cb158-60" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/screen_1.png"</span>)</span>
<span id="cb158-61"><a href="#cb158-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-62"><a href="#cb158-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-63"><a href="#cb158-63" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb158-64"><a href="#cb158-64" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/screen_2.png"</span>)</span>
<span id="cb158-65"><a href="#cb158-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-66"><a href="#cb158-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-67"><a href="#cb158-67" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb158-68"><a href="#cb158-68" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/screen_3.png"</span>)</span>
<span id="cb158-69"><a href="#cb158-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-70"><a href="#cb158-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-71"><a href="#cb158-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb158-72"><a href="#cb158-72" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/screen_4.png"</span>)</span>
<span id="cb158-73"><a href="#cb158-73" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-74"><a href="#cb158-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  include=FALSE,message=FALSE}</span></span>
<span id="cb158-75"><a href="#cb158-75" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>,</span>
<span id="cb158-76"><a href="#cb158-76" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cache=</span><span class="cn">FALSE</span>,</span>
<span id="cb158-77"><a href="#cb158-77" aria-hidden="true" tabindex="-1"></a>                      <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-78"><a href="#cb158-78" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">out.width =</span> <span class="st">"100%"</span>)</span>
<span id="cb158-79"><a href="#cb158-79" aria-hidden="true" tabindex="-1"></a>pdf<span class="ot">=</span><span class="st">"TRUE"</span></span>
<span id="cb158-80"><a href="#cb158-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-81"><a href="#cb158-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-82"><a href="#cb158-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,echo=FALSE}</span></span>
<span id="cb158-83"><a href="#cb158-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb158-84"><a href="#cb158-84" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb158-85"><a href="#cb158-85" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb158-86"><a href="#cb158-86" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb158-87"><a href="#cb158-87" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb158-88"><a href="#cb158-88" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb158-89"><a href="#cb158-89" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomcoloR)</span>
<span id="cb158-90"><a href="#cb158-90" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb158-91"><a href="#cb158-91" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb158-92"><a href="#cb158-92" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb158-93"><a href="#cb158-93" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb158-94"><a href="#cb158-94" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb158-95"><a href="#cb158-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-96"><a href="#cb158-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-97"><a href="#cb158-97" aria-hidden="true" tabindex="-1"></a><span class="fu"># Load data</span></span>
<span id="cb158-98"><a href="#cb158-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-101"><a href="#cb158-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-102"><a href="#cb158-102" aria-hidden="true" tabindex="-1"></a>experiment<span class="ot">=</span></span>
<span id="cb158-103"><a href="#cb158-103" aria-hidden="true" tabindex="-1"></a>  <span class="st">"result_0a845f74-826e-3b46-aed9-e7ecf74db262/"</span></span>
<span id="cb158-104"><a href="#cb158-104" aria-hidden="true" tabindex="-1"></a>path_exp<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">"data/"</span>,experiment)</span>
<span id="cb158-105"><a href="#cb158-105" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">data.frame</span>(</span>
<span id="cb158-106"><a href="#cb158-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">Directory_files_and_folders=</span><span class="fu">dir</span>(path_exp),</span>
<span id="cb158-107"><a href="#cb158-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Data file"</span>,<span class="dv">2</span>),</span>
<span id="cb158-108"><a href="#cb158-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">"Directory"</span>,<span class="dv">3</span>),</span>
<span id="cb158-109"><a href="#cb158-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">"Data file"</span>,<span class="dv">6</span>),</span>
<span id="cb158-110"><a href="#cb158-110" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Directory"</span>)))</span>
<span id="cb158-111"><a href="#cb158-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-112"><a href="#cb158-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-115"><a href="#cb158-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-116"><a href="#cb158-116" aria-hidden="true" tabindex="-1"></a>MBB<span class="ot">=</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Different_MBB.csv"</span>),</span>
<span id="cb158-117"><a href="#cb158-117" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb158-118"><a href="#cb158-118" aria-hidden="true" tabindex="-1"></a>mDAG<span class="ot">=</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Different_mDAG.csv"</span>),</span>
<span id="cb158-119"><a href="#cb158-119" aria-hidden="true" tabindex="-1"></a>              <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb158-120"><a href="#cb158-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-121"><a href="#cb158-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-122"><a href="#cb158-122" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load metadata</span></span>
<span id="cb158-123"><a href="#cb158-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-124"><a href="#cb158-124" aria-hidden="true" tabindex="-1"></a>Organisms are sorted by Kingdom, Phylum and Class:</span>
<span id="cb158-125"><a href="#cb158-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-128"><a href="#cb158-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-129"><a href="#cb158-129" aria-hidden="true" tabindex="-1"></a>path_exp</span>
<span id="cb158-130"><a href="#cb158-130" aria-hidden="true" tabindex="-1"></a>Results<span class="ot">=</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Results.csv"</span>))</span>
<span id="cb158-131"><a href="#cb158-131" aria-hidden="true" tabindex="-1"></a><span class="co">#rename MetaDaG variables</span></span>
<span id="cb158-132"><a href="#cb158-132" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)]<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Organism"</span>,<span class="st">"Categories"</span>,<span class="st">"Groups"</span>,<span class="st">"mDAG_Id"</span>,<span class="st">"Full_Name"</span>)</span>
<span id="cb158-133"><a href="#cb158-133" aria-hidden="true" tabindex="-1"></a>taxo<span class="ot">=</span>Results <span class="sc">%&gt;%</span> <span class="fu">select</span>(Organism<span class="sc">:</span>Full_Name)</span>
<span id="cb158-134"><a href="#cb158-134" aria-hidden="true" tabindex="-1"></a>taxo<span class="ot">=</span>taxo <span class="sc">%&gt;%</span> <span class="fu">separate</span>(Categories,<span class="at">into=</span><span class="fu">c</span>(<span class="st">"Kingdom"</span>,<span class="st">"Phylum"</span>,<span class="st">"Class"</span>))</span>
<span id="cb158-135"><a href="#cb158-135" aria-hidden="true" tabindex="-1"></a>index<span class="ot">=</span><span class="fu">which</span>(<span class="fu">is.na</span>(taxo<span class="sc">$</span>Class))</span>
<span id="cb158-136"><a href="#cb158-136" aria-hidden="true" tabindex="-1"></a>taxo<span class="sc">$</span>Class[index]<span class="ot">=</span><span class="fu">paste</span>(taxo<span class="sc">$</span>Phylum[index])</span>
<span id="cb158-137"><a href="#cb158-137" aria-hidden="true" tabindex="-1"></a>meta_taxo<span class="ot">=</span>taxo</span>
<span id="cb158-138"><a href="#cb158-138" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">table</span>(meta_taxo<span class="sc">$</span>Phylum)</span>
<span id="cb158-139"><a href="#cb158-139" aria-hidden="true" tabindex="-1"></a>Freq_Phylum<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">Phylum=</span><span class="fu">names</span>(aux),<span class="at">Freq_Phylum=</span>aux)</span>
<span id="cb158-140"><a href="#cb158-140" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Freq_Phylum)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Phylum"</span>,<span class="st">"Freq_Phylum"</span>)</span>
<span id="cb158-141"><a href="#cb158-141" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">table</span>(meta_taxo<span class="sc">$</span>Class)</span>
<span id="cb158-142"><a href="#cb158-142" aria-hidden="true" tabindex="-1"></a>Freq_Class<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">Class=</span><span class="fu">names</span>(aux),<span class="at">Freq_Class=</span>aux)</span>
<span id="cb158-143"><a href="#cb158-143" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Freq_Class)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Class"</span>,<span class="st">"Freq_Class"</span>)</span>
<span id="cb158-144"><a href="#cb158-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-145"><a href="#cb158-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-146"><a href="#cb158-146" aria-hidden="true" tabindex="-1"></a>meta_taxo <span class="ot">=</span> meta_taxo <span class="sc">%&gt;%</span> </span>
<span id="cb158-147"><a href="#cb158-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Freq_Phylum) <span class="sc">%&gt;%</span></span>
<span id="cb158-148"><a href="#cb158-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Freq_Class)</span>
<span id="cb158-149"><a href="#cb158-149" aria-hidden="true" tabindex="-1"></a>meta_taxo <span class="ot">=</span> meta_taxo <span class="sc">%&gt;%</span> </span>
<span id="cb158-150"><a href="#cb158-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Kingdom,<span class="fu">desc</span>(Freq_Phylum),Phylum,</span>
<span id="cb158-151"><a href="#cb158-151" aria-hidden="true" tabindex="-1"></a>          <span class="fu">desc</span>(Freq_Class),Class)</span>
<span id="cb158-152"><a href="#cb158-152" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(meta_taxo)</span>
<span id="cb158-153"><a href="#cb158-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-154"><a href="#cb158-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-157"><a href="#cb158-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-158"><a href="#cb158-158" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(meta_taxo<span class="sc">$</span>Kingdom) <span class="sc">%&gt;%</span> kable <span class="sc">%&gt;%</span></span>
<span id="cb158-159"><a href="#cb158-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, <span class="at">full_width =</span> F,<span class="at">position=</span><span class="st">"left"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb158-160"><a href="#cb158-160" aria-hidden="true" tabindex="-1"></a> <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"400px"</span>, <span class="at">height =</span> <span class="st">"200px"</span>)</span>
<span id="cb158-161"><a href="#cb158-161" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(meta_taxo<span class="sc">$</span>Phylum,meta_taxo<span class="sc">$</span>Kingdom) <span class="sc">%&gt;%</span> kable <span class="sc">%&gt;%</span></span>
<span id="cb158-162"><a href="#cb158-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, <span class="at">full_width =</span> F,<span class="at">position=</span><span class="st">"left"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb158-163"><a href="#cb158-163" aria-hidden="true" tabindex="-1"></a> <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"500px"</span>, <span class="at">height =</span> <span class="st">"500px"</span>)</span>
<span id="cb158-164"><a href="#cb158-164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-165"><a href="#cb158-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-166"><a href="#cb158-166" aria-hidden="true" tabindex="-1"></a><span class="fu">## Table of MBBs</span></span>
<span id="cb158-167"><a href="#cb158-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-168"><a href="#cb158-168" aria-hidden="true" tabindex="-1"></a>In this example <span class="in">`MBB`</span> is a table with <span class="in">`r nrow(MBB)`</span> rows and <span class="in">`r ncol(MBB)`</span> columns. It displays, for every MBB, the selected groups (Kingdoms, families, etc.) to which it belongs.</span>
<span id="cb158-169"><a href="#cb158-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-172"><a href="#cb158-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-173"><a href="#cb158-173" aria-hidden="true" tabindex="-1"></a><span class="co">#100</span></span>
<span id="cb158-174"><a href="#cb158-174" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(MBB[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]) <span class="sc">%&gt;%</span>   </span>
<span id="cb158-175"><a href="#cb158-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"200px"</span>)</span>
<span id="cb158-176"><a href="#cb158-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-177"><a href="#cb158-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-178"><a href="#cb158-178" aria-hidden="true" tabindex="-1"></a><span class="fu">## Table of m-DAGs</span></span>
<span id="cb158-179"><a href="#cb158-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-180"><a href="#cb158-180" aria-hidden="true" tabindex="-1"></a>In this example <span class="in">`mDAG`</span> is a table with <span class="in">`r nrow(mDAG)`</span> rows and <span class="in">`r ncol(mDAG)`</span> columns. It displays, for every m-DAG, the selected groups (Kingdoms, families, etc.) in which it belongs.</span>
<span id="cb158-181"><a href="#cb158-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-184"><a href="#cb158-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-185"><a href="#cb158-185" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(mDAG[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]) <span class="sc">%&gt;%</span>   <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"200px"</span>)</span>
<span id="cb158-186"><a href="#cb158-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-187"><a href="#cb158-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-190"><a href="#cb158-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-191"><a href="#cb158-191" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(mDAG)</span>
<span id="cb158-192"><a href="#cb158-192" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mDAG)[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb158-193"><a href="#cb158-193" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">names</span>(mDAG)[<span class="dv">7</span><span class="sc">:</span>(<span class="fu">dim</span>(mDAG)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1150</span>)])</span>
<span id="cb158-194"><a href="#cb158-194" aria-hidden="true" tabindex="-1"></a><span class="co"># 28 to 1213  code MBB: 1 if MBB in mDAG 0</span></span>
<span id="cb158-195"><a href="#cb158-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-196"><a href="#cb158-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-197"><a href="#cb158-197" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Table</span></span>
<span id="cb158-198"><a href="#cb158-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-199"><a href="#cb158-199" aria-hidden="true" tabindex="-1"></a>The <span class="in">`Results`</span> table contains for every organism (row) the following information: its category (taxonomy), selected group, Full name, m-DAG id and all reactions name id with their corresponding enzyme. When a reaction is present in the corresponding m-DAG, the MBB to which it belongs is displayed in this column.</span>
<span id="cb158-200"><a href="#cb158-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-203"><a href="#cb158-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-204"><a href="#cb158-204" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Results[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])<span class="sc">%&gt;%</span></span>
<span id="cb158-205"><a href="#cb158-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">angle =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb158-206"><a href="#cb158-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"300%"</span>, <span class="at">height =</span> <span class="st">"1000px"</span>)</span>
<span id="cb158-207"><a href="#cb158-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-208"><a href="#cb158-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-211"><a href="#cb158-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-212"><a href="#cb158-212" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Results)</span>
<span id="cb158-213"><a href="#cb158-213" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="dv">1</span>]<span class="co"># organisms  kegg id  class representant of mDAG</span></span>
<span id="cb158-214"><a href="#cb158-214" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="dv">2</span>]<span class="co"># taxonomy separate by |</span></span>
<span id="cb158-215"><a href="#cb158-215" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="dv">3</span>]<span class="co"># groups </span></span>
<span id="cb158-216"><a href="#cb158-216" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="dv">4</span>]<span class="co"># mDAG_Id </span></span>
<span id="cb158-217"><a href="#cb158-217" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="dv">5</span>]<span class="co"># Full name representant</span></span>
<span id="cb158-218"><a href="#cb158-218" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Results)[<span class="dv">6</span><span class="sc">:</span><span class="dv">36</span>]<span class="co"># columns 6 to 3998 </span></span>
<span id="cb158-219"><a href="#cb158-219" aria-hidden="true" tabindex="-1"></a><span class="co"># reactions name id with its enzyme.</span></span>
<span id="cb158-220"><a href="#cb158-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-221"><a href="#cb158-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-224"><a href="#cb158-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-225"><a href="#cb158-225" aria-hidden="true" tabindex="-1"></a>reactions<span class="ot">=</span><span class="fu">names</span>(Results)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)]</span>
<span id="cb158-226"><a href="#cb158-226" aria-hidden="true" tabindex="-1"></a>reverse_reactions<span class="ot">=</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(reactions,<span class="st">"rev"</span>)</span>
<span id="cb158-227"><a href="#cb158-227" aria-hidden="true" tabindex="-1"></a>reverse_reactions<span class="ot">=</span><span class="fu">table</span>(reverse_reactions)</span>
<span id="cb158-228"><a href="#cb158-228" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(reverse_reactions)<span class="sc">$</span>reverse_reactions<span class="ot">=</span></span>
<span id="cb158-229"><a href="#cb158-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"Non reverse reaction"</span>,<span class="st">"Reverse reaction"</span>)</span>
<span id="cb158-230"><a href="#cb158-230" aria-hidden="true" tabindex="-1"></a>reverse_reactions</span>
<span id="cb158-231"><a href="#cb158-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-232"><a href="#cb158-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-233"><a href="#cb158-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  include=FALSE,message=FALSE}</span></span>
<span id="cb158-234"><a href="#cb158-234" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>,</span>
<span id="cb158-235"><a href="#cb158-235" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cache=</span><span class="cn">FALSE</span>,</span>
<span id="cb158-236"><a href="#cb158-236" aria-hidden="true" tabindex="-1"></a>                      <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-237"><a href="#cb158-237" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">out.width =</span> <span class="st">"100%"</span>)</span>
<span id="cb158-238"><a href="#cb158-238" aria-hidden="true" tabindex="-1"></a>pdf<span class="ot">=</span><span class="st">"TRUE"</span></span>
<span id="cb158-239"><a href="#cb158-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-240"><a href="#cb158-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-241"><a href="#cb158-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,echo=FALSE}</span></span>
<span id="cb158-242"><a href="#cb158-242" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb158-243"><a href="#cb158-243" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb158-244"><a href="#cb158-244" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb158-245"><a href="#cb158-245" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb158-246"><a href="#cb158-246" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb158-247"><a href="#cb158-247" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb158-248"><a href="#cb158-248" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomcoloR)</span>
<span id="cb158-249"><a href="#cb158-249" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb158-250"><a href="#cb158-250" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb158-251"><a href="#cb158-251" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb158-252"><a href="#cb158-252" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb158-253"><a href="#cb158-253" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb158-254"><a href="#cb158-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-255"><a href="#cb158-255" aria-hidden="true" tabindex="-1"></a><span class="fu"># Metabolic Graphs</span></span>
<span id="cb158-256"><a href="#cb158-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-257"><a href="#cb158-257" aria-hidden="true" tabindex="-1"></a>We present here some analysis examples of the metabolic graphs generated in GraphML format.</span>
<span id="cb158-258"><a href="#cb158-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-259"><a href="#cb158-259" aria-hidden="true" tabindex="-1"></a><span class="fu">## Metabolic graphs for each organism</span></span>
<span id="cb158-260"><a href="#cb158-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-261"><a href="#cb158-261" aria-hidden="true" tabindex="-1"></a>Read the individual metabolic graphs generated for Homo sapiens (KEGG id: hsa) in the directory(Individuals/hsa)</span>
<span id="cb158-262"><a href="#cb158-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-265"><a href="#cb158-265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-266"><a href="#cb158-266" aria-hidden="true" tabindex="-1"></a>experiment<span class="ot">=</span></span>
<span id="cb158-267"><a href="#cb158-267" aria-hidden="true" tabindex="-1"></a>  <span class="st">"result_0a845f74-826e-3b46-aed9-e7ecf74db262/"</span></span>
<span id="cb158-268"><a href="#cb158-268" aria-hidden="true" tabindex="-1"></a>path_exp<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">"data/"</span>,experiment)</span>
<span id="cb158-269"><a href="#cb158-269" aria-hidden="true" tabindex="-1"></a>files_hsa<span class="ot">=</span><span class="fu">dir</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Individuals/hsa"</span>))</span>
<span id="cb158-270"><a href="#cb158-270" aria-hidden="true" tabindex="-1"></a>files_hsa</span>
<span id="cb158-271"><a href="#cb158-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-272"><a href="#cb158-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-273"><a href="#cb158-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb158-274"><a href="#cb158-274" aria-hidden="true" tabindex="-1"></a>files_hsa<span class="ot">=</span><span class="fu">dir</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Individuals/hsa"</span>))</span>
<span id="cb158-275"><a href="#cb158-275" aria-hidden="true" tabindex="-1"></a><span class="co"># "plot mDAG pdf format",</span></span>
<span id="cb158-276"><a href="#cb158-276" aria-hidden="true" tabindex="-1"></a><span class="co">#             "plot mDAG svg format",</span></span>
<span id="cb158-277"><a href="#cb158-277" aria-hidden="true" tabindex="-1"></a>type_file<span class="ot">=</span><span class="fu">c</span>(<span class="st">"m-DAG GraphML format"</span>,</span>
<span id="cb158-278"><a href="#cb158-278" aria-hidden="true" tabindex="-1"></a>            <span class="st">"m-DAG pdf graphic"</span>,</span>
<span id="cb158-279"><a href="#cb158-279" aria-hidden="true" tabindex="-1"></a>            <span class="st">"m-DAG svg graphic"</span>,</span>
<span id="cb158-280"><a href="#cb158-280" aria-hidden="true" tabindex="-1"></a>            <span class="st">"csv file with the adjacency matrix of the m-DAG"</span>,</span>
<span id="cb158-281"><a href="#cb158-281" aria-hidden="true" tabindex="-1"></a>            <span class="st">"pdf graphic with the biggest conected componet of the m-DAG"</span>,</span>
<span id="cb158-282"><a href="#cb158-282" aria-hidden="true" tabindex="-1"></a>            <span class="st">"svg graphic with the biggest conected componet of the m-DAG "</span>,</span>
<span id="cb158-283"><a href="#cb158-283" aria-hidden="true" tabindex="-1"></a>            <span class="st">"csv file with the node (MBBs) labels  of the m-DAG"</span>, </span>
<span id="cb158-284"><a href="#cb158-284" aria-hidden="true" tabindex="-1"></a>            <span class="st">"csv file with all connected components of the m-DAG"</span>,</span>
<span id="cb158-285"><a href="#cb158-285" aria-hidden="true" tabindex="-1"></a>            <span class="st">"csv file with the  adjacency matrix of the reaction graph"</span>,</span>
<span id="cb158-286"><a href="#cb158-286" aria-hidden="true" tabindex="-1"></a>            <span class="st">"csv file with the node (reactions) labels  of the reaction graph"</span>, </span>
<span id="cb158-287"><a href="#cb158-287" aria-hidden="true" tabindex="-1"></a>            <span class="st">"reaction graph  GraphML format"</span>,</span>
<span id="cb158-288"><a href="#cb158-288" aria-hidden="true" tabindex="-1"></a>            <span class="st">"reaction graph pdf graphic"</span>,</span>
<span id="cb158-289"><a href="#cb158-289" aria-hidden="true" tabindex="-1"></a>            <span class="st">"reaction graph svg graphic"</span>,</span>
<span id="cb158-290"><a href="#cb158-290" aria-hidden="true" tabindex="-1"></a>            <span class="st">"text summary file with the number of MBBs, reactions, etc. in the previous graphs"</span></span>
<span id="cb158-291"><a href="#cb158-291" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb158-292"><a href="#cb158-292" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">data.frame</span>(<span class="at">files_Individual_hsa=</span>files_hsa, <span class="at">Description=</span>type_file))</span>
<span id="cb158-293"><a href="#cb158-293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-294"><a href="#cb158-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-295"><a href="#cb158-295" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pan &amp; core metabolic graphs</span></span>
<span id="cb158-296"><a href="#cb158-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-297"><a href="#cb158-297" aria-hidden="true" tabindex="-1"></a>Pan and core metabolic graphs for every group were generated. For instance, one can read the pan and core metabolic graphs generated for the group Algae in the directory (Groups/Algae).</span>
<span id="cb158-298"><a href="#cb158-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-301"><a href="#cb158-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-302"><a href="#cb158-302" aria-hidden="true" tabindex="-1"></a>files_Algae<span class="ot">=</span><span class="fu">dir</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Groups/Algae"</span>))</span>
<span id="cb158-303"><a href="#cb158-303" aria-hidden="true" tabindex="-1"></a>files_Algae</span>
<span id="cb158-304"><a href="#cb158-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-305"><a href="#cb158-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-306"><a href="#cb158-306" aria-hidden="true" tabindex="-1"></a>The global core reaction graph, which is the core of all the organisms' reaction graphs in this Eukaryotes test, is empty.</span>
<span id="cb158-307"><a href="#cb158-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-308"><a href="#cb158-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r graph_core_ALL}</span></span>
<span id="cb158-309"><a href="#cb158-309" aria-hidden="true" tabindex="-1"></a>graph_core_RC<span class="ot">=</span><span class="fu">read.graph</span>(</span>
<span id="cb158-310"><a href="#cb158-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(path_exp,</span>
<span id="cb158-311"><a href="#cb158-311" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Global/core/core_RC.graphml"</span>),</span>
<span id="cb158-312"><a href="#cb158-312" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">"graphml"</span>)</span>
<span id="cb158-313"><a href="#cb158-313" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(graph_core_RC)</span>
<span id="cb158-314"><a href="#cb158-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-315"><a href="#cb158-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-316"><a href="#cb158-316" aria-hidden="true" tabindex="-1"></a>The global core reaction graph has <span class="in">`r igraph::vcount(graph_core_RC)`</span> vertex and <span class="in">`r igraph::ecount(graph_core_RC)`</span> edges. It is an empty graph.</span>
<span id="cb158-317"><a href="#cb158-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-318"><a href="#cb158-318" aria-hidden="true" tabindex="-1"></a>The core reaction graph for the Algae group is:</span>
<span id="cb158-319"><a href="#cb158-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-320"><a href="#cb158-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.cap="Algae core reaction graph"}</span></span>
<span id="cb158-321"><a href="#cb158-321" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(</span>
<span id="cb158-322"><a href="#cb158-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(path_exp,<span class="st">"Groups/MSA_Cluster_3/core/MSA_Cluster_3_core_RC.pdf"</span>))</span>
<span id="cb158-323"><a href="#cb158-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-324"><a href="#cb158-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-325"><a href="#cb158-325" aria-hidden="true" tabindex="-1"></a>The global core m-DAG, i.e., the core of all organisms in this example is empty.</span>
<span id="cb158-326"><a href="#cb158-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-329"><a href="#cb158-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-330"><a href="#cb158-330" aria-hidden="true" tabindex="-1"></a>graph_core_mDAG<span class="ot">=</span><span class="fu">read.graph</span>(</span>
<span id="cb158-331"><a href="#cb158-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(path_exp,<span class="st">"Global/core/core_mDAG.graphml"</span>),</span>
<span id="cb158-332"><a href="#cb158-332" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">"graphml"</span>)</span>
<span id="cb158-333"><a href="#cb158-333" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(graph_core_mDAG)</span>
<span id="cb158-334"><a href="#cb158-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-335"><a href="#cb158-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-336"><a href="#cb158-336" aria-hidden="true" tabindex="-1"></a>The global core m-DAG has <span class="in">`r igraph::vcount(graph_core_mDAG)`</span> vertex and <span class="in">`r igraph::ecount(graph_core_mDAG)`</span> edges. It is an empty graph.</span>
<span id="cb158-337"><a href="#cb158-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-338"><a href="#cb158-338" aria-hidden="true" tabindex="-1"></a>The core metabolic DAG for the Algae group is:</span>
<span id="cb158-339"><a href="#cb158-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-340"><a href="#cb158-340" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.cap="Core m-DAG for Algae"}</span></span>
<span id="cb158-341"><a href="#cb158-341" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">paste0</span>(path_exp,                              <span class="st">"Groups/Algae/core/Algae_core_mDAG.pdf"</span>))</span>
<span id="cb158-342"><a href="#cb158-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-343"><a href="#cb158-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-344"><a href="#cb158-344" aria-hidden="true" tabindex="-1"></a>The global pan reaction graph for the Animals Kingdom is:</span>
<span id="cb158-345"><a href="#cb158-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-348"><a href="#cb158-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-349"><a href="#cb158-349" aria-hidden="true" tabindex="-1"></a>graph_pan_RC<span class="ot">=</span><span class="fu">read.graph</span>(</span>
<span id="cb158-350"><a href="#cb158-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(path_exp,</span>
<span id="cb158-351"><a href="#cb158-351" aria-hidden="true" tabindex="-1"></a>         <span class="st">"TaxonomyLevels/Kingdom/Animals/pan/Animals_pan_RC.graphml"</span>),</span>
<span id="cb158-352"><a href="#cb158-352" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">"graphml"</span>)</span>
<span id="cb158-353"><a href="#cb158-353" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(graph_pan_RC)</span>
<span id="cb158-354"><a href="#cb158-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-355"><a href="#cb158-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-356"><a href="#cb158-356" aria-hidden="true" tabindex="-1"></a>This pan reaction graph has <span class="in">`r igraph::vcount(graph_pan_RC)`</span> nodes and <span class="in">`r igraph::ecount(graph_pan_RC)`</span> edges.</span>
<span id="cb158-357"><a href="#cb158-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-358"><a href="#cb158-358" aria-hidden="true" tabindex="-1"></a><span class="fu">## Graph's topology</span></span>
<span id="cb158-359"><a href="#cb158-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-360"><a href="#cb158-360" aria-hidden="true" tabindex="-1"></a>From the GraphML files, one can extract topological information. Some examples are as follows.</span>
<span id="cb158-361"><a href="#cb158-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-362"><a href="#cb158-362" aria-hidden="true" tabindex="-1"></a>The diagram below illustrates the distribution of node degrees for an m-DAG.</span>
<span id="cb158-363"><a href="#cb158-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-366"><a href="#cb158-366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-367"><a href="#cb158-367" aria-hidden="true" tabindex="-1"></a>graph_mDAG<span class="ot">=</span><span class="fu">read.graph</span>(</span>
<span id="cb158-368"><a href="#cb158-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(path_exp,</span>
<span id="cb158-369"><a href="#cb158-369" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Individuals/hsa/hsa_mDAG.graphml"</span>),</span>
<span id="cb158-370"><a href="#cb158-370" aria-hidden="true" tabindex="-1"></a>  <span class="at">format=</span> <span class="st">"graphml"</span>)</span>
<span id="cb158-371"><a href="#cb158-371" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(graph_mDAG)</span>
<span id="cb158-372"><a href="#cb158-372" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(igraph<span class="sc">::</span><span class="fu">degree</span>(graph_mDAG,<span class="at">mode=</span><span class="st">"all"</span>)),</span>
<span id="cb158-373"><a href="#cb158-373" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">350</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb158-374"><a href="#cb158-374" aria-hidden="true" tabindex="-1"></a>              <span class="at">main=</span><span class="st">"Frequency of Node Degrees"</span>,</span>
<span id="cb158-375"><a href="#cb158-375" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylab=</span><span class="st">"Frequency"</span>,<span class="at">xlab=</span><span class="st">"Degree"</span>)</span>
<span id="cb158-376"><a href="#cb158-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-377"><a href="#cb158-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-378"><a href="#cb158-378" aria-hidden="true" tabindex="-1"></a>The connected components of every graph as well as the size of every connected component can be obtained as:</span>
<span id="cb158-379"><a href="#cb158-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-382"><a href="#cb158-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-383"><a href="#cb158-383" aria-hidden="true" tabindex="-1"></a>compo<span class="ot">=</span><span class="fu">components</span>(graph_mDAG,<span class="at">mode =</span> <span class="st">"weak"</span>)</span>
<span id="cb158-384"><a href="#cb158-384" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(compo)</span>
<span id="cb158-385"><a href="#cb158-385" aria-hidden="true" tabindex="-1"></a>compo<span class="sc">$</span>csize</span>
<span id="cb158-386"><a href="#cb158-386" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="fu">which.max</span>(compo<span class="sc">$</span>csize<span class="sc">==</span><span class="fu">max</span>(compo<span class="sc">$</span>csize))</span>
<span id="cb158-387"><a href="#cb158-387" aria-hidden="true" tabindex="-1"></a>k</span>
<span id="cb158-388"><a href="#cb158-388" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(compo<span class="sc">$</span>membership)</span>
<span id="cb158-389"><a href="#cb158-389" aria-hidden="true" tabindex="-1"></a>vertex<span class="ot">=</span><span class="fu">which</span>(compo<span class="sc">$</span>membership<span class="sc">==</span>k)</span>
<span id="cb158-390"><a href="#cb158-390" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(vertex)</span>
<span id="cb158-391"><a href="#cb158-391" aria-hidden="true" tabindex="-1"></a>Big_Component<span class="ot">=</span><span class="fu">induced_subgraph</span>(graph_mDAG, <span class="at">vids=</span>vertex)</span>
<span id="cb158-392"><a href="#cb158-392" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">vcount</span>(Big_Component)</span>
<span id="cb158-393"><a href="#cb158-393" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">ecount</span>(Big_Component)</span>
<span id="cb158-394"><a href="#cb158-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-395"><a href="#cb158-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-396"><a href="#cb158-396" aria-hidden="true" tabindex="-1"></a>And the plot of the bigger component of the m-DAG in Homo sapiens is:</span>
<span id="cb158-397"><a href="#cb158-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-398"><a href="#cb158-398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.align='center',title="Bigger componet of hsa mDAG"}</span></span>
<span id="cb158-399"><a href="#cb158-399" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">paste0</span>(path_exp,</span>
<span id="cb158-400"><a href="#cb158-400" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Individuals/hsa/hsa_mDAG_biggerDAG.pdf"</span>))</span>
<span id="cb158-401"><a href="#cb158-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-402"><a href="#cb158-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-405"><a href="#cb158-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-406"><a href="#cb158-406" aria-hidden="true" tabindex="-1"></a><span class="co">#path_exp="data/result_bb261b6e-95c6-3e39-b82b-b68eea80e30b/data/" </span></span>
<span id="cb158-407"><a href="#cb158-407" aria-hidden="true" tabindex="-1"></a>list_names<span class="ot">=</span><span class="fu">dir</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Individuals/"</span>))</span>
<span id="cb158-408"><a href="#cb158-408" aria-hidden="true" tabindex="-1"></a>list_names<span class="ot">=</span> list_names[<span class="sc">-</span><span class="dv">1</span>] <span class="co"># filter 0000_RefPw</span></span>
<span id="cb158-409"><a href="#cb158-409" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(list_names) </span>
<span id="cb158-410"><a href="#cb158-410" aria-hidden="true" tabindex="-1"></a>graphs_list<span class="ot">=</span><span class="fu">paste0</span>(path_exp,<span class="st">"Individuals/"</span>, list_names,<span class="st">"/"</span>,list_names, <span class="st">"_MDAG.graphml"</span>)</span>
<span id="cb158-411"><a href="#cb158-411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-412"><a href="#cb158-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-415"><a href="#cb158-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-416"><a href="#cb158-416" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(</span>
<span id="cb158-417"><a href="#cb158-417" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(path_exp,<span class="st">"Individuals/cang/cang_RC.pdf"</span>))</span>
<span id="cb158-418"><a href="#cb158-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-419"><a href="#cb158-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-420"><a href="#cb158-420" aria-hidden="true" tabindex="-1"></a><span class="fu">## Graph statistics</span></span>
<span id="cb158-421"><a href="#cb158-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-422"><a href="#cb158-422" aria-hidden="true" tabindex="-1"></a>The number of connected component in each generated m-DAG with their frequency in the entire set of m-DAGs, can be obtained as follows:</span>
<span id="cb158-423"><a href="#cb158-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-426"><a href="#cb158-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-427"><a href="#cb158-427" aria-hidden="true" tabindex="-1"></a>read_mDAG<span class="ot">=</span><span class="cf">function</span>(x) {DAG<span class="ot">=</span><span class="fu">read.graph</span>(<span class="at">file=</span>x,</span>
<span id="cb158-428"><a href="#cb158-428" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">format=</span><span class="st">"graphml"</span>)</span>
<span id="cb158-429"><a href="#cb158-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(DAG)}</span>
<span id="cb158-430"><a href="#cb158-430" aria-hidden="true" tabindex="-1"></a>mDAG_componets<span class="ot">=</span><span class="cf">function</span>(x) {</span>
<span id="cb158-431"><a href="#cb158-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="fu">components</span>(x,<span class="at">mode =</span> <span class="st">"weak"</span>)<span class="sc">$</span>csize,</span>
<span id="cb158-432"><a href="#cb158-432" aria-hidden="true" tabindex="-1"></a>       <span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb158-433"><a href="#cb158-433" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb158-434"><a href="#cb158-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-435"><a href="#cb158-435" aria-hidden="true" tabindex="-1"></a>compo_list<span class="ot">=</span><span class="fu">lapply</span>(graphs_list,</span>
<span id="cb158-436"><a href="#cb158-436" aria-hidden="true" tabindex="-1"></a>                  <span class="at">FUN=</span><span class="cf">function</span>(x) {</span>
<span id="cb158-437"><a href="#cb158-437" aria-hidden="true" tabindex="-1"></a>                    gg<span class="ot">=</span><span class="fu">read_mDAG</span>(x)</span>
<span id="cb158-438"><a href="#cb158-438" aria-hidden="true" tabindex="-1"></a>                  aux<span class="ot">=</span><span class="fu">list</span>(</span>
<span id="cb158-439"><a href="#cb158-439" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mDAG_componets=</span><span class="fu">mDAG_componets</span>(gg),</span>
<span id="cb158-440"><a href="#cb158-440" aria-hidden="true" tabindex="-1"></a>                    <span class="at">degree_count=</span>igraph<span class="sc">::</span><span class="fu">degree</span>(gg,<span class="at">mode=</span><span class="st">"total"</span>))</span>
<span id="cb158-441"><a href="#cb158-441" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">return</span>(aux)}</span>
<span id="cb158-442"><a href="#cb158-442" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb158-443"><a href="#cb158-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-444"><a href="#cb158-444" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(compo_list)<span class="ot">=</span>list_names</span>
<span id="cb158-445"><a href="#cb158-445" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">max</span>(<span class="fu">sapply</span>(compo_list,<span class="at">FUN=</span><span class="cf">function</span>(x) {<span class="fu">length</span>(x[[<span class="dv">1</span>]])}))</span>
<span id="cb158-446"><a href="#cb158-446" aria-hidden="true" tabindex="-1"></a>n</span>
<span id="cb158-447"><a href="#cb158-447" aria-hidden="true" tabindex="-1"></a>size_compo_list<span class="ot">=</span><span class="fu">lapply</span>(compo_list,<span class="at">FUN=</span><span class="cf">function</span>(x) {</span>
<span id="cb158-448"><a href="#cb158-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(x[[<span class="dv">1</span>]],<span class="fu">rep</span>(<span class="cn">NA</span>,n<span class="sc">-</span><span class="fu">length</span>(x[[<span class="dv">1</span>]]))))})</span>
<span id="cb158-449"><a href="#cb158-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-450"><a href="#cb158-450" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">do.call</span>(bind_cols,size_compo_list)</span>
<span id="cb158-451"><a href="#cb158-451" aria-hidden="true" tabindex="-1"></a>aux2<span class="ot">=</span><span class="fu">pivot_longer</span>(aux,aaf<span class="sc">:</span>zvi,<span class="at">names_to=</span><span class="st">"Organism"</span>,</span>
<span id="cb158-452"><a href="#cb158-452" aria-hidden="true" tabindex="-1"></a>                  <span class="at">values_to=</span><span class="st">"csize"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-453"><a href="#cb158-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Organism,<span class="sc">-</span>csize)</span>
<span id="cb158-454"><a href="#cb158-454" aria-hidden="true" tabindex="-1"></a>aux2<span class="sc">$</span>index<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">times=</span><span class="fu">dim</span>(aux)[<span class="dv">2</span>])</span>
<span id="cb158-455"><a href="#cb158-455" aria-hidden="true" tabindex="-1"></a>aux2<span class="ot">=</span>aux2 <span class="sc">%&gt;%</span></span>
<span id="cb158-456"><a href="#cb158-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(meta_taxo,<span class="at">by=</span><span class="st">"Organism"</span>)</span>
<span id="cb158-457"><a href="#cb158-457" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-458"><a href="#cb158-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-461"><a href="#cb158-461" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-462"><a href="#cb158-462" aria-hidden="true" tabindex="-1"></a>Organism<span class="ot">=</span><span class="fu">names</span>(compo_list)</span>
<span id="cb158-463"><a href="#cb158-463" aria-hidden="true" tabindex="-1"></a>big_MBB<span class="ot">=</span><span class="cf">function</span>(org){</span>
<span id="cb158-464"><a href="#cb158-464" aria-hidden="true" tabindex="-1"></a>  org<span class="ot">=</span><span class="st">"hsa"</span></span>
<span id="cb158-465"><a href="#cb158-465" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span>Results <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Organism<span class="sc">==</span>org)</span>
<span id="cb158-466"><a href="#cb158-466" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">as.character</span>(x[<span class="dv">1</span>,<span class="dv">5</span><span class="sc">:</span><span class="fu">dim</span>(Results)[<span class="dv">2</span>]])</span>
<span id="cb158-467"><a href="#cb158-467" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span>x[x<span class="sc">!=</span><span class="st">"NA"</span>]</span>
<span id="cb158-468"><a href="#cb158-468" aria-hidden="true" tabindex="-1"></a>  tt<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">table</span>(x),<span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb158-469"><a href="#cb158-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tt)</span>
<span id="cb158-470"><a href="#cb158-470" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb158-471"><a href="#cb158-471" aria-hidden="true" tabindex="-1"></a>big_MBB_list<span class="ot">=</span> <span class="fu">lapply</span>(Organism,<span class="at">FUN=</span><span class="cf">function</span>(x) <span class="fu">big_MBB</span>(x))</span>
<span id="cb158-472"><a href="#cb158-472" aria-hidden="true" tabindex="-1"></a>nMBB<span class="ot">=</span><span class="fu">max</span>(<span class="fu">sapply</span>(big_MBB_list,<span class="at">FUN=</span><span class="cf">function</span>(x) <span class="fu">length</span>(x)))</span>
<span id="cb158-473"><a href="#cb158-473" aria-hidden="true" tabindex="-1"></a>nMBB</span>
<span id="cb158-474"><a href="#cb158-474" aria-hidden="true" tabindex="-1"></a>big_MBB_list<span class="ot">=</span><span class="fu">lapply</span>(big_MBB_list,</span>
<span id="cb158-475"><a href="#cb158-475" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FUN=</span><span class="cf">function</span>(x){</span>
<span id="cb158-476"><a href="#cb158-476" aria-hidden="true" tabindex="-1"></a>                      x<span class="ot">=</span><span class="fu">c</span>(x,<span class="fu">rep</span>(<span class="cn">NA</span>,nMBB<span class="sc">-</span><span class="fu">length</span>(x)))</span>
<span id="cb158-477"><a href="#cb158-477" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">return</span>(x)}</span>
<span id="cb158-478"><a href="#cb158-478" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb158-479"><a href="#cb158-479" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(big_MBB_list)<span class="ot">=</span>Organism</span>
<span id="cb158-480"><a href="#cb158-480" aria-hidden="true" tabindex="-1"></a>big_MBB_list<span class="ot">=</span><span class="fu">do.call</span>(bind_cols,big_MBB_list)</span>
<span id="cb158-481"><a href="#cb158-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-482"><a href="#cb158-482" aria-hidden="true" tabindex="-1"></a>kMBB<span class="ot">=</span><span class="fu">nrow</span>(big_MBB_list)</span>
<span id="cb158-483"><a href="#cb158-483" aria-hidden="true" tabindex="-1"></a>index<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>kMBB,<span class="at">times=</span><span class="fu">length</span>(Organism))</span>
<span id="cb158-484"><a href="#cb158-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-485"><a href="#cb158-485" aria-hidden="true" tabindex="-1"></a>big_MBB_list2<span class="ot">=</span><span class="fu">pivot_longer</span>(big_MBB_list,</span>
<span id="cb158-486"><a href="#cb158-486" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cols=</span><span class="fu">names</span>(big_MBB_list),</span>
<span id="cb158-487"><a href="#cb158-487" aria-hidden="true" tabindex="-1"></a>                           <span class="at">values_to =</span> <span class="st">"MBBsize"</span>,</span>
<span id="cb158-488"><a href="#cb158-488" aria-hidden="true" tabindex="-1"></a>                           <span class="at">names_to =</span> <span class="st">"Organism"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb158-489"><a href="#cb158-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Organism,<span class="sc">-</span>MBBsize) <span class="sc">%&gt;%</span>  </span>
<span id="cb158-490"><a href="#cb158-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index=</span>index) <span class="sc">%&gt;%</span> </span>
<span id="cb158-491"><a href="#cb158-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(meta_taxo,<span class="at">by=</span><span class="st">"Organism"</span>)</span>
<span id="cb158-492"><a href="#cb158-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-493"><a href="#cb158-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-494"><a href="#cb158-494" aria-hidden="true" tabindex="-1"></a>We can visualize the sizes of the MBBs for each m-DAG, using colors to represent the different Kingdoms:</span>
<span id="cb158-495"><a href="#cb158-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-498"><a href="#cb158-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-499"><a href="#cb158-499" aria-hidden="true" tabindex="-1"></a>COLOR_KINGDOM<span class="ot">=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"green"</span>,<span class="st">"yellow"</span>,<span class="st">"black"</span>)</span>
<span id="cb158-500"><a href="#cb158-500" aria-hidden="true" tabindex="-1"></a>colors_kingdom<span class="ot">=</span>big_MBB_list2 <span class="sc">%&gt;%</span></span>
<span id="cb158-501"><a href="#cb158-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Organism,Kingdom) <span class="sc">%&gt;%</span></span>
<span id="cb158-502"><a href="#cb158-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb158-503"><a href="#cb158-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-504"><a href="#cb158-504" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(COLOR_KINGDOM)<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">unique</span>(colors_kingdom<span class="sc">$</span>Kingdom))</span>
<span id="cb158-505"><a href="#cb158-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-506"><a href="#cb158-506" aria-hidden="true" tabindex="-1"></a>p0<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data=</span>big_MBB_list2) <span class="sc">+</span> </span>
<span id="cb158-507"><a href="#cb158-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb158-508"><a href="#cb158-508" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>MBBsize,</span>
<span id="cb158-509"><a href="#cb158-509" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group =</span> Organism,</span>
<span id="cb158-510"><a href="#cb158-510" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span>Kingdom)) <span class="sc">+</span> </span>
<span id="cb158-511"><a href="#cb158-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> </span>
<span id="cb158-512"><a href="#cb158-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'identity'</span>) <span class="sc">+</span></span>
<span id="cb158-513"><a href="#cb158-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom]) <span class="sc">+</span></span>
<span id="cb158-514"><a href="#cb158-514" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Plot log-identity of MBB </span><span class="sc">\n</span><span class="st">  decreasing index."</span>) <span class="sc">+</span></span>
<span id="cb158-515"><a href="#cb158-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Log10 MBB size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Index"</span>)</span>
<span id="cb158-516"><a href="#cb158-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-517"><a href="#cb158-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-518"><a href="#cb158-518" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>big_MBB_list2) <span class="sc">+</span> </span>
<span id="cb158-519"><a href="#cb158-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb158-520"><a href="#cb158-520" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>MBBsize,</span>
<span id="cb158-521"><a href="#cb158-521" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group =</span> Organism,<span class="at">color=</span>Kingdom),</span>
<span id="cb158-522"><a href="#cb158-522" aria-hidden="true" tabindex="-1"></a>                        <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb158-523"><a href="#cb158-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> </span>
<span id="cb158-524"><a href="#cb158-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span></span>
<span id="cb158-525"><a href="#cb158-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom]) <span class="sc">+</span></span>
<span id="cb158-526"><a href="#cb158-526" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Plot log10-log10identity of MBB </span><span class="sc">\n</span><span class="st">  decreasing index."</span>) <span class="sc">+</span></span>
<span id="cb158-527"><a href="#cb158-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Log10 MBB size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Log10 Index"</span>)</span>
<span id="cb158-528"><a href="#cb158-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-529"><a href="#cb158-529" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>big_MBB_list2) <span class="sc">+</span> </span>
<span id="cb158-530"><a href="#cb158-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb158-531"><a href="#cb158-531" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>MBBsize,</span>
<span id="cb158-532"><a href="#cb158-532" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group =</span> Organism, </span>
<span id="cb158-533"><a href="#cb158-533" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span>Kingdom),</span>
<span id="cb158-534"><a href="#cb158-534" aria-hidden="true" tabindex="-1"></a>            <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb158-535"><a href="#cb158-535" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb158-536"><a href="#cb158-536" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb158-537"><a href="#cb158-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1039</span>)<span class="sc">+</span> </span>
<span id="cb158-538"><a href="#cb158-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Plot  of MBB sized  decreasing index."</span>) <span class="sc">+</span></span>
<span id="cb158-539"><a href="#cb158-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"MBB size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Index"</span>) <span class="sc">+</span></span>
<span id="cb158-540"><a href="#cb158-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom])</span>
<span id="cb158-541"><a href="#cb158-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-542"><a href="#cb158-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-543"><a href="#cb158-543" aria-hidden="true" tabindex="-1"></a>p0</span>
<span id="cb158-544"><a href="#cb158-544" aria-hidden="true" tabindex="-1"></a>p1</span>
<span id="cb158-545"><a href="#cb158-545" aria-hidden="true" tabindex="-1"></a>p2</span>
<span id="cb158-546"><a href="#cb158-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-547"><a href="#cb158-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-548"><a href="#cb158-548" aria-hidden="true" tabindex="-1"></a>Additionally, we visualize the sizes of the MBBs of each m-DAG, using colors to represent the different Kingdoms:</span>
<span id="cb158-549"><a href="#cb158-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-552"><a href="#cb158-552" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-553"><a href="#cb158-553" aria-hidden="true" tabindex="-1"></a>COLOR_KINGDOM<span class="ot">=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"yellow"</span>,<span class="st">"green"</span>,<span class="st">"yellow"</span>,<span class="st">"black"</span>)</span>
<span id="cb158-554"><a href="#cb158-554" aria-hidden="true" tabindex="-1"></a>colors_kingdom<span class="ot">=</span>aux2<span class="sc">%&gt;%</span> <span class="fu">select</span>(Organism,Kingdom) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb158-555"><a href="#cb158-555" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(COLOR_KINGDOM)<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">unique</span>(colors_kingdom<span class="sc">$</span>Kingdom))</span>
<span id="cb158-556"><a href="#cb158-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-557"><a href="#cb158-557" aria-hidden="true" tabindex="-1"></a>p0<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data=</span>aux2) <span class="sc">+</span> </span>
<span id="cb158-558"><a href="#cb158-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb158-559"><a href="#cb158-559" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>csize,</span>
<span id="cb158-560"><a href="#cb158-560" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group =</span> Organism,</span>
<span id="cb158-561"><a href="#cb158-561" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span>Kingdom),</span>
<span id="cb158-562"><a href="#cb158-562" aria-hidden="true" tabindex="-1"></a>            <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb158-563"><a href="#cb158-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> </span>
<span id="cb158-564"><a href="#cb158-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'identity'</span>) <span class="sc">+</span></span>
<span id="cb158-565"><a href="#cb158-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom]) <span class="sc">+</span></span>
<span id="cb158-566"><a href="#cb158-566" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Plot log-identity of size  weak components decreasing order"</span>) <span class="sc">+</span></span>
<span id="cb158-567"><a href="#cb158-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Log10 Weak componente size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Order"</span>)</span>
<span id="cb158-568"><a href="#cb158-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-569"><a href="#cb158-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-570"><a href="#cb158-570" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>aux2) <span class="sc">+</span> </span>
<span id="cb158-571"><a href="#cb158-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb158-572"><a href="#cb158-572" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>csize,<span class="at">group =</span> Organism,</span>
<span id="cb158-573"><a href="#cb158-573" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span>Kingdom),</span>
<span id="cb158-574"><a href="#cb158-574" aria-hidden="true" tabindex="-1"></a>            <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb158-575"><a href="#cb158-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> </span>
<span id="cb158-576"><a href="#cb158-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span></span>
<span id="cb158-577"><a href="#cb158-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom])<span class="sc">+</span></span>
<span id="cb158-578"><a href="#cb158-578" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Plot log10-log10 of size  weak components decreasing order."</span>) <span class="sc">+</span></span>
<span id="cb158-579"><a href="#cb158-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Log10 weak component size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Log10 order"</span>)</span>
<span id="cb158-580"><a href="#cb158-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-581"><a href="#cb158-581" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>aux2) <span class="sc">+</span> </span>
<span id="cb158-582"><a href="#cb158-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb158-583"><a href="#cb158-583" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>csize,<span class="at">group =</span> Organism,</span>
<span id="cb158-584"><a href="#cb158-584" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span>Kingdom),</span>
<span id="cb158-585"><a href="#cb158-585" aria-hidden="true" tabindex="-1"></a>            <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb158-586"><a href="#cb158-586" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb158-587"><a href="#cb158-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb158-588"><a href="#cb158-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1039</span>)<span class="sc">+</span></span>
<span id="cb158-589"><a href="#cb158-589" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Plot  of size  weak components decreasing order."</span>)<span class="sc">+</span></span>
<span id="cb158-590"><a href="#cb158-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Weak components size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Order"</span>)<span class="sc">+</span></span>
<span id="cb158-591"><a href="#cb158-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom])</span>
<span id="cb158-592"><a href="#cb158-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-593"><a href="#cb158-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-594"><a href="#cb158-594" aria-hidden="true" tabindex="-1"></a>p0</span>
<span id="cb158-595"><a href="#cb158-595" aria-hidden="true" tabindex="-1"></a>p1</span>
<span id="cb158-596"><a href="#cb158-596" aria-hidden="true" tabindex="-1"></a>p2</span>
<span id="cb158-597"><a href="#cb158-597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-598"><a href="#cb158-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-601"><a href="#cb158-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-602"><a href="#cb158-602" aria-hidden="true" tabindex="-1"></a>data2<span class="ot">=</span>big_MBB_list2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(index <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb158-603"><a href="#cb158-603" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>data2) <span class="sc">+</span> </span>
<span id="cb158-604"><a href="#cb158-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>index,</span>
<span id="cb158-605"><a href="#cb158-605" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span>MBBsize,</span>
<span id="cb158-606"><a href="#cb158-606" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group =</span> Organism,</span>
<span id="cb158-607"><a href="#cb158-607" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color=</span>Kingdom),</span>
<span id="cb158-608"><a href="#cb158-608" aria-hidden="true" tabindex="-1"></a>            <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb158-609"><a href="#cb158-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb158-610"><a href="#cb158-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb158-611"><a href="#cb158-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">25</span>)<span class="sc">+</span></span>
<span id="cb158-612"><a href="#cb158-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Plot  of size  weak components  decreasing order 2 to 20."</span>)<span class="sc">+</span></span>
<span id="cb158-613"><a href="#cb158-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Weak components size"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Order"</span>)<span class="sc">+</span></span>
<span id="cb158-614"><a href="#cb158-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span>COLOR_KINGDOM[colors_kingdom<span class="sc">$</span>Kingdom])</span>
<span id="cb158-615"><a href="#cb158-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-616"><a href="#cb158-616" aria-hidden="true" tabindex="-1"></a>p3</span>
<span id="cb158-617"><a href="#cb158-617" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-618"><a href="#cb158-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-619"><a href="#cb158-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-620"><a href="#cb158-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  include=FALSE,message=FALSE}</span></span>
<span id="cb158-621"><a href="#cb158-621" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>,</span>
<span id="cb158-622"><a href="#cb158-622" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cache=</span><span class="cn">FALSE</span>,</span>
<span id="cb158-623"><a href="#cb158-623" aria-hidden="true" tabindex="-1"></a>                      <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-624"><a href="#cb158-624" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">out.width =</span> <span class="st">"100%"</span>)</span>
<span id="cb158-625"><a href="#cb158-625" aria-hidden="true" tabindex="-1"></a>pdf<span class="ot">=</span><span class="st">"TRUE"</span></span>
<span id="cb158-626"><a href="#cb158-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-627"><a href="#cb158-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-628"><a href="#cb158-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  message=FALSE,echo=FALSE}</span></span>
<span id="cb158-629"><a href="#cb158-629" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb158-630"><a href="#cb158-630" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb158-631"><a href="#cb158-631" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb158-632"><a href="#cb158-632" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb158-633"><a href="#cb158-633" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb158-634"><a href="#cb158-634" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb158-635"><a href="#cb158-635" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomcoloR)</span>
<span id="cb158-636"><a href="#cb158-636" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb158-637"><a href="#cb158-637" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb158-638"><a href="#cb158-638" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb158-639"><a href="#cb158-639" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb158-640"><a href="#cb158-640" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb158-641"><a href="#cb158-641" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-642"><a href="#cb158-642" aria-hidden="true" tabindex="-1"></a><span class="fu"># m-DAGs similarities and Metadata</span></span>
<span id="cb158-643"><a href="#cb158-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-644"><a href="#cb158-644" aria-hidden="true" tabindex="-1"></a>First, we will load the metadata and adjust them to match the structure of the similarities. This will facilitate the creation of graphs and statistics.</span>
<span id="cb158-645"><a href="#cb158-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-646"><a href="#cb158-646" aria-hidden="true" tabindex="-1"></a>Keep in mind the path of the experiment:</span>
<span id="cb158-647"><a href="#cb158-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-650"><a href="#cb158-650" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-651"><a href="#cb158-651" aria-hidden="true" tabindex="-1"></a>experiment<span class="ot">=</span></span>
<span id="cb158-652"><a href="#cb158-652" aria-hidden="true" tabindex="-1"></a>  <span class="st">"result_0a845f74-826e-3b46-aed9-e7ecf74db262/"</span></span>
<span id="cb158-653"><a href="#cb158-653" aria-hidden="true" tabindex="-1"></a>path_exp<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">"data/"</span>,experiment)</span>
<span id="cb158-654"><a href="#cb158-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-655"><a href="#cb158-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-656"><a href="#cb158-656" aria-hidden="true" tabindex="-1"></a><span class="fu">## MSA &amp; Munkres similarities</span></span>
<span id="cb158-657"><a href="#cb158-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-658"><a href="#cb158-658" aria-hidden="true" tabindex="-1"></a>In this section, we will present the similarities between m-DAGs considering the two similarity meausures described in the paper. Namely, the MSA and Munkres similarities.</span>
<span id="cb158-659"><a href="#cb158-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-660"><a href="#cb158-660" aria-hidden="true" tabindex="-1"></a>The experimental data set consists of <span class="in">`r nrow(meta_taxo)`</span> Eukaryotes from the animal, plant, fungus, and protists kingdoms.</span>
<span id="cb158-661"><a href="#cb158-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-662"><a href="#cb158-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb158-663"><a href="#cb158-663" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">table</span>(meta_taxo<span class="sc">$</span>Kingdom),<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Kingdom"</span>,<span class="st">"Abs. Freq."</span>))</span>
<span id="cb158-664"><a href="#cb158-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-665"><a href="#cb158-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-666"><a href="#cb158-666" aria-hidden="true" tabindex="-1"></a>The similarity values are provided in the following files:</span>
<span id="cb158-667"><a href="#cb158-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-670"><a href="#cb158-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-671"><a href="#cb158-671" aria-hidden="true" tabindex="-1"></a>list_Sim<span class="ot">=</span><span class="fu">dir</span>(path_exp,<span class="at">pattern=</span><span class="st">"^Similarities"</span>)</span>
<span id="cb158-672"><a href="#cb158-672" aria-hidden="true" tabindex="-1"></a>list_Sim</span>
<span id="cb158-673"><a href="#cb158-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-674"><a href="#cb158-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-675"><a href="#cb158-675" aria-hidden="true" tabindex="-1"></a>Load the m-DAGs similarities</span>
<span id="cb158-676"><a href="#cb158-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-679"><a href="#cb158-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-680"><a href="#cb158-680" aria-hidden="true" tabindex="-1"></a>Sim_MSA_mDAG<span class="ot">=</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(path_exp,</span>
<span id="cb158-681"><a href="#cb158-681" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Similarities_mDAG_MSAMethod.csv"</span>))</span>
<span id="cb158-682"><a href="#cb158-682" aria-hidden="true" tabindex="-1"></a>Sim_MSA_mDAG<span class="ot">=</span><span class="fu">as.matrix</span>(Sim_MSA_mDAG[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb158-683"><a href="#cb158-683" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Sim_MSA_mDAG)<span class="ot">=</span><span class="fu">colnames</span>(Sim_MSA_mDAG)</span>
<span id="cb158-684"><a href="#cb158-684" aria-hidden="true" tabindex="-1"></a>Sim_MSA_mDAG<span class="ot">=</span>Sim_MSA_mDAG[meta_taxo<span class="sc">$</span>mDAG_Id[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>],</span>
<span id="cb158-685"><a href="#cb158-685" aria-hidden="true" tabindex="-1"></a>                          meta_taxo<span class="sc">$</span>mDAG_Id[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>]]</span>
<span id="cb158-686"><a href="#cb158-686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-687"><a href="#cb158-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-690"><a href="#cb158-690" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-691"><a href="#cb158-691" aria-hidden="true" tabindex="-1"></a>Sim_Mun_mDAG<span class="ot">=</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(path_exp,<span class="st">"Similarities_mDAG_MunkresMethod.csv"</span>))</span>
<span id="cb158-692"><a href="#cb158-692" aria-hidden="true" tabindex="-1"></a>Sim_Mun_mDAG<span class="ot">=</span><span class="fu">as.matrix</span>(Sim_Mun_mDAG[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb158-693"><a href="#cb158-693" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Sim_Mun_mDAG)<span class="ot">=</span><span class="fu">colnames</span>(Sim_Mun_mDAG)</span>
<span id="cb158-694"><a href="#cb158-694" aria-hidden="true" tabindex="-1"></a>Sim_Mun_mDAG<span class="ot">=</span>Sim_Mun_mDAG[meta_taxo<span class="sc">$</span>mDAG_Id[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>],meta_taxo<span class="sc">$</span>mDAG_Id[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>]]</span>
<span id="cb158-695"><a href="#cb158-695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-696"><a href="#cb158-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-697"><a href="#cb158-697" aria-hidden="true" tabindex="-1"></a><span class="fu">## Heatmaps</span></span>
<span id="cb158-698"><a href="#cb158-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-699"><a href="#cb158-699" aria-hidden="true" tabindex="-1"></a>Here, we provide examples of heatmaps to visualize the similarities betweem m-DAGs. We again consider colors to represent the different Kingdoms.</span>
<span id="cb158-700"><a href="#cb158-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-701"><a href="#cb158-701" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.align='center', fig.height=5, cache=TRUE}</span></span>
<span id="cb158-702"><a href="#cb158-702" aria-hidden="true" tabindex="-1"></a>dff<span class="ot">&lt;-</span>meta_taxo[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>,] <span class="sc">%&gt;%</span> <span class="fu">select</span>(Kingdom)  <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb158-703"><a href="#cb158-703" aria-hidden="true" tabindex="-1"></a>colorsK <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Kingdom=</span> <span class="fu">c</span>(<span class="st">"Animals"</span><span class="ot">=</span><span class="st">"red"</span>,</span>
<span id="cb158-704"><a href="#cb158-704" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Plants"</span><span class="ot">=</span><span class="st">"green"</span>,</span>
<span id="cb158-705"><a href="#cb158-705" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Fungi"</span><span class="ot">=</span><span class="st">"yellow"</span>,</span>
<span id="cb158-706"><a href="#cb158-706" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"Protists"</span><span class="ot">=</span><span class="st">"black"</span>))</span>
<span id="cb158-707"><a href="#cb158-707" aria-hidden="true" tabindex="-1"></a>annotationK <span class="ot">&lt;-</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">df=</span>dff, <span class="at">col =</span> colorsK,<span class="at">show_legend =</span> <span class="cn">TRUE</span>)</span>
<span id="cb158-708"><a href="#cb158-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-709"><a href="#cb158-709" aria-hidden="true" tabindex="-1"></a>MSA_heat_1 <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(<span class="at">matrix =</span> Sim_MSA_mDAG, </span>
<span id="cb158-710"><a href="#cb158-710" aria-hidden="true" tabindex="-1"></a>                      <span class="at">column_title=</span></span>
<span id="cb158-711"><a href="#cb158-711" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"m-DAGs MSA-similarity Eukaryotes by Kingdoms"</span>,</span>
<span id="cb158-712"><a href="#cb158-712" aria-hidden="true" tabindex="-1"></a>                      <span class="at">heatmap_legend_param=</span><span class="fu">list</span>(</span>
<span id="cb158-713"><a href="#cb158-713" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title=</span><span class="st">"Similarity"</span>,</span>
<span id="cb158-714"><a href="#cb158-714" aria-hidden="true" tabindex="-1"></a>                        <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>)),</span>
<span id="cb158-715"><a href="#cb158-715" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col=</span><span class="fu">rev</span>(<span class="fu">viridis</span>(<span class="dv">256</span>)),</span>
<span id="cb158-716"><a href="#cb158-716" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-717"><a href="#cb158-717" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cluster_columns =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-718"><a href="#cb158-718" aria-hidden="true" tabindex="-1"></a>                      <span class="at">top_annotation =</span> annotationK,</span>
<span id="cb158-719"><a href="#cb158-719" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_column_names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb158-720"><a href="#cb158-720" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_row_names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-721"><a href="#cb158-721" aria-hidden="true" tabindex="-1"></a>                      <span class="at">left_annotation =</span></span>
<span id="cb158-722"><a href="#cb158-722" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">rowAnnotation</span>(<span class="at">df =</span> dff,</span>
<span id="cb158-723"><a href="#cb158-723" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">col =</span> colorsK,</span>
<span id="cb158-724"><a href="#cb158-724" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">show_annotation_name=</span><span class="cn">FALSE</span>,</span>
<span id="cb158-725"><a href="#cb158-725" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">show_legend=</span><span class="cn">FALSE</span></span>
<span id="cb158-726"><a href="#cb158-726" aria-hidden="true" tabindex="-1"></a>                                      ))</span>
<span id="cb158-727"><a href="#cb158-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-728"><a href="#cb158-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-729"><a href="#cb158-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-730"><a href="#cb158-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-731"><a href="#cb158-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-732"><a href="#cb158-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-733"><a href="#cb158-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-734"><a href="#cb158-734" aria-hidden="true" tabindex="-1"></a>Mun_heat_1<span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(<span class="at">matrix =</span> Sim_Mun_mDAG, </span>
<span id="cb158-735"><a href="#cb158-735" aria-hidden="true" tabindex="-1"></a>             <span class="at">column_title=</span><span class="st">"m-DAGs Munkres-similarity  Eukaryotes by Kingdoms"</span>,</span>
<span id="cb158-736"><a href="#cb158-736" aria-hidden="true" tabindex="-1"></a>            <span class="at">name =</span> <span class="st">"Munkres Similarity"</span>,</span>
<span id="cb158-737"><a href="#cb158-737" aria-hidden="true" tabindex="-1"></a>            <span class="at">heatmap_legend_param=</span><span class="fu">list</span>(</span>
<span id="cb158-738"><a href="#cb158-738" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title=</span><span class="st">"Similarity"</span>,</span>
<span id="cb158-739"><a href="#cb158-739" aria-hidden="true" tabindex="-1"></a>                        <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>)),</span>
<span id="cb158-740"><a href="#cb158-740" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col=</span><span class="fu">rev</span>(<span class="fu">viridis</span>(<span class="dv">256</span>)),</span>
<span id="cb158-741"><a href="#cb158-741" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-742"><a href="#cb158-742" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cluster_columns =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-743"><a href="#cb158-743" aria-hidden="true" tabindex="-1"></a>                      <span class="at">top_annotation =</span> annotationK,</span>
<span id="cb158-744"><a href="#cb158-744" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_column_names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb158-745"><a href="#cb158-745" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_row_names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-746"><a href="#cb158-746" aria-hidden="true" tabindex="-1"></a>                      <span class="at">left_annotation =</span></span>
<span id="cb158-747"><a href="#cb158-747" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">rowAnnotation</span>(<span class="at">df =</span> dff,</span>
<span id="cb158-748"><a href="#cb158-748" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">col =</span> colorsK,</span>
<span id="cb158-749"><a href="#cb158-749" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">show_annotation_name=</span><span class="cn">FALSE</span>,</span>
<span id="cb158-750"><a href="#cb158-750" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">show_legend=</span><span class="cn">FALSE</span></span>
<span id="cb158-751"><a href="#cb158-751" aria-hidden="true" tabindex="-1"></a>                                      ))</span>
<span id="cb158-752"><a href="#cb158-752" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-753"><a href="#cb158-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-754"><a href="#cb158-754" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.align='center', fig.height=5, cache=TRUE}</span></span>
<span id="cb158-755"><a href="#cb158-755" aria-hidden="true" tabindex="-1"></a>meta_animals<span class="ot">=</span> meta_taxo[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>,] <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Animals"</span>)</span>
<span id="cb158-756"><a href="#cb158-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-757"><a href="#cb158-757" aria-hidden="true" tabindex="-1"></a>dff<span class="ot">&lt;-</span>meta_taxo <span class="sc">%&gt;%</span></span>
<span id="cb158-758"><a href="#cb158-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Animals"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb158-759"><a href="#cb158-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Phylum,Freq_Phylum) <span class="sc">%&gt;%</span>   </span>
<span id="cb158-760"><a href="#cb158-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(Phylum)</span>
<span id="cb158-761"><a href="#cb158-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-762"><a href="#cb158-762" aria-hidden="true" tabindex="-1"></a>namesP<span class="ot">=</span>dff <span class="sc">%&gt;%</span> <span class="fu">distinct</span>( Phylum, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) </span>
<span id="cb158-763"><a href="#cb158-763" aria-hidden="true" tabindex="-1"></a>namesP<span class="ot">=</span>namesP<span class="sc">$</span>Phylum</span>
<span id="cb158-764"><a href="#cb158-764" aria-hidden="true" tabindex="-1"></a>dff<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">ordered</span>(dff<span class="sc">$</span>Phylum,<span class="at">labels=</span>namesP)</span>
<span id="cb158-765"><a href="#cb158-765" aria-hidden="true" tabindex="-1"></a>col<span class="ot">=</span><span class="fu">rainbow</span>(<span class="fu">length</span>(namesP))</span>
<span id="cb158-766"><a href="#cb158-766" aria-hidden="true" tabindex="-1"></a>colorsP<span class="ot">=</span><span class="fu">list</span>(<span class="at">Phylum=</span>col)</span>
<span id="cb158-767"><a href="#cb158-767" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(colorsP<span class="sc">$</span>Phylum)<span class="ot">=</span>namesP</span>
<span id="cb158-768"><a href="#cb158-768" aria-hidden="true" tabindex="-1"></a>annotation_H2 <span class="ot">&lt;-</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">df=</span>dff, <span class="at">col =</span> colorsP)</span>
<span id="cb158-769"><a href="#cb158-769" aria-hidden="true" tabindex="-1"></a>MSA_heat_2 <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(<span class="at">matrix =</span></span>
<span id="cb158-770"><a href="#cb158-770" aria-hidden="true" tabindex="-1"></a>                        Sim_MSA_mDAG[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dff),<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dff)],</span>
<span id="cb158-771"><a href="#cb158-771" aria-hidden="true" tabindex="-1"></a>                      <span class="at">column_title=</span><span class="st">"m-DAGs MSA-similarity  Animals by Phyla"</span>,</span>
<span id="cb158-772"><a href="#cb158-772" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col=</span><span class="fu">rev</span>(<span class="fu">viridis</span>(<span class="dv">256</span>)),</span>
<span id="cb158-773"><a href="#cb158-773" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-774"><a href="#cb158-774" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_heatmap_legend=</span><span class="cn">FALSE</span>, </span>
<span id="cb158-775"><a href="#cb158-775" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cluster_columns =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-776"><a href="#cb158-776" aria-hidden="true" tabindex="-1"></a>                      <span class="at">top_annotation =</span> annotation_H2,</span>
<span id="cb158-777"><a href="#cb158-777" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_column_names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb158-778"><a href="#cb158-778" aria-hidden="true" tabindex="-1"></a>                      <span class="at">show_row_names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-779"><a href="#cb158-779" aria-hidden="true" tabindex="-1"></a>                      <span class="at">left_annotation =</span> </span>
<span id="cb158-780"><a href="#cb158-780" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">rowAnnotation</span>(<span class="at">df =</span> dff,</span>
<span id="cb158-781"><a href="#cb158-781" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">col =</span> colorsP,</span>
<span id="cb158-782"><a href="#cb158-782" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">show_annotation_name=</span><span class="cn">FALSE</span>,</span>
<span id="cb158-783"><a href="#cb158-783" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">show_legend =</span><span class="cn">FALSE</span></span>
<span id="cb158-784"><a href="#cb158-784" aria-hidden="true" tabindex="-1"></a>                                      ))</span>
<span id="cb158-785"><a href="#cb158-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-786"><a href="#cb158-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-787"><a href="#cb158-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-788"><a href="#cb158-788" aria-hidden="true" tabindex="-1"></a>Mun_heat_2 <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(<span class="at">matrix =</span> Sim_Mun_mDAG[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dff),<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dff)], </span>
<span id="cb158-789"><a href="#cb158-789" aria-hidden="true" tabindex="-1"></a>              <span class="at">column_title=</span><span class="st">"m-DAGs Munkres-similarity  Animals by Phyla"</span>,</span>
<span id="cb158-790"><a href="#cb158-790" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">rev</span>(<span class="fu">viridis</span>(<span class="dv">256</span>)),</span>
<span id="cb158-791"><a href="#cb158-791" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_heatmap_legend=</span><span class="cn">FALSE</span>, </span>
<span id="cb158-792"><a href="#cb158-792" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-793"><a href="#cb158-793" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster_columns =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-794"><a href="#cb158-794" aria-hidden="true" tabindex="-1"></a>        <span class="at">top_annotation =</span> annotation_H2,</span>
<span id="cb158-795"><a href="#cb158-795" aria-hidden="true" tabindex="-1"></a>        <span class="at">show_column_names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb158-796"><a href="#cb158-796" aria-hidden="true" tabindex="-1"></a>        <span class="at">show_row_names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-797"><a href="#cb158-797" aria-hidden="true" tabindex="-1"></a>        <span class="at">left_annotation =</span> <span class="fu">rowAnnotation</span>(<span class="at">df =</span> dff,</span>
<span id="cb158-798"><a href="#cb158-798" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">col =</span> colorsP,</span>
<span id="cb158-799"><a href="#cb158-799" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">show_annotation_name=</span><span class="cn">FALSE</span>,</span>
<span id="cb158-800"><a href="#cb158-800" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">show_legend =</span><span class="cn">FALSE</span></span>
<span id="cb158-801"><a href="#cb158-801" aria-hidden="true" tabindex="-1"></a>                                        ))</span>
<span id="cb158-802"><a href="#cb158-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-803"><a href="#cb158-803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-804"><a href="#cb158-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-805"><a href="#cb158-805" aria-hidden="true" tabindex="-1"></a><span class="in">```{r heatmaps}</span></span>
<span id="cb158-806"><a href="#cb158-806" aria-hidden="true" tabindex="-1"></a>MSA_heat_1</span>
<span id="cb158-807"><a href="#cb158-807" aria-hidden="true" tabindex="-1"></a>MSA_heat_2</span>
<span id="cb158-808"><a href="#cb158-808" aria-hidden="true" tabindex="-1"></a>Mun_heat_1</span>
<span id="cb158-809"><a href="#cb158-809" aria-hidden="true" tabindex="-1"></a>Mun_heat_2</span>
<span id="cb158-810"><a href="#cb158-810" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-811"><a href="#cb158-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-812"><a href="#cb158-812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, include=FALSE}</span></span>
<span id="cb158-813"><a href="#cb158-813" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">"MSA_kingdoms.pdf"</span>)</span>
<span id="cb158-814"><a href="#cb158-814" aria-hidden="true" tabindex="-1"></a>MSA_heat_1</span>
<span id="cb158-815"><a href="#cb158-815" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb158-816"><a href="#cb158-816" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">"MSA_phyla.pdf"</span>)</span>
<span id="cb158-817"><a href="#cb158-817" aria-hidden="true" tabindex="-1"></a>MSA_heat_2</span>
<span id="cb158-818"><a href="#cb158-818" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb158-819"><a href="#cb158-819" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">"Mun_kingdoms.pdf"</span>)</span>
<span id="cb158-820"><a href="#cb158-820" aria-hidden="true" tabindex="-1"></a>Mun_heat_1</span>
<span id="cb158-821"><a href="#cb158-821" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb158-822"><a href="#cb158-822" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">"Mun_phyla.pdf"</span>)</span>
<span id="cb158-823"><a href="#cb158-823" aria-hidden="true" tabindex="-1"></a>Mun_heat_2</span>
<span id="cb158-824"><a href="#cb158-824" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb158-825"><a href="#cb158-825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-826"><a href="#cb158-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-827"><a href="#cb158-827" aria-hidden="true" tabindex="-1"></a><span class="fu">## MDS (Multidimensional Scaling) MSA &amp; Munkres similarity</span></span>
<span id="cb158-828"><a href="#cb158-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-829"><a href="#cb158-829" aria-hidden="true" tabindex="-1"></a>Multi-dimensional Scaling (MDS) is a classic multivariate data analysis technique that allows for obtaining a low-dimensional representation of the observed similarities. First, we transform each similarity measure into a distance measure as follows: let $s_{ij}$ be a similarity measure between a pair $i,j$, we define its distance measure as  $d_{ij}=\sqrt{1-s_{ij}^2}$.</span>
<span id="cb158-830"><a href="#cb158-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-831"><a href="#cb158-831" aria-hidden="true" tabindex="-1"></a>The following is the MDS for the MSA similarity:</span>
<span id="cb158-832"><a href="#cb158-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-833"><a href="#cb158-833" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.align='center', fig.height=5, cache=TRUE}</span></span>
<span id="cb158-834"><a href="#cb158-834" aria-hidden="true" tabindex="-1"></a><span class="do">## Metric multidimensional scaling (mMDS)</span></span>
<span id="cb158-835"><a href="#cb158-835" aria-hidden="true" tabindex="-1"></a>mds7 <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>Sim_MSA_mDAG<span class="sc">^</span><span class="dv">2</span>),<span class="at">k=</span><span class="dv">7</span>,<span class="at">eig=</span><span class="cn">TRUE</span>)</span>
<span id="cb158-836"><a href="#cb158-836" aria-hidden="true" tabindex="-1"></a>mds7<span class="sc">$</span>GOF</span>
<span id="cb158-837"><a href="#cb158-837" aria-hidden="true" tabindex="-1"></a>mds <span class="ot">&lt;-</span> mds7<span class="sc">$</span>points <span class="sc">%&gt;%</span>  <span class="fu">as_tibble</span>()</span>
<span id="cb158-838"><a href="#cb158-838" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mds) <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">"Dim."</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(mds7<span class="sc">$</span>points)[<span class="dv">2</span>])</span>
<span id="cb158-839"><a href="#cb158-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-840"><a href="#cb158-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-841"><a href="#cb158-841" aria-hidden="true" tabindex="-1"></a>cooordinates<span class="ot">=</span><span class="fu">as_tibble</span>(mds7<span class="sc">$</span>points)</span>
<span id="cb158-842"><a href="#cb158-842" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cooordinates)<span class="ot">=</span><span class="fu">paste</span>(<span class="st">"Component"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb158-843"><a href="#cb158-843" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(cooordinates,<span class="at">columns=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb158-844"><a href="#cb158-844" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color=</span>meta_taxo<span class="sc">$</span>Kingdom[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>],</span>
<span id="cb158-845"><a href="#cb158-845" aria-hidden="true" tabindex="-1"></a>            <span class="at">title=</span><span class="st">"MDS 4 dimensions projection"</span>,<span class="at">legend=</span><span class="dv">1</span>),</span>
<span id="cb158-846"><a href="#cb158-846" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower=</span><span class="fu">list</span>(<span class="at">continuous=</span><span class="st">"points"</span>)) <span class="sc">+</span> </span>
<span id="cb158-847"><a href="#cb158-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colorsK<span class="sc">$</span>Kingdom) <span class="sc">+</span> </span>
<span id="cb158-848"><a href="#cb158-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"left"</span>)</span>
<span id="cb158-849"><a href="#cb158-849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-850"><a href="#cb158-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-851"><a href="#cb158-851" aria-hidden="true" tabindex="-1"></a>The following is the MDS for the Munkres similarity:</span>
<span id="cb158-852"><a href="#cb158-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-853"><a href="#cb158-853" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.align='center', fig.height=5}</span></span>
<span id="cb158-854"><a href="#cb158-854" aria-hidden="true" tabindex="-1"></a><span class="do">## Metric multidimensional scaling</span></span>
<span id="cb158-855"><a href="#cb158-855" aria-hidden="true" tabindex="-1"></a>mds7 <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>Sim_Mun_mDAG<span class="sc">^</span><span class="dv">2</span>),<span class="at">k=</span><span class="dv">7</span>,<span class="at">eig=</span><span class="cn">TRUE</span>)</span>
<span id="cb158-856"><a href="#cb158-856" aria-hidden="true" tabindex="-1"></a>mds7<span class="sc">$</span>GOF</span>
<span id="cb158-857"><a href="#cb158-857" aria-hidden="true" tabindex="-1"></a>mds <span class="ot">&lt;-</span> mds7<span class="sc">$</span>points <span class="sc">%&gt;%</span>  <span class="fu">as_tibble</span>()</span>
<span id="cb158-858"><a href="#cb158-858" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mds) <span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">"Dim."</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(mds7<span class="sc">$</span>points)[<span class="dv">2</span>])</span>
<span id="cb158-859"><a href="#cb158-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-860"><a href="#cb158-860" aria-hidden="true" tabindex="-1"></a>cooordinates<span class="ot">=</span><span class="fu">as_tibble</span>(mds7<span class="sc">$</span>points)</span>
<span id="cb158-861"><a href="#cb158-861" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cooordinates)<span class="ot">=</span><span class="fu">paste</span>(<span class="st">"Component"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb158-862"><a href="#cb158-862" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(cooordinates,<span class="at">columns=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb158-863"><a href="#cb158-863" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color=</span>meta_taxo<span class="sc">$</span>Kingdom[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>],</span>
<span id="cb158-864"><a href="#cb158-864" aria-hidden="true" tabindex="-1"></a>            <span class="at">title=</span><span class="st">"MDS 4 dimensions projection"</span>,<span class="at">legend=</span><span class="dv">1</span>),</span>
<span id="cb158-865"><a href="#cb158-865" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower=</span><span class="fu">list</span>(<span class="at">continuous=</span><span class="st">"points"</span>)) <span class="sc">+</span> </span>
<span id="cb158-866"><a href="#cb158-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colorsK<span class="sc">$</span>Kingdom) <span class="sc">+</span> </span>
<span id="cb158-867"><a href="#cb158-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"left"</span>)</span>
<span id="cb158-868"><a href="#cb158-868" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-869"><a href="#cb158-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-870"><a href="#cb158-870" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hierarchical clustering MSA similarity</span></span>
<span id="cb158-871"><a href="#cb158-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-872"><a href="#cb158-872" aria-hidden="true" tabindex="-1"></a>Through hierarchical clustering using the Ward method, we have derived a partition of the m-DAGs into 4, 5, and 6 clusters, respectively. The corresponding information has been organized into a table, as follows:</span>
<span id="cb158-873"><a href="#cb158-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-876"><a href="#cb158-876" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-877"><a href="#cb158-877" aria-hidden="true" tabindex="-1"></a>D<span class="ot">=</span><span class="fu">as.dist</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>Sim_MSA_mDAG<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb158-878"><a href="#cb158-878" aria-hidden="true" tabindex="-1"></a>hc_MSA<span class="ot">=</span><span class="fu">hclust</span>(<span class="fu">as.dist</span>(D),<span class="at">method =</span><span class="st">"ward.D"</span>)</span>
<span id="cb158-879"><a href="#cb158-879" aria-hidden="true" tabindex="-1"></a>clust4_MSA<span class="ot">=</span><span class="fu">cutree</span>(hc_MSA,<span class="dv">4</span>)</span>
<span id="cb158-880"><a href="#cb158-880" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clust4_MSA,meta_taxo<span class="sc">$</span>Kingdom[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>])</span>
<span id="cb158-881"><a href="#cb158-881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-882"><a href="#cb158-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-885"><a href="#cb158-885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-886"><a href="#cb158-886" aria-hidden="true" tabindex="-1"></a>clust5_MSA<span class="ot">=</span><span class="fu">cutree</span>(hc_MSA,<span class="dv">5</span>)</span>
<span id="cb158-887"><a href="#cb158-887" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clust5_MSA,meta_taxo<span class="sc">$</span>Kingdom[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>])</span>
<span id="cb158-888"><a href="#cb158-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-889"><a href="#cb158-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-892"><a href="#cb158-892" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-893"><a href="#cb158-893" aria-hidden="true" tabindex="-1"></a>clust6_MSA<span class="ot">=</span><span class="fu">cutree</span>(hc_MSA,<span class="dv">6</span>)</span>
<span id="cb158-894"><a href="#cb158-894" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clust6_MSA,meta_taxo<span class="sc">$</span>Kingdom[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>])</span>
<span id="cb158-895"><a href="#cb158-895" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-896"><a href="#cb158-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-897"><a href="#cb158-897" aria-hidden="true" tabindex="-1"></a>We can also create a table that correlates the clusters (in this case, two clusters) with the Phylum classification:</span>
<span id="cb158-898"><a href="#cb158-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-901"><a href="#cb158-901" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-902"><a href="#cb158-902" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span>meta_taxo[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb158-903"><a href="#cb158-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Organism,Kingdom,Phylum,Class,Full_Name)</span>
<span id="cb158-904"><a href="#cb158-904" aria-hidden="true" tabindex="-1"></a>aux<span class="sc">$</span>clust4_MSA<span class="ot">=</span>clust4_MSA</span>
<span id="cb158-905"><a href="#cb158-905" aria-hidden="true" tabindex="-1"></a>aux_Animals_cluster_1_2 <span class="ot">=</span> aux <span class="sc">%&gt;%</span></span>
<span id="cb158-906"><a href="#cb158-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Animals"</span>,clust4_MSA <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb158-907"><a href="#cb158-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-908"><a href="#cb158-908" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(aux_Animals_cluster_1_2<span class="sc">$</span>Phylum,aux_Animals_cluster_1_2<span class="sc">$</span>clust4_MSA)</span>
<span id="cb158-909"><a href="#cb158-909" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-910"><a href="#cb158-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-911"><a href="#cb158-911" aria-hidden="true" tabindex="-1"></a>We can retrieve the information of the elements belonging to a specific classification (Animals and Plants) that are part of a particular cluster as follows:</span>
<span id="cb158-912"><a href="#cb158-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-915"><a href="#cb158-915" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-916"><a href="#cb158-916" aria-hidden="true" tabindex="-1"></a>aux_7_Animals_cluster_3<span class="ot">=</span> <span class="fu">filter</span>(aux,</span>
<span id="cb158-917"><a href="#cb158-917" aria-hidden="true" tabindex="-1"></a>                                clust4_MSA<span class="sc">==</span><span class="dv">3</span>,</span>
<span id="cb158-918"><a href="#cb158-918" aria-hidden="true" tabindex="-1"></a>                                Kingdom<span class="sc">==</span><span class="st">"Animals"</span>)</span>
<span id="cb158-919"><a href="#cb158-919" aria-hidden="true" tabindex="-1"></a>aux_7_Animals_cluster_3</span>
<span id="cb158-920"><a href="#cb158-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-921"><a href="#cb158-921" aria-hidden="true" tabindex="-1"></a>aux_14_Plants_clust2<span class="ot">=</span> <span class="fu">filter</span>(aux,clust4_MSA<span class="sc">==</span><span class="dv">3</span>,</span>
<span id="cb158-922"><a href="#cb158-922" aria-hidden="true" tabindex="-1"></a>                             Kingdom<span class="sc">==</span><span class="st">"Plants"</span>)</span>
<span id="cb158-923"><a href="#cb158-923" aria-hidden="true" tabindex="-1"></a>aux_14_Plants_clust2</span>
<span id="cb158-924"><a href="#cb158-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-925"><a href="#cb158-925" aria-hidden="true" tabindex="-1"></a>aux_all_algae_class<span class="ot">=</span> aux <span class="sc">%&gt;%</span> </span>
<span id="cb158-926"><a href="#cb158-926" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Plants"</span>,</span>
<span id="cb158-927"><a href="#cb158-927" aria-hidden="true" tabindex="-1"></a>         Class <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"algae"</span>))</span>
<span id="cb158-928"><a href="#cb158-928" aria-hidden="true" tabindex="-1"></a>aux_all_algae_class</span>
<span id="cb158-929"><a href="#cb158-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-930"><a href="#cb158-930" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-931"><a href="#cb158-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-932"><a href="#cb158-932" aria-hidden="true" tabindex="-1"></a>We can retrieve the information of the elements from a specific Phylum or Class, and the cluster they belong to, as follows:</span>
<span id="cb158-933"><a href="#cb158-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-936"><a href="#cb158-936" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-937"><a href="#cb158-937" aria-hidden="true" tabindex="-1"></a>aux_all_Nematodes_Flatworns<span class="ot">=</span> aux <span class="sc">%&gt;%</span> </span>
<span id="cb158-938"><a href="#cb158-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Animals"</span>,</span>
<span id="cb158-939"><a href="#cb158-939" aria-hidden="true" tabindex="-1"></a>         Phylum <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nematodes"</span>,<span class="st">"Flatworms"</span>))</span>
<span id="cb158-940"><a href="#cb158-940" aria-hidden="true" tabindex="-1"></a>aux_all_Nematodes_Flatworns</span>
<span id="cb158-941"><a href="#cb158-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-942"><a href="#cb158-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-943"><a href="#cb158-943" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hierarchical clustering Munkres similarity</span></span>
<span id="cb158-944"><a href="#cb158-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-945"><a href="#cb158-945" aria-hidden="true" tabindex="-1"></a>We obtain a classification of the m-DAGs into different clusters and retrieve the cluster's information as follows:</span>
<span id="cb158-946"><a href="#cb158-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-949"><a href="#cb158-949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-950"><a href="#cb158-950" aria-hidden="true" tabindex="-1"></a>D<span class="ot">=</span><span class="fu">as.dist</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>Sim_Mun_mDAG<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb158-951"><a href="#cb158-951" aria-hidden="true" tabindex="-1"></a>hc_Mun<span class="ot">=</span><span class="fu">hclust</span>(<span class="fu">as.dist</span>(D),<span class="at">method =</span><span class="st">"ward.D"</span>)</span>
<span id="cb158-952"><a href="#cb158-952" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-953"><a href="#cb158-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-956"><a href="#cb158-956" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-957"><a href="#cb158-957" aria-hidden="true" tabindex="-1"></a>clust4_Mun<span class="ot">=</span><span class="fu">cutree</span>(hc_Mun,<span class="dv">4</span>)</span>
<span id="cb158-958"><a href="#cb158-958" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clust4_Mun,meta_taxo<span class="sc">$</span>Kingdom[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>])</span>
<span id="cb158-959"><a href="#cb158-959" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-960"><a href="#cb158-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-963"><a href="#cb158-963" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-964"><a href="#cb158-964" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span>meta_taxo[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb158-965"><a href="#cb158-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Organism,Kingdom,Phylum,Class,Full_Name)</span>
<span id="cb158-966"><a href="#cb158-966" aria-hidden="true" tabindex="-1"></a>aux<span class="sc">$</span>clust4_Mun<span class="ot">=</span>clust4_Mun</span>
<span id="cb158-967"><a href="#cb158-967" aria-hidden="true" tabindex="-1"></a>aux_Animals_cluster_1_2_Mun <span class="ot">=</span> aux <span class="sc">%&gt;%</span></span>
<span id="cb158-968"><a href="#cb158-968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Animals"</span>,clust4_Mun <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb158-969"><a href="#cb158-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-970"><a href="#cb158-970" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(aux_Animals_cluster_1_2_Mun<span class="sc">$</span>Phylum,</span>
<span id="cb158-971"><a href="#cb158-971" aria-hidden="true" tabindex="-1"></a>      aux_Animals_cluster_1_2_Mun<span class="sc">$</span>clust4_Mun)</span>
<span id="cb158-972"><a href="#cb158-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-973"><a href="#cb158-973" aria-hidden="true" tabindex="-1"></a>aux_7_Animals_cluster_3_Mun<span class="ot">=</span> <span class="fu">filter</span>(aux,</span>
<span id="cb158-974"><a href="#cb158-974" aria-hidden="true" tabindex="-1"></a>                                clust4_Mun<span class="sc">==</span><span class="dv">3</span>,</span>
<span id="cb158-975"><a href="#cb158-975" aria-hidden="true" tabindex="-1"></a>                                Kingdom<span class="sc">==</span><span class="st">"Animals"</span>)</span>
<span id="cb158-976"><a href="#cb158-976" aria-hidden="true" tabindex="-1"></a>aux_7_Animals_cluster_3_Mun</span>
<span id="cb158-977"><a href="#cb158-977" aria-hidden="true" tabindex="-1"></a>aux_all_Nematodes_Flatworns<span class="ot">=</span> aux <span class="sc">%&gt;%</span> </span>
<span id="cb158-978"><a href="#cb158-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Animals"</span>,</span>
<span id="cb158-979"><a href="#cb158-979" aria-hidden="true" tabindex="-1"></a>         Phylum <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Nematodes"</span>,<span class="st">"Flatworms"</span>))</span>
<span id="cb158-980"><a href="#cb158-980" aria-hidden="true" tabindex="-1"></a>aux_all_Nematodes_Flatworns</span>
<span id="cb158-981"><a href="#cb158-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-982"><a href="#cb158-982" aria-hidden="true" tabindex="-1"></a>aux_14_Plants_clust2_Mun<span class="ot">=</span> <span class="fu">filter</span>(aux,clust4_Mun<span class="sc">==</span><span class="dv">3</span>,</span>
<span id="cb158-983"><a href="#cb158-983" aria-hidden="true" tabindex="-1"></a>                             Kingdom<span class="sc">==</span><span class="st">"Plants"</span>)</span>
<span id="cb158-984"><a href="#cb158-984" aria-hidden="true" tabindex="-1"></a>aux_14_Plants_clust2_Mun</span>
<span id="cb158-985"><a href="#cb158-985" aria-hidden="true" tabindex="-1"></a>aux_all_algae_class<span class="ot">=</span> aux <span class="sc">%&gt;%</span> </span>
<span id="cb158-986"><a href="#cb158-986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Plants"</span>,</span>
<span id="cb158-987"><a href="#cb158-987" aria-hidden="true" tabindex="-1"></a>         Class <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"algae"</span>))</span>
<span id="cb158-988"><a href="#cb158-988" aria-hidden="true" tabindex="-1"></a>aux_all_algae_class</span>
<span id="cb158-989"><a href="#cb158-989" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-990"><a href="#cb158-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-991"><a href="#cb158-991" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison between MSA and Munkres similarities</span></span>
<span id="cb158-992"><a href="#cb158-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-993"><a href="#cb158-993" aria-hidden="true" tabindex="-1"></a>In order to compare the two similarities we consider the Spearman and Pearson correlation. First, we load the similarities for every pair of m-DAG and each similarity measure.</span>
<span id="cb158-994"><a href="#cb158-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-997"><a href="#cb158-997" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-998"><a href="#cb158-998" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(meta_taxo<span class="sc">$</span>mDAG_Id[<span class="dv">1</span><span class="sc">:</span><span class="dv">884</span>])</span>
<span id="cb158-999"><a href="#cb158-999" aria-hidden="true" tabindex="-1"></a>n</span>
<span id="cb158-1000"><a href="#cb158-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Sim_MSA_mDAG)</span>
<span id="cb158-1001"><a href="#cb158-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1002"><a href="#cb158-1002" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">as_tibble</span>(Sim_MSA_mDAG)</span>
<span id="cb158-1003"><a href="#cb158-1003" aria-hidden="true" tabindex="-1"></a>aux<span class="sc">$</span>mDag<span class="ot">=</span><span class="fu">names</span>(aux)</span>
<span id="cb158-1004"><a href="#cb158-1004" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span>aux <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="st">`</span><span class="at">0313</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">0300</span><span class="st">`</span>,</span>
<span id="cb158-1005"><a href="#cb158-1005" aria-hidden="true" tabindex="-1"></a>                         <span class="at">names_to=</span><span class="st">"mDag_2"</span>,</span>
<span id="cb158-1006"><a href="#cb158-1006" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values_to=</span><span class="st">"Sim_MSA"</span>)</span>
<span id="cb158-1007"><a href="#cb158-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1008"><a href="#cb158-1008" aria-hidden="true" tabindex="-1"></a>aux_2<span class="ot">=</span> aux <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">i=</span><span class="fu">pmax</span>(<span class="fu">as.integer</span>(mDag),</span>
<span id="cb158-1009"><a href="#cb158-1009" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">as.integer</span>(mDag_2)),</span>
<span id="cb158-1010"><a href="#cb158-1010" aria-hidden="true" tabindex="-1"></a>                       <span class="at">j=</span><span class="fu">pmin</span>(<span class="fu">as.integer</span>(mDag),</span>
<span id="cb158-1011"><a href="#cb158-1011" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">as.integer</span>(mDag_2))) <span class="sc">%&gt;%</span> <span class="fu">unite</span>(<span class="st">"ij"</span>,i<span class="sc">:</span>j) <span class="sc">%&gt;%</span></span>
<span id="cb158-1012"><a href="#cb158-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">duplicated</span>(ij))</span>
<span id="cb158-1013"><a href="#cb158-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1014"><a href="#cb158-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1015"><a href="#cb158-1015" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">as_tibble</span>(Sim_Mun_mDAG)</span>
<span id="cb158-1016"><a href="#cb158-1016" aria-hidden="true" tabindex="-1"></a>aux<span class="sc">$</span>mDag<span class="ot">=</span><span class="fu">names</span>(aux)</span>
<span id="cb158-1017"><a href="#cb158-1017" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span>aux <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="st">`</span><span class="at">0313</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">0300</span><span class="st">`</span>,</span>
<span id="cb158-1018"><a href="#cb158-1018" aria-hidden="true" tabindex="-1"></a>                         <span class="at">names_to=</span><span class="st">"mDag_2"</span>,</span>
<span id="cb158-1019"><a href="#cb158-1019" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values_to=</span><span class="st">"Sim_Mun"</span>)</span>
<span id="cb158-1020"><a href="#cb158-1020" aria-hidden="true" tabindex="-1"></a>aux_2 <span class="ot">=</span> aux_2 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(aux)</span>
<span id="cb158-1021"><a href="#cb158-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1022"><a href="#cb158-1022" aria-hidden="true" tabindex="-1"></a>Sim_comp<span class="ot">=</span>aux_2</span>
<span id="cb158-1023"><a href="#cb158-1023" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(aux,aux_2)</span>
<span id="cb158-1024"><a href="#cb158-1024" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1025"><a href="#cb158-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1026"><a href="#cb158-1026" aria-hidden="true" tabindex="-1"></a>Next we obtain the Spearman and Pearson correlations as follows:</span>
<span id="cb158-1027"><a href="#cb158-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1030"><a href="#cb158-1030" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1031"><a href="#cb158-1031" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Sim_comp[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)],<span class="at">method=</span><span class="st">"spearman"</span>)</span>
<span id="cb158-1032"><a href="#cb158-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Sim_comp[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)],<span class="at">method=</span><span class="st">"pearson"</span>)</span>
<span id="cb158-1033"><a href="#cb158-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1034"><a href="#cb158-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1037"><a href="#cb158-1037" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1038"><a href="#cb158-1038" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(Sim_comp[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)])</span>
<span id="cb158-1039"><a href="#cb158-1039" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1040"><a href="#cb158-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1043"><a href="#cb158-1043" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1044"><a href="#cb158-1044" aria-hidden="true" tabindex="-1"></a>sim_pairs<span class="ot">=</span> Sim_comp<span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(</span>
<span id="cb158-1045"><a href="#cb158-1045" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols=</span><span class="fu">c</span>(Sim_MSA,Sim_Mun),</span>
<span id="cb158-1046"><a href="#cb158-1046" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to=</span><span class="st">"Method"</span>,</span>
<span id="cb158-1047"><a href="#cb158-1047" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to=</span><span class="st">"Similarity"</span>)</span>
<span id="cb158-1048"><a href="#cb158-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1049"><a href="#cb158-1049" aria-hidden="true" tabindex="-1"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggbetweenstats</span>(</span>
<span id="cb158-1050"><a href="#cb158-1050" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sim_pairs,</span>
<span id="cb158-1051"><a href="#cb158-1051" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Method,</span>
<span id="cb158-1052"><a href="#cb158-1052" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> Similarity,</span>
<span id="cb158-1053"><a href="#cb158-1053" aria-hidden="true" tabindex="-1"></a>  <span class="at">centrality.plotting=</span><span class="cn">TRUE</span>)</span>
<span id="cb158-1054"><a href="#cb158-1054" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1055"><a href="#cb158-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1058"><a href="#cb158-1058" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1059"><a href="#cb158-1059" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb158-1060"><a href="#cb158-1060" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb158-1061"><a href="#cb158-1061" aria-hidden="true" tabindex="-1"></a>sim_pairs <span class="sc">%&gt;%</span></span>
<span id="cb158-1062"><a href="#cb158-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>Method, <span class="at">y=</span>Similarity, <span class="at">fill=</span>Method)) <span class="sc">+</span></span>
<span id="cb158-1063"><a href="#cb158-1063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb158-1064"><a href="#cb158-1064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb158-1065"><a href="#cb158-1065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb158-1066"><a href="#cb158-1066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Boxplot diagram of the similarities between the two aproaches"</span>) </span>
<span id="cb158-1067"><a href="#cb158-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1068"><a href="#cb158-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  include=FALSE,message=FALSE}</span></span>
<span id="cb158-1069"><a href="#cb158-1069" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>,</span>
<span id="cb158-1070"><a href="#cb158-1070" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cache=</span><span class="cn">FALSE</span>,</span>
<span id="cb158-1071"><a href="#cb158-1071" aria-hidden="true" tabindex="-1"></a>                      <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb158-1072"><a href="#cb158-1072" aria-hidden="true" tabindex="-1"></a>                      <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">out.width =</span> <span class="st">"100%"</span>)</span>
<span id="cb158-1073"><a href="#cb158-1073" aria-hidden="true" tabindex="-1"></a>pdf<span class="ot">=</span><span class="st">"TRUE"</span></span>
<span id="cb158-1074"><a href="#cb158-1074" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1075"><a href="#cb158-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1076"><a href="#cb158-1076" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  message=FALSE,echo=FALSE}</span></span>
<span id="cb158-1077"><a href="#cb158-1077" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb158-1078"><a href="#cb158-1078" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb158-1079"><a href="#cb158-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb158-1080"><a href="#cb158-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb158-1081"><a href="#cb158-1081" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb158-1082"><a href="#cb158-1082" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb158-1083"><a href="#cb158-1083" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomcoloR)</span>
<span id="cb158-1084"><a href="#cb158-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb158-1085"><a href="#cb158-1085" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb158-1086"><a href="#cb158-1086" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb158-1087"><a href="#cb158-1087" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb158-1088"><a href="#cb158-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb158-1089"><a href="#cb158-1089" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1090"><a href="#cb158-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1091"><a href="#cb158-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1092"><a href="#cb158-1092" aria-hidden="true" tabindex="-1"></a><span class="fu"># Clusters analysis</span></span>
<span id="cb158-1093"><a href="#cb158-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1094"><a href="#cb158-1094" aria-hidden="true" tabindex="-1"></a>In the Eukaryotes test, we aimed to analyze which factors caused some algae and plants to be distinguished from their respective kingdoms. To address this question, we revisited the core metabolism obtained with MetaDAG, focusing on each cluster.</span>
<span id="cb158-1095"><a href="#cb158-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1098"><a href="#cb158-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1099"><a href="#cb158-1099" aria-hidden="true" tabindex="-1"></a>reactions<span class="ot">=</span><span class="fu">names</span>(Results)</span>
<span id="cb158-1100"><a href="#cb158-1100" aria-hidden="true" tabindex="-1"></a>reactions<span class="ot">=</span>reactions[<span class="fu">grep</span>(<span class="st">"(^R</span><span class="sc">\\</span><span class="st">d{5})"</span>,reactions)]</span>
<span id="cb158-1101"><a href="#cb158-1101" aria-hidden="true" tabindex="-1"></a>reactions<span class="ot">=</span><span class="fu">tibble</span>(reactions)</span>
<span id="cb158-1102"><a href="#cb158-1102" aria-hidden="true" tabindex="-1"></a>reactions<span class="ot">=</span>reactions <span class="sc">%&gt;%</span> <span class="fu">separate</span>(reactions, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"r_id"</span>,<span class="st">"enzyme"</span>),<span class="at">sep=</span><span class="st">"</span><span class="sc">\\</span><span class="st">("</span>,<span class="at">remove=</span><span class="cn">FALSE</span>)</span>
<span id="cb158-1103"><a href="#cb158-1103" aria-hidden="true" tabindex="-1"></a>reactions<span class="ot">=</span>reactions <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">enzyme=</span><span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(|</span><span class="sc">\\</span><span class="st">)"</span>,<span class="st">""</span>,enzyme))</span>
<span id="cb158-1104"><a href="#cb158-1104" aria-hidden="true" tabindex="-1"></a><span class="co">#reactions=reactions[,-3]</span></span>
<span id="cb158-1105"><a href="#cb158-1105" aria-hidden="true" tabindex="-1"></a>reactions<span class="sc">$</span>rev<span class="ot">=</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(reactions<span class="sc">$</span>r_id,<span class="st">"v"</span>)</span>
<span id="cb158-1106"><a href="#cb158-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1107"><a href="#cb158-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1108"><a href="#cb158-1108" aria-hidden="true" tabindex="-1"></a>The results of the clusters are compared to the classification of Kingdoms for both similarity measures:</span>
<span id="cb158-1109"><a href="#cb158-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1112"><a href="#cb158-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1113"><a href="#cb158-1113" aria-hidden="true" tabindex="-1"></a>clust4_MSA2<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">mDAG_Id=</span><span class="fu">names</span>(clust4_MSA), <span class="at">clust4_MSA=</span>clust4_MSA)</span>
<span id="cb158-1114"><a href="#cb158-1114" aria-hidden="true" tabindex="-1"></a>clust4_Mun2<span class="ot">=</span><span class="fu">tibble</span>(<span class="at">mDAG_Id=</span><span class="fu">names</span>(clust4_Mun), <span class="at">clust4_Mun=</span>clust4_Mun)</span>
<span id="cb158-1115"><a href="#cb158-1115" aria-hidden="true" tabindex="-1"></a>meta_taxo2<span class="ot">=</span>meta_taxo</span>
<span id="cb158-1116"><a href="#cb158-1116" aria-hidden="true" tabindex="-1"></a>meta_taxo2<span class="ot">=</span>meta_taxo2 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(clust4_MSA2,<span class="at">by=</span> <span class="st">"mDAG_Id"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb158-1117"><a href="#cb158-1117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(clust4_Mun2,<span class="at">by=</span> <span class="st">"mDAG_Id"</span>)</span>
<span id="cb158-1118"><a href="#cb158-1118" aria-hidden="true" tabindex="-1"></a>meta_taxo2<span class="sc">$</span>combined_cluster_MSA_Kingdom<span class="ot">=</span><span class="fu">paste0</span>(meta_taxo2<span class="sc">$</span>Kingdom,meta_taxo2<span class="sc">$</span>clust4_MSA)</span>
<span id="cb158-1119"><a href="#cb158-1119" aria-hidden="true" tabindex="-1"></a>meta_taxo2<span class="sc">$</span>combined_cluster_Mun_Kingdom<span class="ot">=</span><span class="fu">paste0</span>(meta_taxo2<span class="sc">$</span>Kingdom,meta_taxo2<span class="sc">$</span>clust4_MSA)</span>
<span id="cb158-1120"><a href="#cb158-1120" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(meta_taxo2,<span class="at">file=</span><span class="st">"meta_taxo_4_clusters.csv"</span>)</span>
<span id="cb158-1121"><a href="#cb158-1121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1122"><a href="#cb158-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1125"><a href="#cb158-1125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1126"><a href="#cb158-1126" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">table</span>(meta_taxo2<span class="sc">$</span>Kingdom,meta_taxo2<span class="sc">$</span>clust4_MSA))</span>
<span id="cb158-1127"><a href="#cb158-1127" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">table</span>(meta_taxo2<span class="sc">$</span>Kingdom,meta_taxo2<span class="sc">$</span>clust4_Mun))</span>
<span id="cb158-1128"><a href="#cb158-1128" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">table</span>(meta_taxo2<span class="sc">$</span>clust4_Mun,meta_taxo2<span class="sc">$</span>clust4_MSA))</span>
<span id="cb158-1129"><a href="#cb158-1129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1130"><a href="#cb158-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1131"><a href="#cb158-1131" aria-hidden="true" tabindex="-1"></a>The table below correlates the clusters with the Phylum information.</span>
<span id="cb158-1132"><a href="#cb158-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1135"><a href="#cb158-1135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1136"><a href="#cb158-1136" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb158-1137"><a href="#cb158-1137" aria-hidden="true" tabindex="-1"></a>MSA_table<span class="ot">=</span><span class="fu">melt</span>(<span class="fu">table</span>(meta_taxo2<span class="sc">$</span>Kingdom,meta_taxo2<span class="sc">$</span>Phylum,meta_taxo2<span class="sc">$</span>clust4_MSA))</span>
<span id="cb158-1138"><a href="#cb158-1138" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(MSA_table)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Kingdom"</span>,<span class="st">"Phylum"</span>,<span class="st">"cluster_MSA"</span>,<span class="st">"N"</span>)</span>
<span id="cb158-1139"><a href="#cb158-1139" aria-hidden="true" tabindex="-1"></a>MSA_table<span class="ot">=</span>MSA_table <span class="sc">%&gt;%</span> <span class="fu">filter</span>(N<span class="sc">!=</span><span class="dv">0</span>)</span>
<span id="cb158-1140"><a href="#cb158-1140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1141"><a href="#cb158-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1144"><a href="#cb158-1144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1145"><a href="#cb158-1145" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(MSA_table)</span>
<span id="cb158-1146"><a href="#cb158-1146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1147"><a href="#cb158-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1148"><a href="#cb158-1148" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison core's all algaes, fungi and archaea</span></span>
<span id="cb158-1149"><a href="#cb158-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1150"><a href="#cb158-1150" aria-hidden="true" tabindex="-1"></a>????? Aquí no sé muy bien que hacemos XXXXXX</span>
<span id="cb158-1151"><a href="#cb158-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1154"><a href="#cb158-1154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1155"><a href="#cb158-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#reactions=names(Results)[-c(1:5)]</span></span>
<span id="cb158-1156"><a href="#cb158-1156" aria-hidden="true" tabindex="-1"></a><span class="co">#cores=tibble(reactions)</span></span>
<span id="cb158-1157"><a href="#cb158-1157" aria-hidden="true" tabindex="-1"></a><span class="co">#cores=cores %&gt;%  separate(reactions, into=c("reactions","enzyme"),sep="\\(")</span></span>
<span id="cb158-1158"><a href="#cb158-1158" aria-hidden="true" tabindex="-1"></a><span class="co">#cores$enzyme=gsub("\\(|\\)",replacement = "",cores$enzyme)</span></span>
<span id="cb158-1159"><a href="#cb158-1159" aria-hidden="true" tabindex="-1"></a><span class="co">#cores</span></span>
<span id="cb158-1160"><a href="#cb158-1160" aria-hidden="true" tabindex="-1"></a><span class="co">#algae_core=</span></span>
<span id="cb158-1161"><a href="#cb158-1161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1162"><a href="#cb158-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1165"><a href="#cb158-1165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1166"><a href="#cb158-1166" aria-hidden="true" tabindex="-1"></a><span class="co">#Results</span></span>
<span id="cb158-1167"><a href="#cb158-1167" aria-hidden="true" tabindex="-1"></a><span class="co">#cores</span></span>
<span id="cb158-1168"><a href="#cb158-1168" aria-hidden="true" tabindex="-1"></a><span class="co">#meta_taxo</span></span>
<span id="cb158-1169"><a href="#cb158-1169" aria-hidden="true" tabindex="-1"></a>cores_names<span class="ot">=</span><span class="fu">unique</span>(Results<span class="sc">$</span>Groups)</span>
<span id="cb158-1170"><a href="#cb158-1170" aria-hidden="true" tabindex="-1"></a>cores_names</span>
<span id="cb158-1171"><a href="#cb158-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1172"><a href="#cb158-1172" aria-hidden="true" tabindex="-1"></a>cores_combi<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb158-1173"><a href="#cb158-1173" aria-hidden="true" tabindex="-1"></a><span class="co">#x=cores_names[1]  </span></span>
<span id="cb158-1174"><a href="#cb158-1174" aria-hidden="true" tabindex="-1"></a>Id<span class="ot">=</span>meta_taxo2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Groups<span class="sc">==</span>x) <span class="sc">%&gt;%</span> <span class="fu">select</span>(mDAG_Id)</span>
<span id="cb158-1175"><a href="#cb158-1175" aria-hidden="true" tabindex="-1"></a>Id<span class="ot">=</span><span class="fu">as.character</span>(Id<span class="sc">$</span>mDAG_Id)</span>
<span id="cb158-1176"><a href="#cb158-1176" aria-hidden="true" tabindex="-1"></a><span class="co">#bin_NA=function(x) {case_when(!is.na(x) ~ 0 ,default=1)}</span></span>
<span id="cb158-1177"><a href="#cb158-1177" aria-hidden="true" tabindex="-1"></a>not_NA<span class="ot">=</span> <span class="cf">function</span>(x) {<span class="sc">!</span><span class="fu">is.na</span>(x)}</span>
<span id="cb158-1178"><a href="#cb158-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1179"><a href="#cb158-1179" aria-hidden="true" tabindex="-1"></a>mda_filter<span class="ot">=</span> Results <span class="sc">%&gt;%</span></span>
<span id="cb158-1180"><a href="#cb158-1180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mDAG_Id <span class="sc">%in%</span> Id) <span class="sc">%&gt;%</span></span>
<span id="cb158-1181"><a href="#cb158-1181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"R"</span>)) <span class="sc">%&gt;%</span>   </span>
<span id="cb158-1182"><a href="#cb158-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(not_NA) <span class="sc">%&gt;%</span> <span class="fu">mutate_all</span>(as.integer)</span>
<span id="cb158-1183"><a href="#cb158-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1184"><a href="#cb158-1184" aria-hidden="true" tabindex="-1"></a><span class="co">#%&gt;%</span></span>
<span id="cb158-1185"><a href="#cb158-1185" aria-hidden="true" tabindex="-1"></a><span class="co"># mutate(mDag_id=Id,.before=1)</span></span>
<span id="cb158-1186"><a href="#cb158-1186" aria-hidden="true" tabindex="-1"></a><span class="co">#aux=colSums(mda_filter)</span></span>
<span id="cb158-1187"><a href="#cb158-1187" aria-hidden="true" tabindex="-1"></a><span class="co">#aux=as.integer(aux==length(Id))</span></span>
<span id="cb158-1188"><a href="#cb158-1188" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(mda_filter)</span>
<span id="cb158-1189"><a href="#cb158-1189" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb158-1190"><a href="#cb158-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1191"><a href="#cb158-1191" aria-hidden="true" tabindex="-1"></a><span class="co">#cores_combi("Cluster1")</span></span>
<span id="cb158-1192"><a href="#cb158-1192" aria-hidden="true" tabindex="-1"></a>cores_list<span class="ot">=</span><span class="fu">lapply</span>(cores_names,cores_combi)</span>
<span id="cb158-1193"><a href="#cb158-1193" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cores_list)<span class="ot">=</span>cores_names</span>
<span id="cb158-1194"><a href="#cb158-1194" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(cores_list,dim)</span>
<span id="cb158-1195"><a href="#cb158-1195" aria-hidden="true" tabindex="-1"></a>cores_raw<span class="ot">=</span><span class="fu">lapply</span>(cores_list,<span class="at">FUN=</span><span class="cf">function</span>(X){<span class="fu">apply</span>(X,<span class="dv">2</span>,prod)})</span>
<span id="cb158-1196"><a href="#cb158-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1197"><a href="#cb158-1197" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span>cores_raw <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>(<span class="at">.name_repair =</span><span class="st">"universal"</span>)</span>
<span id="cb158-1198"><a href="#cb158-1198" aria-hidden="true" tabindex="-1"></a><span class="co">#names(aux)=cores_names</span></span>
<span id="cb158-1199"><a href="#cb158-1199" aria-hidden="true" tabindex="-1"></a>cores_reactions <span class="ot">=</span> <span class="fu">cbind</span>(reactions,aux)</span>
<span id="cb158-1200"><a href="#cb158-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1201"><a href="#cb158-1201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1202"><a href="#cb158-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1205"><a href="#cb158-1205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1206"><a href="#cb158-1206" aria-hidden="true" tabindex="-1"></a><span class="co">#names(cores)</span></span>
<span id="cb158-1207"><a href="#cb158-1207" aria-hidden="true" tabindex="-1"></a><span class="co">#knitr::kable(colSums(cores[,-c(1,2)]),col.names = c("Freq"))</span></span>
<span id="cb158-1208"><a href="#cb158-1208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1209"><a href="#cb158-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1212"><a href="#cb158-1212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1213"><a href="#cb158-1213" aria-hidden="true" tabindex="-1"></a> cores_reactions <span class="sc">%&gt;%</span> <span class="fu">select</span>(reactions,<span class="st">`</span><span class="at">MSA.Cluster.3.MUN.Cluster.3</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-1214"><a href="#cb158-1214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">MSA.Cluster.3.MUN.Cluster.3</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-1215"><a href="#cb158-1215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">http=</span><span class="fu">paste0</span>(<span class="st">"https://www.genome.jp/entry/"</span>,</span>
<span id="cb158-1216"><a href="#cb158-1216" aria-hidden="true" tabindex="-1"></a>                     reactions))<span class="ot">-&gt;</span> aux</span>
<span id="cb158-1217"><a href="#cb158-1217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1218"><a href="#cb158-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-1221"><a href="#cb158-1221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb158-1222"><a href="#cb158-1222" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(aux)</span>
<span id="cb158-1223"><a href="#cb158-1223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb158-1224"><a href="#cb158-1224" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>