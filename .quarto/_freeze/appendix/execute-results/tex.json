{
  "hash": "f456cd1a92d1bb78e3b1546f32a8eb0b",
  "result": {
    "engine": "knitr",
    "markdown": "## Appendix\n\nSome tables and graphs for the supplementary material.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(file='metadag_work_space.RData')\n```\n:::\n\n\n\n\n\n\nTable MBB sizes\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_delim=write_delim(table_MBB_size,\n                        file=\"data_appendix/table_MBB_size.csv\",\n                        delim=\",\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclust4_MSA2=tibble(mDAG_Id=names(clust4_MSA),\n                      clust4_MSA=as.integer(clust4_MSA))\nclust4_Mun2=tibble(mDAG_Id=names(clust4_Mun),\n                      clust4_Mun=as.integer(clust4_Mun))\n\nclust4_MSA_Eukaryotes_taxo= meta_taxo %>% filter(!is.na(Kingdom))%>%\n  select(-c(Freq_Kingdom,Freq_Phylum,Freq_Class)) %>%\n  left_join(clust4_MSA2,by=\"mDAG_Id\")\n  \nclust4_Mun_Eukaryotes_taxo= meta_taxo %>% filter(!is.na(Kingdom))%>%\n  select(-c(Freq_Kingdom,Freq_Phylum,Freq_Class)) %>%\n  left_join(clust4_Mun2,by=\"mDAG_Id\")\n  \n\n\n\nwrite_delim(clust4_MSA_Eukaryotes_taxo,\n                        file=\"data_appendix/clust4_MSA_Eukaryotes_taxo.csv\",\n                        delim=\",\")\nwrite_delim(clust4_Mun_Eukaryotes_taxo,\n                        file=\"data_appendix/clust4_Mun_Eukaryotes_taxo.csv\",\n                        delim=\",\")\n```\n:::\n\n\n\n\n\n\nHeatmaps by Kingdom MSA y Mun: Animals, Fungi, Plants ans Protists.\n\n**Animals**\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n##  Animals by phylum\nmeta_animals= meta_taxo %>% filter(Kingdom==\"Animals\")\nnamesP=names(rev(sort(table(meta_animals$Phylum))))\nnamesP\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Vertebrates\"      \"Arthropods\"       \"Mollusks\"         \"Cnidarians\"      \n [5] \"Nematodes\"        \"Flatworms\"        \"Echinoderms\"      \"Tunicates\"       \n [9] \"Cephalochordates\" \"Poriferans\"       \"Placozoans\"       \"Hemichordates\"   \n[13] \"Brachiopodas\"     \"Annelids\"        \n```\n\n\n:::\n\n```{.r .cell-code}\ndff=data.frame(Phylum=meta_animals$Phylum)\nPhylum=ordered(meta_animals$Phylum,levels=namesP)\nnumbersP=paste(c(paste0(0,1:9),10:14),namesP,sep=\"-\")\nlevels(Phylum)=numbersP\ndff$Phylum=Phylum\ncol=rainbow(length(namesP))\n\ncolorsP=list(Phylum=col)\nnames(colorsP$Phylum)=numbersP\n\nannot <- HeatmapAnnotation(df = dff, \n                               col = colorsP,\n                               annotation_name_side = \"left\",\n                               show_annotation_name=TRUE )\n\nMSA_heat_2 <-  Heatmap(\n  matrix = Sim_MSA_mDAG[meta_animals$mDAG_Id,\n                        meta_animals$mDAG_Id],\n  name = \"MSA similarity\",\n  column_title = \"m-DAGs MSA-similarity  Animals by Phyla\",\n  col = rev(viridis(256)),\n  cluster_rows = FALSE,\n  show_heatmap_legend = FALSE,\n  cluster_columns = FALSE,\n  top_annotation = annot,\n  show_column_names = FALSE,\n  show_row_names = FALSE,\n  left_annotation =\n    rowAnnotation(\n      df = dff,\n      col = colorsP,\n      show_annotation_name = FALSE\n    )\n)\n\n\n\n\nMun_heat_2 <- Heatmap(\n  matrix = Sim_Mun_mDAG[meta_animals$mDAG_Id,\n                        meta_animals$mDAG_Id],\n  column_title = \"m-DAGs Munkres-similarity  Animals by Phyla\",\n col = rev(viridis(256)),\n  cluster_rows = FALSE,\n  show_heatmap_legend = FALSE,\n  cluster_columns = FALSE,\n  top_annotation = annot,\n  show_column_names = FALSE,\n  show_row_names = FALSE,\n  left_annotation =\n    rowAnnotation(\n      df = dff,\n      col = colorsP,\n      show_annotation_name = FALSE\n    )\n)\n```\n:::\n\n\n\n\n\n\nSave graphics\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\npdf \n  2 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\npdf \n  2 \n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](appendix_files/figure-pdf/unnamed-chunk-7-1.pdf){width=100%}\n:::\n\n::: {.cell-output-display}\n![](appendix_files/figure-pdf/unnamed-chunk-7-2.pdf){width=100%}\n:::\n:::\n\n\n\n\n\n\n**Plants**\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmeta_plants= meta_taxo[1:884,] %>% filter(Kingdom==\"Plants\")\nnamesP=names(rev(sort(table(meta_plants$Phylum))))\nnamesP\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Eudicots\" \"Monocots\" \"Green\"    \"Red\"      \"Basal\"    \"Mosses\"   \"Ferns\"   \n```\n\n\n:::\n\n```{.r .cell-code}\ndff=data.frame(Phylum=meta_plants$Phylum)\nPhylum=ordered(meta_plants$Phylum,levels=namesP)\nnumbersP=paste(c(paste0(0,1:7)),namesP,sep=\"-\")\nlevels(Phylum)=numbersP\ndff$Phylum=Phylum\ncol=rainbow(length(namesP))\n\ncolorsP=list(Phylum=col)\nnames(colorsP$Phylum)=numbersP\n\nannot <- HeatmapAnnotation(df = dff, \n                               col = colorsP,\n                               annotation_name_side = \"left\",\n                               show_annotation_name=TRUE )\n\nMSA_heat_2 <-  Heatmap(\n  matrix = Sim_MSA_mDAG[meta_plants$mDAG_Id,\n                        meta_plants$mDAG_Id],\n  name = \"MSA similarity\",\n  column_title = \"m-DAGs MSA-similarity  Plants by Phyla\",\n  col = rev(viridis(256)),\n  cluster_rows = FALSE,\n  show_heatmap_legend = FALSE,\n  cluster_columns = FALSE,\n  top_annotation = annot,\n  show_column_names = FALSE,\n  show_row_names = FALSE,\n  left_annotation =\n    rowAnnotation(\n      df = dff,\n      col = colorsP,\n      show_annotation_name = FALSE\n    )\n)\n\nMun_heat_2 <- Heatmap(\n  matrix = Sim_Mun_mDAG[meta_plants$mDAG_Id,\n                        meta_plants$mDAG_Id],\n    name = \"Mun similarity\",\n  column_title = \"m-DAGs Munkres-similarity  Plants by Phyla\",\ncol = rev(viridis(256)),\n  cluster_rows = FALSE,\n  show_heatmap_legend = FALSE,\n  cluster_columns = FALSE,\n  top_annotation = annot,\n  show_column_names = FALSE,\n  show_row_names = FALSE,\n  left_annotation =\n    rowAnnotation(\n      df = dff,\n      col = colorsP,\n      show_annotation_name = FALSE\n    )\n)\n```\n:::\n\n\n\n\n\n\nSave graphics\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\npdf \n  2 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\npdf \n  2 \n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](appendix_files/figure-pdf/unnamed-chunk-10-1.pdf){width=100%}\n:::\n\n::: {.cell-output-display}\n![](appendix_files/figure-pdf/unnamed-chunk-10-2.pdf){width=100%}\n:::\n:::\n\n\n\n\n\n\n**Fungi**\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmeta_fungi= meta_taxo%>% filter(Kingdom==\"Fungi\")\nnamesP=names(rev(sort(table(meta_fungi$Phylum))))\nnamesP\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Ascomycetes\"     \"Basidiomycetes\"  \"Microsporidians\"\n```\n\n\n:::\n\n```{.r .cell-code}\ndff=data.frame(Phylum=meta_fungi$Phylum)\nPhylum=ordered(meta_fungi$Phylum,levels=namesP)\nn=length(namesP)\n\nnumbersP=paste(c(paste0(0,1:n)),namesP,sep=\"-\")\nlevels(Phylum)=numbersP\ndff$Phylum=Phylum\ncol=rainbow(length(namesP))\n\ncolorsP=list(Phylum=col)\nnames(colorsP$Phylum)=numbersP\n\nannot <- HeatmapAnnotation(df = dff, \n                               col = colorsP,\n                               annotation_name_side = \"left\",\n                               show_annotation_name=TRUE )\n\nMSA_heat_2 <-  Heatmap(\n  matrix = Sim_MSA_mDAG[meta_fungi$mDAG_Id,\n                        meta_fungi$mDAG_Id],\n  name = \"MSA similarity\",\n  column_title = \"m-DAGs MSA-similarity  Fungi by Phyla\",\n  col = rev(viridis(256)),\n  cluster_rows = FALSE,\n  show_heatmap_legend = FALSE,\n  cluster_columns = FALSE,\n  top_annotation = annot,\n  show_column_names = FALSE,\n  show_row_names = FALSE,\n  left_annotation =\n    rowAnnotation(\n      df = dff,\n      col = colorsP,\n      show_annotation_name = FALSE\n    )\n)\n\nMun_heat_2 <- Heatmap(\n  matrix = Sim_Mun_mDAG[meta_fungi$mDAG_Id,\n                        meta_fungi$mDAG_Id],\n    name = \"Mun similarity\",\n  column_title = \"m-DAGs Munkres-similarity  Fungi by Phyla\",\ncol = rev(viridis(256)),\n  cluster_rows = FALSE,\n  show_heatmap_legend = FALSE,\n  cluster_columns = FALSE,\n  top_annotation = annot,\n  show_column_names = FALSE,\n  show_row_names = FALSE,\n  left_annotation =\n    rowAnnotation(\n      df = dff,\n      col = colorsP,\n      show_annotation_name = FALSE\n    )\n)\n```\n:::\n\n\n\n\n\n\nSave graphics\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\npdf \n  2 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\npdf \n  2 \n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](appendix_files/figure-pdf/unnamed-chunk-13-1.pdf){width=100%}\n:::\n\n::: {.cell-output-display}\n![](appendix_files/figure-pdf/unnamed-chunk-13-2.pdf){width=100%}\n:::\n:::\n\n\n\n\n\n\n**Protists**\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmeta_protists= meta_taxo %>% filter(Kingdom==\"Protists\")\n\nnamesP=names(rev(sort(table(meta_protists$Phylum))))\nnamesP\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Alveolates\"        \"Euglenozoa\"        \"Stramenopiles\"    \n[4] \"Amoebozoa\"         \"Metamonada\"        \"Choanoflagellates\"\n[7] \"Heterolobosea\"     \"Haptophyta\"        \"Cryptomonads\"     \n```\n\n\n:::\n\n```{.r .cell-code}\ndff=data.frame(Phylum=meta_protists$Phylum)\nPhylum=ordered(meta_protists$Phylum,levels=namesP)\nn=length(namesP)\nnumbersP=paste(c(paste0(0,1:n)),namesP,sep=\"-\")\nlevels(Phylum)=numbersP\ndff$Phylum=Phylum\ncol=rainbow(length(namesP))\n\ncolorsP=list(Phylum=col)\nnames(colorsP$Phylum)=numbersP\n\nannot <- HeatmapAnnotation(df = dff, \n                               col = colorsP,\n                               annotation_name_side = \"left\",\n                               show_annotation_name=TRUE )\n\nMSA_heat_2 <-  Heatmap(\n  matrix = Sim_MSA_mDAG[meta_protists$mDAG_Id,\n                        meta_protists$mDAG_Id],\n  name = \"MSA similarity\",\n  column_title = \"m-DAGs MSA-similarity  Protist by Phyla\",\n  col = rev(viridis(256)),\n  cluster_rows = FALSE,\n  show_heatmap_legend = FALSE,\n  cluster_columns = FALSE,\n  top_annotation = annot,\n  show_column_names = FALSE,\n  show_row_names = FALSE,\n  left_annotation =\n    rowAnnotation(\n      df = dff,\n      col = colorsP,\n      show_annotation_name = FALSE\n    )\n)\n\nMun_heat_2 <- Heatmap(\n  matrix = Sim_Mun_mDAG[meta_protists$mDAG_Id,\n                        meta_protists$mDAG_Id],\n    name = \"Mun similarity\",\n  column_title = \"m-DAGs Munkres-similarity  Protist by Phyla\",\ncol = rev(viridis(256)),\n  cluster_rows = FALSE,\n  show_heatmap_legend = FALSE,\n  cluster_columns = FALSE,\n  top_annotation = annot,\n  show_column_names = FALSE,\n  show_row_names = FALSE,\n  left_annotation =\n    rowAnnotation(\n      df = dff,\n      col = colorsP,\n      show_annotation_name = FALSE\n    )\n)\n```\n:::\n\n\n\n\n\n\nSave graphics\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndraw(MSA_heat_2,merge_legend=TRUE)\n```\n\n::: {.cell-output-display}\n![](appendix_files/figure-pdf/unnamed-chunk-16-1.pdf){fig-pos='H' width=100%}\n:::\n\n```{.r .cell-code}\ndraw(Mun_heat_2,merge_legend=TRUE)\n```\n\n::: {.cell-output-display}\n![](appendix_files/figure-pdf/unnamed-chunk-16-2.pdf){fig-pos='H' width=100%}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}