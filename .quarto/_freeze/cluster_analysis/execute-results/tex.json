{
  "hash": "c8b5d8c649d2dbb5d2fbb60fb2abd443",
  "result": {
    "engine": "knitr",
    "markdown": "\n\n::: {.cell}\n\n```{.r .cell-code}\nload(file='metadag_work_space.RData')\n```\n:::\n\n\n\n\n\n\n\n# Clusters analysis\n\nIn the Eukaryotes test, we aimed to analyze which factors caused some algae and plants to be distinguished from their respective kingdoms. To address this question, we revisited the core metabolism obtained with MetaDAG, focusing on each cluster.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreactions=names(Results)\nreactions=reactions[grep(\"(^R\\\\d{5})\",reactions)]\nreactions=tibble(reactions)\nreactions=reactions %>% separate(reactions, into=c(\"r_id\",\"enzyme\"),sep=\"\\\\(\",remove=FALSE)\nreactions=reactions %>% mutate(enzyme=gsub(\"\\\\(|\\\\)\",\"\",enzyme))\n#reactions=reactions[,-3]\nreactions$rev=stringr::str_detect(reactions$r_id,\"v\")\n```\n:::\n\n\n\n\n\n\nThe results of the clusters are compared to the classification of Kingdoms for both similarity measures:\n  \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclust4_MSA2=tibble(mDAG_Id=names(clust4_MSA), clust4_MSA=clust4_MSA)\nclust4_Mun2=tibble(mDAG_Id=names(clust4_Mun), clust4_Mun=clust4_Mun)\nmeta_taxo2=meta_taxo\nmeta_taxo2=meta_taxo2 %>% left_join(clust4_MSA2,by= \"mDAG_Id\") %>% \n  left_join(clust4_Mun2,by= \"mDAG_Id\")\nmeta_taxo2$combined_cluster_MSA_Kingdom=paste0(meta_taxo2$Kingdom,meta_taxo2$clust4_MSA)\nmeta_taxo2$combined_cluster_Mun_Kingdom=paste0(meta_taxo2$Kingdom,meta_taxo2$clust4_MSA)\nwrite.csv(meta_taxo2,file=\"meta_taxo_4_clusters.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(table(meta_taxo2$Kingdom,meta_taxo2$clust4_MSA))\n```\n\n::: {.cell-output-display}\n\n\n|         |   1|   2|   3|   4|\n|:--------|---:|---:|---:|---:|\n|Animals  | 331| 197|   7|   0|\n|Fungi    |   0|   0| 154|   0|\n|Plants   |   0|   0|  14| 125|\n|Protists |   0|   0|  56|   0|\n\n\n:::\n\n```{.r .cell-code}\nknitr::kable(table(meta_taxo2$Kingdom,meta_taxo2$clust4_Mun))\n```\n\n::: {.cell-output-display}\n\n\n|         |   1|   2|   3|   4|\n|:--------|---:|---:|---:|---:|\n|Animals  | 331| 197|   7|   0|\n|Fungi    |   0|   0| 154|   0|\n|Plants   |   0|   0|  14| 125|\n|Protists |   0|   0|  56|   0|\n\n\n:::\n\n```{.r .cell-code}\nknitr::kable(table(meta_taxo2$clust4_Mun,meta_taxo2$clust4_MSA))\n```\n\n::: {.cell-output-display}\n\n\n|   1|   2|   3|   4|\n|---:|---:|---:|---:|\n| 331|   0|   0|   0|\n|   0| 197|   0|   0|\n|   0|   0| 231|   0|\n|   0|   0|   0| 125|\n\n\n:::\n:::\n\n\n\n\n\n\nThe table below correlates the clusters with the Phylum information.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(reshape2)\nMSA_table=melt(table(meta_taxo2$Kingdom,meta_taxo2$Phylum,meta_taxo2$clust4_MSA))\nnames(MSA_table)=c(\"Kingdom\",\"Phylum\",\"cluster_MSA\",\"N\")\nMSA_table=MSA_table %>% filter(N!=0)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(MSA_table)\n```\n\n::: {.cell-output-display}\n\n\n|Kingdom  |Phylum            | cluster_MSA|   N|\n|:--------|:-----------------|-----------:|---:|\n|Animals  |Vertebrates       |           1| 331|\n|Animals  |Annelids          |           2|   1|\n|Animals  |Arthropods        |           2| 158|\n|Animals  |Brachiopodas      |           2|   1|\n|Animals  |Cephalochordates  |           2|   2|\n|Animals  |Cnidarians        |           2|  10|\n|Animals  |Echinoderms       |           2|   3|\n|Animals  |Hemichordates     |           2|   1|\n|Animals  |Mollusks          |           2|  14|\n|Animals  |Nematodes         |           2|   3|\n|Animals  |Placozoans        |           2|   1|\n|Animals  |Poriferans        |           2|   1|\n|Animals  |Tunicates         |           2|   2|\n|Protists |Alveolates        |           3|  25|\n|Protists |Amoebozoa         |           3|   7|\n|Fungi    |Ascomycetes       |           3| 113|\n|Fungi    |Basidiomycetes    |           3|  36|\n|Protists |Choanoflagellates |           3|   2|\n|Protists |Cryptomonads      |           3|   1|\n|Protists |Euglenozoa        |           3|   9|\n|Animals  |Flatworms         |           3|   4|\n|Plants   |Green             |           3|  11|\n|Protists |Haptophyta        |           3|   1|\n|Protists |Heterolobosea     |           3|   1|\n|Protists |Metamonada        |           3|   2|\n|Fungi    |Microsporidians   |           3|   5|\n|Animals  |Nematodes         |           3|   3|\n|Plants   |Red               |           3|   3|\n|Protists |Stramenopiles     |           3|   8|\n|Plants   |Basal             |           4|   2|\n|Plants   |Eudicots          |           4|  98|\n|Plants   |Ferns             |           4|   1|\n|Plants   |Monocots          |           4|  23|\n|Plants   |Mosses            |           4|   1|\n\n\n:::\n:::\n",
    "supporting": [
      "cluster_analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}