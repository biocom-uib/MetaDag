{
  "hash": "772e0bc06d2aa67e60dc8f0855e8f14e",
  "result": {
    "engine": "knitr",
    "markdown": "\n\n::: {.cell}\n\n```{.r .cell-code}\nload(file='metadag_work_space.RData')\n```\n:::\n\n\n\n\n\n\n\n\n# Metabolic Graphs\n\nWe present here some analysis examples of the metabolic graphs generated in GraphML format.\n\n## Metabolic graphs for each organism\n\nRead the individual metabolic graphs generated for Homo sapiens (KEGG id: hsa) in the directory(Individuals/hsa)\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexperiment=\n  \"0a845f74-826e-3b46-aed9-e7ecf74db262/\"\npath_exp=paste0(\"data/\",experiment)\nfiles_hsa=dir(paste0(path_exp,\"Individuals/hsa\"))\nfiles_hsa\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"hsa_mDAG.graphml\"       \"hsa_mDAG.pdf\"           \"hsa_mDAG.svg\"          \n [4] \"hsa_mDAG_adj.csv\"       \"hsa_mDAG_biggerDAG.pdf\" \"hsa_mDAG_biggerDAG.svg\"\n [7] \"hsa_mDAG_nl.csv\"        \"hsa_mDAG_structure.csv\" \"hsa_R_adj.csv\"         \n[10] \"hsa_R_nl.csv\"           \"hsa_RC.graphml\"         \"hsa_RC.pdf\"            \n[13] \"hsa_RC.svg\"             \"hsa_summary.txt\"       \n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|files_Individual_hsa   |Description                                                                       |\n|:----------------------|:---------------------------------------------------------------------------------|\n|hsa_mDAG.graphml       |m-DAG GraphML format                                                              |\n|hsa_mDAG.pdf           |m-DAG pdf graphic                                                                 |\n|hsa_mDAG.svg           |m-DAG svg graphic                                                                 |\n|hsa_mDAG_adj.csv       |csv file with the adjacency matrix of the m-DAG                                   |\n|hsa_mDAG_biggerDAG.pdf |pdf graphic with the biggest conected componet of the m-DAG                       |\n|hsa_mDAG_biggerDAG.svg |svg graphic with the biggest conected componet of the m-DAG                       |\n|hsa_mDAG_nl.csv        |csv file with the node (MBBs) labels  of the m-DAG                                |\n|hsa_mDAG_structure.csv |csv file with all connected components of the m-DAG                               |\n|hsa_R_adj.csv          |csv file with the  adjacency matrix of the reaction graph                         |\n|hsa_R_nl.csv           |csv file with the node (reactions) labels  of the reaction graph                  |\n|hsa_RC.graphml         |reaction graph  GraphML format                                                    |\n|hsa_RC.pdf             |reaction graph pdf graphic                                                        |\n|hsa_RC.svg             |reaction graph svg graphic                                                        |\n|hsa_summary.txt        |text summary file with the number of MBBs, reactions, etc. in the previous graphs |\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n## Pan & core metabolic graphs\n\nPan and core metabolic graphs for every group were generated. For instance, one can read the pan and core metabolic graphs generated for the group Algae in the directory (Groups/Algae).\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfiles_Algae=dir(paste0(path_exp,\"Groups/Algae\"))\nfiles_Algae\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"core\" \"pan\" \n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\nThe global core reaction graph, which is the core of all the organisms' reaction graphs in this Eukaryotes test, is empty.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraph_core_RC=read.graph(\n  paste0(path_exp,\n         \"Global/core/core_RC.graphml\"),\n  format = \"graphml\")\nsummary(graph_core_RC)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nIGRAPH 62576d2 D--- 0 0 -- \n+ attr: color (v/c), label (v/c), id (v/c)\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\nThe global core reaction graph has 0 vertex and 0 edges. It is an empty graph.\n\nThe core reaction graph for the Algae group is:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::include_graphics(\n  paste0(path_exp,\"Groups/MSA_Cluster_3/core/MSA_Cluster_3_core_RC.pdf\"))\n```\n\n::: {.cell-output-display}\n![Algae core reaction graph](data/0a845f74-826e-3b46-aed9-e7ecf74db262/Groups/MSA_Cluster_3/core/MSA_Cluster_3_core_RC.pdf){width=100%}\n:::\n:::\n\n\n\n\n\n\n\n\nThe global core m-DAG, i.e., the core of all organisms in this example is empty.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraph_core_mDAG=read.graph(\n  paste0(path_exp,\"Global/core/core_mDAG.graphml\"),\n  format = \"graphml\")\nsummary(graph_core_mDAG)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nIGRAPH 62610f2 D--- 0 0 -- \n+ attr: color (v/c), label (v/c), id (v/c)\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\nThe global core m-DAG has 0 vertex and 0 edges. It is an empty graph.\n\nThe core metabolic DAG for the Algae group is:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::include_graphics(paste0(path_exp,                              \"Groups/Algae/core/Algae_core_mDAG.pdf\"))\n```\n\n::: {.cell-output-display}\n![Core m-DAG for Algae](data/0a845f74-826e-3b46-aed9-e7ecf74db262/Groups/Algae/core/Algae_core_mDAG.pdf){width=100%}\n:::\n:::\n\n\n\n\n\n\n\n\nThe global pan reaction graph for the Animals Kingdom is:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraph_pan_RC=read.graph(\n  paste0(path_exp,\n         \"TaxonomyLevels/Kingdom/Animals/pan/Animals_pan_RC.graphml\"),\n  format = \"graphml\")\nsummary(graph_pan_RC)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nIGRAPH 627ebd1 D--- 4556 5798 -- \n+ attr: color (v/c), label (v/c), id (v/c), id (e/c)\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\nThis pan reaction graph has 4556 nodes and 5798 edges.\n\n## Graph's topology\n\nFrom the GraphML files, one can extract topological information. Some examples are as follows.\n\nThe diagram below illustrates the distribution of node degrees for an m-DAG.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraph_mDAG=read.graph(\n  paste0(path_exp,\n         \"Individuals/hsa/hsa_mDAG.graphml\"),\n  format= \"graphml\")\nsummary(graph_mDAG)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nIGRAPH 62af36d D--- 1026 1086 -- \n+ attr: color (v/c), label (v/c), id (v/c), id (e/c)\n```\n\n\n:::\n\n```{.r .cell-code}\nbarplot(table(igraph::degree(graph_mDAG,mode=\"all\")),\n        ylim=c(0,350),col=\"blue\",\n        main=\"Frequency of Node Degrees\",\n        ylab=\"Frequency\",xlab=\"Degree\")\n```\n\n::: {.cell-output-display}\n![](metabolic_graphs_files/figure-html/unnamed-chunk-10-1.png){width=100%}\n:::\n:::\n\n\n\n\n\n\n\n\nThe connected components of every graph as well as the size of every connected component can be obtained as:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompo=components(graph_mDAG,mode = \"weak\")\nstr(compo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nList of 3\n $ membership: num [1:1026] 1 1 1 1 1 1 1 1 1 1 ...\n $ csize     : num [1:167] 589 1 1 1 1 1 4 3 4 3 ...\n $ no        : num 167\n```\n\n\n:::\n\n```{.r .cell-code}\ncompo$csize\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] 589   1   1   1   1   1   4   3   4   3   2   3   3   1   1   1   2   6\n [19]   3   1   3   6   1   1   1   1   1   3   1   6   2   1   1   1   2   1\n [37]   1  14   1  16   1   6   2   2   4   1   1   1   1   1   1   1   1   1\n [55]  13   1   1   1   1   2   6   5   5   2   2  10   1   1   1   2   2   1\n [73]   1   1  62   6   2   1   2   1   1   1   2   1   2  14   3   1   1   1\n [91]   1   1   1   1   1   1   3   6   1   3   1   3   2   1   1   1   2   2\n[109]   3   1   1   2   5   1   1   2   3   2   1   1   2   3   4   1   1   2\n[127]   1   1   2   1   1   1   1   1   3   1   2   2   1   6   1   1   1   2\n[145]   1   1   1   1   1   2   7   1  15   3   1   1   1   1   2   1   3   1\n[163]   1   1   1   1   2\n```\n\n\n:::\n\n```{.r .cell-code}\nk=which.max(compo$csize==max(compo$csize))\nk\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1\n```\n\n\n:::\n\n```{.r .cell-code}\ntable(compo$membership)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20 \n589   1   1   1   1   1   4   3   4   3   2   3   3   1   1   1   2   6   3   1 \n 21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40 \n  3   6   1   1   1   1   1   3   1   6   2   1   1   1   2   1   1  14   1  16 \n 41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60 \n  1   6   2   2   4   1   1   1   1   1   1   1   1   1  13   1   1   1   1   2 \n 61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80 \n  6   5   5   2   2  10   1   1   1   2   2   1   1   1  62   6   2   1   2   1 \n 81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 \n  1   1   2   1   2  14   3   1   1   1   1   1   1   1   1   1   3   6   1   3 \n101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 \n  1   3   2   1   1   1   2   2   3   1   1   2   5   1   1   2   3   2   1   1 \n121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 \n  2   3   4   1   1   2   1   1   2   1   1   1   1   1   3   1   2   2   1   6 \n141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 \n  1   1   1   2   1   1   1   1   1   2   7   1  15   3   1   1   1   1   2   1 \n161 162 163 164 165 166 167 \n  3   1   1   1   1   1   2 \n```\n\n\n:::\n\n```{.r .cell-code}\nvertex=which(compo$membership==k)\nlength(vertex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 589\n```\n\n\n:::\n\n```{.r .cell-code}\nBig_Component=induced_subgraph(graph_mDAG, vids=vertex)\nigraph::vcount(Big_Component)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 589\n```\n\n\n:::\n\n```{.r .cell-code}\nigraph::ecount(Big_Component)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 774\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\nAnd the plot of the bigger component of the m-DAG in Homo sapiens is:\n\n\n\n\n\n\n\n\n::: {.cell layout-align=\"center\" title='Bigger componet of hsa mDAG'}\n\n```{.r .cell-code}\nknitr::include_graphics(paste0(path_exp,\n                               \"Individuals/hsa/hsa_mDAG_biggerDAG.pdf\"))\n```\n\n::: {.cell-output-display}\n![](data/0a845f74-826e-3b46-aed9-e7ecf74db262/Individuals/hsa/hsa_mDAG_biggerDAG.pdf){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#path_exp=\"data/result_bb261b6e-95c6-3e39-b82b-b68eea80e30b/data/\" \nlist_names=dir(paste0(path_exp,\"Individuals/\"))\nlist_names= list_names[-1] # filter 0000_RefPw\nlength(list_names) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 884\n```\n\n\n:::\n\n```{.r .cell-code}\ngraphs_list=paste0(path_exp,\"Individuals/\", list_names,\"/\",list_names, \"_MDAG.graphml\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::include_graphics(\n  paste0(path_exp,\"Individuals/cang/cang_RC.pdf\"))\n```\n\n::: {.cell-output-display}\n![](data/0a845f74-826e-3b46-aed9-e7ecf74db262/Individuals/cang/cang_RC.pdf){width=100%}\n:::\n:::\n\n\n\n\n\n\n\n\n## Graph statistics\n\nThe number of connected component in each generated m-DAG with their frequency in the entire set of m-DAGs, can be obtained as follows:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nread_mDAG=function(x) {DAG=read.graph(file=x,\n                                      format=\"graphml\")\nreturn(DAG)}\nmDAG_componets=function(x) {\n  sort(components(x,mode = \"weak\")$csize,\n       decreasing=TRUE)\n}\n\ncompo_list=lapply(graphs_list,\n                  FUN=function(x) {\n                    gg=read_mDAG(x)\n                    aux=list(\n                      mDAG_componets=mDAG_componets(gg),\n                      degree_count=igraph::degree(gg,mode=\"total\"))\n                    return(aux)}\n)\n\nnames(compo_list)=list_names\nn=max(sapply(compo_list,FUN=function(x) {length(x[[1]])}))\nn\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 234\n```\n\n\n:::\n\n```{.r .cell-code}\nsize_compo_list=lapply(compo_list,FUN=function(x) {\n  return(c(x[[1]],rep(NA,n-length(x[[1]]))))})\n\naux=do.call(bind_cols,size_compo_list)\nweak_componets_size=pivot_longer(aux,aaf:zvi,names_to=\"Organism\",\n                                 values_to=\"csize\") %>%\n  arrange(Organism,-csize)\nweak_componets_size$index=rep(1:n,times=dim(aux)[2])\nweak_componets_size=weak_componets_size %>%\n  left_join(meta_taxo,by=\"Organism\") %>% filter(!is.na(Kingdom),!is.na(csize))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nOrganism=names(compo_list)\nbig_MBB=function(org){\n  org=\"hsa\"\n  x=Results %>% filter(Organism==org)\n  x=as.character(x[1,5:dim(Results)[2]])\n  x=x[x!=\"NA\"]\n  tt=sort(table(x),decreasing=TRUE)\n  return(tt)\n}\nbig_MBB_list= lapply(Organism,FUN=function(x) big_MBB(x))\nnMBB=max(sapply(big_MBB_list,FUN=function(x) length(x)))\nnMBB\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1028\n```\n\n\n:::\n\n```{.r .cell-code}\nbig_MBB_list=lapply(big_MBB_list,\n                    FUN=function(x){\n                      x=c(x,rep(NA,nMBB-length(x)))\n                      return(x)}\n)\nnames(big_MBB_list)=Organism\nbig_MBB_list=do.call(bind_cols,big_MBB_list)\n\nkMBB=nrow(big_MBB_list)\nindex=rep(1:kMBB,times=length(Organism))\n\nbig_MBB_list2=pivot_longer(big_MBB_list,\n                           cols=names(big_MBB_list),\n                           values_to = \"MBBsize\",\n                           names_to = \"Organism\") %>% \n  arrange(Organism,-MBBsize) %>%  \n  mutate(index=index) %>% \n  left_join(meta_taxo,by=\"Organism\")\n```\n:::\n\n\n\n\n\n\n\n\nWe can visualize the sizes of the weak components for each m-DAG, using colors to represent the different Kingdoms, also we scale the results by a log-log plot:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCOLOR_KINGDOM=c(\"red\",\"yellow\",\"green\",\"black\")\ncolors_kingdom=weak_componets_size%>% select(Organism,Kingdom) %>% distinct()\nnames(COLOR_KINGDOM)=sort(unique(colors_kingdom$Kingdom))\n\np1<- ggplot(data=weak_componets_size) + \n  geom_line(mapping=aes(x=index,\n                        y=csize,group = Organism,\n                        color=Kingdom),\n            na.rm=TRUE) + \n  scale_x_continuous(trans=\"identity\") + \n  scale_y_continuous(trans=\"identity\") +\n  ylim(0,640)+\n  ggtitle(\"Plot of weak components size decreasing order.\")+\n  ylab(\"Weak components size\") + xlab(\"Order\")+\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom])\n\np2<- ggplot(data=weak_componets_size) + \n  geom_line(mapping=aes(x=index,\n                        y=csize,group = Organism,\n                        color=Kingdom),\n            na.rm=TRUE) + \n  scale_y_continuous(trans='log10') + \n  scale_x_continuous(trans='log10') +\n  scale_color_manual(values =COLOR_KINGDOM[colors_kingdom$Kingdom])+\n  ggtitle(\"Plot log10-log10 of size  weak components decreasing order.\") +\n  ylab(\"Log10 weak component size\") + xlab(\"Log10 order\")\np1\n```\n\n::: {.cell-output-display}\n![](metabolic_graphs_files/figure-html/unnamed-chunk-17-1.png){width=100%}\n:::\n\n```{.r .cell-code}\np2\n```\n\n::: {.cell-output-display}\n![](metabolic_graphs_files/figure-html/unnamed-chunk-17-2.png){width=100%}\n:::\n:::\n\n\n\n\n\n\n\n\nA table with the frequencies of the weak connected components sizes, displayed by Kingdom, can be obtained as follows:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naux=table(weak_componets_size$csize,weak_componets_size$Kingdom)\ntable_wcc_size=tibble(Order=1:dim(aux)[1],\n                      Wcc_size=as.integer(unlist(dimnames(aux)[1])),\n                      Animals=aux[,1],\n                      Fungi=aux[,2],\n                      Plants=aux[,3],\n                      Protists=aux[,4])\nknitr::kable(table_wcc_size)\n```\n\n::: {.cell-output-display}\n\n\n| Order| Wcc_size| Animals| Fungi| Plants| Protists|\n|-----:|--------:|-------:|-----:|------:|--------:|\n|     1|        1|   57634| 15311|  15024|     4462|\n|     2|        2|   13528|  2118|   2908|      932|\n|     3|        3|    7018|  1070|    911|      317|\n|     4|        4|    2459|   313|    292|       96|\n|     5|        5|    1962|   215|    389|       81|\n|     6|        6|    1778|   154|    323|       49|\n|     7|        7|     633|    46|    111|       15|\n|     8|        8|     278|    57|    110|        7|\n|     9|        9|     174|    76|    151|       22|\n|    10|       10|     671|     6|    124|        7|\n|    11|       11|     411|    14|      6|       20|\n|    12|       12|     109|    12|      4|        5|\n|    13|       13|     369|    92|    132|        7|\n|    14|       14|     774|     9|      2|        2|\n|    15|       15|     234|     1|      5|        6|\n|    16|       16|      79|     6|      1|        1|\n|    17|       17|      55|     8|      1|        1|\n|    18|       18|       4|     5|      9|        5|\n|    19|       19|       5|     3|     87|        4|\n|    20|       20|       9|     3|      0|        1|\n|    21|       21|      13|     2|     12|        1|\n|    22|       22|       7|     2|      2|        0|\n|    23|       23|      21|     1|      3|        0|\n|    24|       24|      19|     1|      3|        1|\n|    25|       25|      20|     0|      2|        1|\n|    26|       26|      12|     0|     39|        0|\n|    27|       27|       1|     1|     11|        0|\n|    28|       28|       5|     2|     77|        0|\n|    29|       29|      40|     1|      0|        1|\n|    30|       30|       0|     1|      1|        0|\n|    31|       31|      72|     8|      1|        0|\n|    32|       32|      11|     7|      1|        0|\n|    33|       33|       1|     0|      0|        2|\n|    34|       34|       6|     0|      0|        0|\n|    35|       35|       2|     0|      0|        0|\n|    36|       36|       3|     0|      0|        0|\n|    37|       37|       5|     1|      2|        0|\n|    38|       38|       0|     0|      0|        1|\n|    39|       39|       5|     0|      0|        0|\n|    40|       40|       5|     1|      0|        0|\n|    41|       41|       4|     0|      0|        0|\n|    42|       42|       1|     0|      0|        0|\n|    43|       43|       2|     0|      0|        1|\n|    44|       44|       6|     0|      0|        0|\n|    45|       45|       1|     0|      0|        0|\n|    46|       46|       5|     0|      0|        0|\n|    47|       47|       9|     0|      0|        0|\n|    48|       48|       1|     0|      0|        0|\n|    49|       49|       1|     1|      0|        0|\n|    50|       50|       1|     0|      0|        0|\n|    51|       51|       4|     0|      0|        0|\n|    52|       53|      50|     1|      0|        1|\n|    53|       54|       6|     0|      0|        0|\n|    54|       55|       1|     0|      0|        0|\n|    55|       56|       8|     0|      0|        0|\n|    56|       57|       2|     0|      0|        0|\n|    57|       58|      12|     1|      0|        0|\n|    58|       59|       6|     0|      0|        0|\n|    59|       60|      30|     1|      0|        0|\n|    60|       61|       5|     0|      0|        0|\n|    61|       62|      15|     0|      0|        0|\n|    62|       63|       4|     0|      0|        0|\n|    63|       64|       2|     0|      0|        0|\n|    64|       65|      34|     0|      0|        0|\n|    65|       66|       6|     0|      0|        0|\n|    66|       67|       1|     0|      0|        0|\n|    67|       69|       1|     0|      0|        0|\n|    68|       70|       2|     0|      0|        1|\n|    69|       71|       1|     0|      0|        0|\n|    70|       72|       1|     0|      0|        0|\n|    71|       73|       6|     0|      0|        0|\n|    72|       77|       2|     0|      0|        1|\n|    73|       78|       1|     0|      0|        1|\n|    74|       83|       0|     0|      0|        2|\n|    75|       84|       1|     0|      0|        0|\n|    76|       87|       1|     0|      0|        0|\n|    77|       88|       1|     0|      0|        1|\n|    78|       90|       2|     0|      0|        1|\n|    79|       91|       1|     0|      0|        0|\n|    80|       94|       4|     0|      0|        1|\n|    81|       95|       1|     0|      0|        0|\n|    82|       96|       1|     0|      0|        1|\n|    83|       97|       0|     0|      0|        1|\n|    84|       99|       1|     0|      0|        1|\n|    85|      100|       2|     0|      0|        0|\n|    86|      101|       1|     0|      0|        0|\n|    87|      102|       0|     0|      0|        1|\n|    88|      103|       3|     0|      0|        1|\n|    89|      104|       0|     0|      0|        2|\n|    90|      105|       0|     0|      0|        1|\n|    91|      107|       0|     0|      0|        1|\n|    92|      108|       1|     0|      0|        2|\n|    93|      110|       2|     0|      0|        0|\n|    94|      111|       1|     0|      0|        0|\n|    95|      112|       0|     1|      0|        0|\n|    96|      113|       2|     0|      0|        0|\n|    97|      114|       1|     0|      0|        1|\n|    98|      116|       1|     0|      0|        0|\n|    99|      117|       3|     0|      0|        0|\n|   100|      120|       1|     0|      0|        0|\n|   101|      121|       2|     0|      0|        0|\n|   102|      125|       1|     0|      0|        0|\n|   103|      127|       1|     0|      0|        1|\n|   104|      128|       0|     0|      0|        2|\n|   105|      153|       0|     1|      0|        0|\n|   106|      166|       0|     0|      0|        1|\n|   107|      175|       0|     0|      0|        2|\n|   108|      181|       0|     0|      0|        1|\n|   109|      183|       0|     0|      0|        2|\n|   110|      184|       1|     0|      0|        0|\n|   111|      187|       0|     0|      0|        1|\n|   112|      193|       1|     0|      0|        1|\n|   113|      195|       0|     0|      0|        1|\n|   114|      196|       0|     0|      0|        1|\n|   115|      198|       1|     0|      0|        0|\n|   116|      203|       0|     0|      0|        1|\n|   117|      205|       0|     0|      0|        1|\n|   118|      210|       2|     0|      0|        0|\n|   119|      219|       1|     0|      0|        1|\n|   120|      220|       1|     0|      0|        0|\n|   121|      229|       1|     0|      0|        0|\n|   122|      231|       0|     0|      0|        1|\n|   123|      232|       1|     0|      0|        0|\n|   124|      233|       0|     1|      0|        0|\n|   125|      235|       1|     0|      0|        0|\n|   126|      238|       3|     0|      0|        0|\n|   127|      243|       1|     0|      0|        0|\n|   128|      245|       0|     1|      0|        0|\n|   129|      246|       1|     1|      0|        0|\n|   130|      248|       0|     1|      0|        0|\n|   131|      249|       0|     2|      0|        0|\n|   132|      250|       0|     2|      0|        0|\n|   133|      251|       0|     1|      0|        0|\n|   134|      252|       1|     2|      0|        0|\n|   135|      253|       1|     0|      0|        0|\n|   136|      254|       0|     1|      0|        0|\n|   137|      255|       2|     0|      0|        0|\n|   138|      256|       2|     1|      0|        0|\n|   139|      257|       4|     0|      0|        0|\n|   140|      258|       1|     1|      0|        0|\n|   141|      259|       1|     0|      0|        0|\n|   142|      260|       2|     1|      0|        1|\n|   143|      261|       2|     1|      0|        0|\n|   144|      262|       2|     0|      0|        0|\n|   145|      263|       4|     1|      0|        1|\n|   146|      264|       4|     0|      0|        0|\n|   147|      265|       3|     4|      0|        2|\n|   148|      266|       2|     1|      0|        0|\n|   149|      267|       2|     1|      0|        0|\n|   150|      268|       2|     3|      0|        1|\n|   151|      269|       3|     1|      0|        0|\n|   152|      270|       3|     0|      1|        0|\n|   153|      271|       1|     1|      0|        0|\n|   154|      272|       2|     2|      0|        0|\n|   155|      273|       4|     3|      0|        1|\n|   156|      274|       2|     1|      0|        0|\n|   157|      275|       4|     2|      0|        0|\n|   158|      276|       0|     2|      0|        0|\n|   159|      277|       4|     4|      0|        0|\n|   160|      278|       3|     3|      0|        1|\n|   161|      279|       5|     0|      0|        1|\n|   162|      280|       1|     0|      0|        0|\n|   163|      281|       3|     4|      0|        0|\n|   164|      282|       4|     1|      0|        0|\n|   165|      283|       5|     1|      0|        0|\n|   166|      284|       4|     1|      0|        0|\n|   167|      285|       5|     1|      0|        0|\n|   168|      286|       4|     2|      0|        1|\n|   169|      287|       1|     0|      0|        0|\n|   170|      288|       2|     3|      0|        0|\n|   171|      289|       1|     0|      0|        0|\n|   172|      290|       3|     0|      0|        0|\n|   173|      291|       1|     1|      0|        0|\n|   174|      292|       1|     3|      0|        1|\n|   175|      293|       5|     1|      0|        0|\n|   176|      294|       6|     0|      0|        0|\n|   177|      295|       1|     2|      0|        0|\n|   178|      296|       5|     1|      0|        0|\n|   179|      297|       4|     1|      0|        0|\n|   180|      298|       2|     1|      0|        0|\n|   181|      299|       2|     0|      1|        1|\n|   182|      300|       2|     0|      0|        0|\n|   183|      301|       4|     2|      0|        0|\n|   184|      302|       1|     0|      0|        1|\n|   185|      303|       3|     0|      0|        0|\n|   186|      304|       3|     0|      0|        0|\n|   187|      305|       3|     0|      0|        0|\n|   188|      306|       2|     1|      0|        0|\n|   189|      307|       4|     1|      0|        0|\n|   190|      308|       1|     0|      0|        0|\n|   191|      310|       1|     0|      0|        0|\n|   192|      311|       1|     0|      1|        0|\n|   193|      313|       2|     2|      0|        0|\n|   194|      315|       1|     0|      0|        0|\n|   195|      316|       1|     0|      0|        0|\n|   196|      317|       1|     0|      1|        0|\n|   197|      318|       0|     2|      0|        0|\n|   198|      319|       1|     0|      0|        0|\n|   199|      320|       3|     1|      1|        0|\n|   200|      321|       1|     0|      0|        0|\n|   201|      322|       3|     0|      0|        0|\n|   202|      323|       2|     0|      0|        0|\n|   203|      325|       1|     0|      0|        0|\n|   204|      327|       2|     1|      0|        0|\n|   205|      328|       5|     1|      1|        0|\n|   206|      330|       0|     1|      0|        0|\n|   207|      332|       1|     0|      0|        0|\n|   208|      333|       1|     1|      1|        1|\n|   209|      335|       1|     0|      0|        0|\n|   210|      338|       1|     0|      0|        0|\n|   211|      339|       0|     0|      1|        1|\n|   212|      340|       1|     1|      0|        0|\n|   213|      341|       1|     0|      0|        0|\n|   214|      342|       1|     0|      0|        1|\n|   215|      343|       2|     1|      0|        0|\n|   216|      344|       0|     0|      1|        0|\n|   217|      345|       2|     0|      0|        0|\n|   218|      346|       1|     0|      0|        0|\n|   219|      347|       2|     0|      0|        0|\n|   220|      349|       2|     0|      0|        0|\n|   221|      350|       1|     0|      0|        0|\n|   222|      351|       1|     0|      0|        0|\n|   223|      352|       3|     0|      0|        0|\n|   224|      353|       1|     0|      0|        0|\n|   225|      354|       1|     0|      0|        0|\n|   226|      355|       2|     0|      0|        0|\n|   227|      356|       1|     1|      0|        0|\n|   228|      357|       1|     2|      0|        0|\n|   229|      358|       2|     1|      0|        0|\n|   230|      359|       0|     0|      1|        0|\n|   231|      360|       1|     0|      1|        0|\n|   232|      361|       1|     3|      0|        0|\n|   233|      362|       1|     2|      0|        0|\n|   234|      363|       2|     3|      0|        0|\n|   235|      365|       2|     1|      0|        0|\n|   236|      366|       1|     0|      0|        0|\n|   237|      367|       1|     0|      0|        0|\n|   238|      368|       2|     1|      0|        0|\n|   239|      369|       3|     1|      0|        0|\n|   240|      370|       0|     2|      0|        0|\n|   241|      371|       0|     2|      0|        0|\n|   242|      372|       1|     0|      0|        0|\n|   243|      373|       2|     2|      0|        0|\n|   244|      374|       3|     1|      0|        0|\n|   245|      375|       2|     1|      0|        0|\n|   246|      376|       0|     1|      0|        0|\n|   247|      377|       0|     1|      0|        0|\n|   248|      378|       2|     0|      0|        0|\n|   249|      380|       0|     3|      0|        0|\n|   250|      381|       2|     1|      0|        0|\n|   251|      382|       2|     1|      0|        0|\n|   252|      383|       3|     1|      1|        0|\n|   253|      384|       0|     1|      0|        0|\n|   254|      385|       0|     1|      0|        0|\n|   255|      387|       2|     2|      0|        0|\n|   256|      388|       1|     2|      0|        0|\n|   257|      389|       1|     0|      0|        0|\n|   258|      391|       2|     0|      0|        0|\n|   259|      392|       0|     1|      0|        0|\n|   260|      393|       1|     1|      0|        0|\n|   261|      394|       3|     0|      0|        0|\n|   262|      396|       1|     0|      0|        0|\n|   263|      397|       0|     2|      0|        0|\n|   264|      398|       2|     0|      0|        0|\n|   265|      399|       1|     1|      0|        0|\n|   266|      400|       0|     0|      1|        0|\n|   267|      401|       1|     1|      0|        0|\n|   268|      402|       0|     1|      0|        0|\n|   269|      404|       1|     1|      0|        0|\n|   270|      405|       3|     1|      0|        0|\n|   271|      406|       0|     1|      0|        0|\n|   272|      407|       0|     2|      0|        0|\n|   273|      408|       1|     1|      1|        0|\n|   274|      409|       2|     0|      0|        0|\n|   275|      411|       3|     0|      0|        0|\n|   276|      412|       1|     0|      0|        0|\n|   277|      413|       2|     1|      0|        0|\n|   278|      415|       1|     0|      0|        0|\n|   279|      416|       2|     0|      0|        0|\n|   280|      417|       0|     1|      0|        0|\n|   281|      418|       0|     1|      0|        0|\n|   282|      419|       0|     1|      0|        0|\n|   283|      420|       0|     1|      0|        0|\n|   284|      421|       1|     2|      0|        0|\n|   285|      423|       0|     2|      0|        0|\n|   286|      424|       0|     1|      0|        0|\n|   287|      426|       2|     0|      0|        0|\n|   288|      428|       1|     0|      0|        0|\n|   289|      431|       0|     1|      0|        0|\n|   290|      432|       1|     0|      0|        0|\n|   291|      433|       3|     0|      0|        0|\n|   292|      435|       1|     0|      0|        0|\n|   293|      438|       0|     1|      0|        0|\n|   294|      439|       0|     1|      0|        0|\n|   295|      443|       1|     0|      0|        0|\n|   296|      444|       1|     0|      0|        0|\n|   297|      445|       2|     1|      0|        0|\n|   298|      446|       2|     0|      0|        0|\n|   299|      447|       1|     0|      0|        0|\n|   300|      452|       1|     0|      0|        0|\n|   301|      453|       1|     0|      0|        0|\n|   302|      455|       1|     0|      0|        0|\n|   303|      459|       1|     0|      0|        0|\n|   304|      462|       1|     0|      0|        0|\n|   305|      463|       2|     0|      0|        0|\n|   306|      465|       1|     0|      0|        0|\n|   307|      468|       1|     0|      0|        0|\n|   308|      470|       1|     0|      0|        0|\n|   309|      471|       0|     0|      1|        0|\n|   310|      473|       0|     0|      1|        0|\n|   311|      475|       2|     0|      0|        0|\n|   312|      480|       1|     0|      0|        0|\n|   313|      481|       1|     0|      0|        0|\n|   314|      482|       1|     0|      0|        0|\n|   315|      483|       1|     0|      0|        0|\n|   316|      485|       0|     0|      1|        0|\n|   317|      487|       1|     0|      0|        0|\n|   318|      491|       3|     0|      0|        0|\n|   319|      492|       1|     0|      0|        0|\n|   320|      493|       3|     0|      0|        0|\n|   321|      496|       2|     0|      0|        0|\n|   322|      497|       3|     0|      0|        0|\n|   323|      500|       0|     0|      1|        0|\n|   324|      501|       1|     0|      0|        0|\n|   325|      502|       5|     0|      0|        0|\n|   326|      503|       1|     0|      0|        0|\n|   327|      504|       1|     0|      1|        0|\n|   328|      507|       2|     0|      0|        0|\n|   329|      508|       2|     0|      0|        0|\n|   330|      509|       1|     0|      0|        0|\n|   331|      510|       1|     0|      0|        0|\n|   332|      511|       2|     0|      0|        0|\n|   333|      512|       5|     0|      0|        0|\n|   334|      513|       2|     0|      0|        0|\n|   335|      514|       0|     0|      2|        0|\n|   336|      515|       4|     0|      5|        0|\n|   337|      516|       4|     0|      0|        0|\n|   338|      517|       5|     0|      1|        0|\n|   339|      518|       1|     0|      0|        0|\n|   340|      519|       3|     0|      1|        0|\n|   341|      520|       2|     0|      0|        0|\n|   342|      521|       2|     0|      1|        0|\n|   343|      523|       5|     0|      1|        0|\n|   344|      524|       3|     0|      1|        0|\n|   345|      525|       2|     0|      1|        0|\n|   346|      526|       0|     0|      1|        0|\n|   347|      527|       2|     0|      0|        0|\n|   348|      528|       2|     0|      4|        0|\n|   349|      529|       7|     0|      0|        0|\n|   350|      530|       1|     0|      2|        0|\n|   351|      531|       2|     0|      1|        0|\n|   352|      532|       2|     0|      2|        0|\n|   353|      533|       2|     0|      2|        0|\n|   354|      534|       2|     0|      0|        0|\n|   355|      535|       2|     0|      2|        0|\n|   356|      536|       2|     0|      0|        0|\n|   357|      537|       1|     0|      0|        0|\n|   358|      538|       3|     0|      0|        0|\n|   359|      539|       1|     0|      1|        0|\n|   360|      540|       0|     0|      4|        0|\n|   361|      541|       2|     0|      0|        0|\n|   362|      542|       0|     0|      2|        0|\n|   363|      544|       0|     0|      3|        0|\n|   364|      545|       0|     0|      1|        0|\n|   365|      546|       1|     0|      1|        0|\n|   366|      547|       0|     0|      1|        0|\n|   367|      548|       1|     0|      1|        0|\n|   368|      549|       1|     0|      2|        0|\n|   369|      550|       0|     0|      6|        0|\n|   370|      551|       4|     0|      2|        0|\n|   371|      553|       1|     0|      1|        0|\n|   372|      554|       0|     0|      3|        0|\n|   373|      555|       2|     0|      9|        0|\n|   374|      556|       0|     0|      1|        0|\n|   375|      557|       2|     0|      4|        0|\n|   376|      558|       0|     0|      2|        0|\n|   377|      559|       1|     0|      3|        0|\n|   378|      560|       1|     0|      4|        0|\n|   379|      561|       0|     0|      4|        0|\n|   380|      562|       3|     0|      2|        0|\n|   381|      563|       3|     0|      0|        0|\n|   382|      564|       1|     0|      2|        0|\n|   383|      565|       1|     0|      0|        0|\n|   384|      566|       0|     0|      1|        0|\n|   385|      567|       3|     0|      3|        0|\n|   386|      568|       3|     0|      0|        0|\n|   387|      569|       5|     0|      1|        0|\n|   388|      570|       4|     0|      2|        0|\n|   389|      571|       2|     0|      2|        0|\n|   390|      572|       1|     0|      2|        0|\n|   391|      573|       2|     0|      2|        0|\n|   392|      574|       2|     0|      4|        0|\n|   393|      575|       5|     0|      4|        0|\n|   394|      576|       6|     0|      1|        0|\n|   395|      577|       7|     0|      4|        0|\n|   396|      578|       7|     0|      0|        0|\n|   397|      579|       2|     0|      0|        0|\n|   398|      580|       3|     0|      0|        0|\n|   399|      581|       3|     0|      3|        0|\n|   400|      582|       7|     0|      2|        0|\n|   401|      583|       2|     0|      0|        0|\n|   402|      584|       3|     0|      1|        0|\n|   403|      585|       4|     0|      0|        0|\n|   404|      586|       3|     0|      0|        0|\n|   405|      587|       1|     0|      1|        0|\n|   406|      588|       1|     0|      0|        0|\n|   407|      589|       1|     0|      0|        0|\n|   408|      590|       1|     0|      0|        0|\n|   409|      591|       5|     0|      0|        0|\n|   410|      592|       2|     0|      0|        0|\n|   411|      594|       3|     0|      0|        0|\n|   412|      595|       2|     0|      0|        0|\n|   413|      597|       0|     0|      1|        0|\n|   414|      598|       2|     0|      0|        0|\n|   415|      601|       2|     0|      0|        0|\n|   416|      602|       1|     0|      0|        0|\n|   417|      603|       1|     0|      0|        0|\n|   418|      604|       2|     0|      0|        0|\n|   419|      605|       1|     0|      0|        0|\n|   420|      611|       1|     0|      0|        0|\n|   421|      618|       1|     0|      0|        0|\n|   422|      640|       1|     0|      0|        0|\n\n\n:::\n:::\n\n\n\n\n\n\n\n\nA table with the frequencies of the MBBs sizes displayed by Kingdom can be obtained as follows:\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naux=table(big_MBB_list2$MBBsize,big_MBB_list2$Kingdom)\ntable_MBB_size=tibble(Order=1:dim(aux)[1],\n                      MBB_size=as.integer(unlist(dimnames(aux)[1])),\n                      Animals=aux[,1],\n                      Fungi=aux[,2],\n                      Plants=aux[,3],\n                      Protists=aux[,4])\nknitr::kable(table_MBB_size)\n```\n\n::: {.cell-output-display}\n\n\n| Order| MBB_size| Animals|  Fungi| Plants| Protists|\n|-----:|--------:|-------:|------:|------:|--------:|\n|     1|        1|  511995| 147378| 133023|    53592|\n|     2|        2|   18725|   5390|   4865|     1960|\n|     3|        3|    3745|   1078|    973|      392|\n|     4|        4|    5885|   1694|   1529|      616|\n|     5|        5|     535|    154|    139|       56|\n|     6|        6|    3210|    924|    834|      336|\n|     7|        7|    1605|    462|    417|      168|\n|     8|        8|     535|    154|    139|       56|\n|     9|        9|     535|    154|    139|       56|\n|    10|       10|     535|    154|    139|       56|\n|    11|       12|    1070|    308|    278|      112|\n|    12|       18|     535|    154|    139|       56|\n|    13|       30|     535|    154|    139|       56|\n|    14|      979|     535|    154|    139|       56|\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n### More statistics\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweak_componets_size\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 135,916 × 12\n   Organism csize index Kingdom  Phylum        Class    Groups mDAG_Id Full_Name\n   <chr>    <dbl> <int> <chr>    <chr>         <chr>    <chr>  <chr>   <chr>    \n 1 aaf        273     1 Protists Stramenopiles Pelagop… MSA C… 0036    Aureococ…\n 2 aaf         25     2 Protists Stramenopiles Pelagop… MSA C… 0036    Aureococ…\n 3 aaf         15     3 Protists Stramenopiles Pelagop… MSA C… 0036    Aureococ…\n 4 aaf         13     4 Protists Stramenopiles Pelagop… MSA C… 0036    Aureococ…\n 5 aaf         11     5 Protists Stramenopiles Pelagop… MSA C… 0036    Aureococ…\n 6 aaf          5     6 Protists Stramenopiles Pelagop… MSA C… 0036    Aureococ…\n 7 aaf          5     7 Protists Stramenopiles Pelagop… MSA C… 0036    Aureococ…\n 8 aaf          5     8 Protists Stramenopiles Pelagop… MSA C… 0036    Aureococ…\n 9 aaf          5     9 Protists Stramenopiles Pelagop… MSA C… 0036    Aureococ…\n10 aaf          4    10 Protists Stramenopiles Pelagop… MSA C… 0036    Aureococ…\n# ℹ 135,906 more rows\n# ℹ 3 more variables: Freq_Kingdom <table[1d]>, Freq_Phylum <table[1d]>,\n#   Freq_Class <table[1d]>\n```\n\n\n:::\n\n```{.r .cell-code}\ng<-ggplot(weak_componets_size, aes(x=Kingdom,\n                  y=csize,\n                  fill=Kingdom)) +\n  xlab(\"\") +\n  ylab(\"Size of weak connected component\")+\n    geom_boxplot()+\n  scale_y_continuous(breaks = seq(0, 640, by = 20))+\n  scale_fill_manual(values = c(\"Animals\" = \"red\", \"Plants\" = \"green\", \"Fungis\" = \"orange\", \"Protists\" = \"#A9A9A9\")) +\n  theme_minimal()\ng\n```\n\n::: {.cell-output-display}\n![](metabolic_graphs_files/figure-html/unnamed-chunk-20-1.png){width=100%}\n:::\n:::\n",
    "supporting": [
      "metabolic_graphs_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}