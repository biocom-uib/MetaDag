{
  "hash": "d9827aa38b7c1ff3bcb1a40f0acec111",
  "result": {
    "engine": "knitr",
    "markdown": "\n\n::: {.cell}\n\n```{.r .cell-code}\nload(file='metadag_work_space.RData')\n```\n:::\n\n\n\n\n\n\n# m-DAGs similarities and Metadata\n\nFirst, we will load the metadata and adjust them to match the structure of the similarities. This will facilitate the creation of graphs and statistics.\n\nKeep in mind the path of the experiment:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexperiment=\n  \"0a845f74-826e-3b46-aed9-e7ecf74db262/\"\npath_exp=paste0(\"data/\",experiment)\n```\n:::\n\n\n\n\n\n\n## MSA & Munkres similarities\n\nIn this section, we will present the similarities between m-DAGs considering the two similarity meausures described in the paper. Namely, the MSA and Munkres similarities.\n\nThe experimental data set consists of 1132 Eukaryotes from the animal, plant, fungus, and protists kingdoms.\n\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Kingdom  | Abs. Freq.|\n|:--------|----------:|\n|Animals  |        535|\n|Fungi    |        154|\n|Plants   |        139|\n|Protists |         56|\n\n\n:::\n:::\n\n\n\n\n\n\nThe similarity values are provided in the following files:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_Sim=dir(path_exp,pattern=\"^Similarities\")\nlist_Sim\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Similarities_MBB_MSAMethod.csv\"      \"Similarities_MBB_MunkresMethod.csv\" \n[3] \"Similarities_mDAG_MSAMethod.csv\"     \"Similarities_mDAG_MunkresMethod.csv\"\n```\n\n\n:::\n:::\n\n\n\n\n\n\nLoad the m-DAGs similarities\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn=884# no synthetic mDGAs\nSim_MSA_mDAG=read_csv(paste0(path_exp,\n                             \"Similarities_mDAG_MSAMethod.csv\"))\nSim_MSA_mDAG=as.matrix(Sim_MSA_mDAG[,-1])\nrownames(Sim_MSA_mDAG)=colnames(Sim_MSA_mDAG)\nSim_MSA_mDAG=Sim_MSA_mDAG[meta_taxo$mDAG_Id[1:n],\n                          meta_taxo$mDAG_Id[1:n]]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nSim_Mun_mDAG=read_csv(paste0(path_exp,\"Similarities_mDAG_MunkresMethod.csv\"))\nSim_Mun_mDAG=as.matrix(Sim_Mun_mDAG[,-1])\nrownames(Sim_Mun_mDAG)=colnames(Sim_Mun_mDAG)\nSim_Mun_mDAG=Sim_Mun_mDAG[meta_taxo$mDAG_Id[1:n],meta_taxo$mDAG_Id[1:n]]\n```\n:::\n\n\n\n\n\n\n## Heatmaps\n\nHere, we provide examples of heatmaps to visualize the similarities betweem m-DAGs. We again consider colors to represent the different Kingdoms.\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndff<-meta_taxo[1:884,] %>% select(Kingdom)  %>% as.data.frame()\ncolorsK <- list(Kingdom= c(\"Animals\"=\"red\",\n                           \"Plants\"=\"green\",\n                           \"Fungi\"=\"yellow\",\n                           \"Protists\"=\"black\"))\nannotationK <- HeatmapAnnotation(df=dff, col = colorsK,show_legend = TRUE)\n\nMSA_heat_1 <- Heatmap(matrix = Sim_MSA_mDAG, \n                      column_title=\n                        \"m-DAGs MSA-similarity Eukaryotes by Kingdoms\",\n                      heatmap_legend_param=list(\n                        title=\"Similarity\",\n                        at = seq(0,1,by=0.1)),\n                      col=rev(viridis(256)),\n                      cluster_rows = FALSE,\n                      cluster_columns = FALSE,\n                      top_annotation = annotationK,\n                      show_column_names = FALSE, \n                      show_row_names = FALSE,\n                      left_annotation =\n                        rowAnnotation(df = dff,\n                                      col = colorsK,\n                                    show_annotation_name=FALSE,\n                                    show_legend=FALSE\n                                      ))\n\n\nMun_heat_1 <- Heatmap(matrix = Sim_Mun_mDAG, \n             column_title=\"m-DAGs Munkres-similarity  Eukaryotes by Kingdoms\",\n            name = \"Munkres Similarity\",\n            heatmap_legend_param=list(\n                        title=\"Similarity\",\n                        at = seq(0,1,by=0.1)),\n                      col=rev(viridis(256)),\n                      cluster_rows = FALSE,\n                      cluster_columns = FALSE,\n                      top_annotation = annotationK,\n                      show_column_names = FALSE, \n                      show_row_names = FALSE,\n                      left_annotation =\n                        rowAnnotation(df = dff,\n                                      col = colorsK,\n                                    show_annotation_name=FALSE,\n                                    show_legend=FALSE                                                                        ))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n##  Animals by phylum\n\nmeta_animals  = meta_taxo %>% filter(Kingdom==\"Animals\")\nnamesP=names(rev(sort(table(meta_animals$Phylum))))\nnamesP\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Vertebrates\"      \"Arthropods\"       \"Mollusks\"         \"Cnidarians\"      \n [5] \"Nematodes\"        \"Flatworms\"        \"Echinoderms\"      \"Tunicates\"       \n [9] \"Cephalochordates\" \"Poriferans\"       \"Placozoans\"       \"Hemichordates\"   \n[13] \"Brachiopodas\"     \"Annelids\"        \n```\n\n\n:::\n\n```{.r .cell-code}\ndff=data.frame(Phylum=meta_animals$Phylum)\nPhylum=ordered(meta_animals$Phylum,levels=namesP)\nnumbersP=paste(c(paste0(0,1:9),10:14),namesP,sep=\"-\")\nlevels(Phylum)=numbersP\ndff$Phylum=Phylum\ncol=rainbow(length(namesP))\n\ncolorsP=list(Phylum=col)\nnames(colorsP$Phylum)=numbersP\n\nannot <- HeatmapAnnotation(df = dff, \n                               col = colorsP,\n                               annotation_name_side = \"left\",\n                               show_annotation_name=TRUE )\n\nMSA_heat_2 <-  Heatmap(\n  matrix = Sim_MSA_mDAG[meta_animals$mDAG_Id,\n                        meta_animals$mDAG_Id],\n  name = \"MSA similarity\",\n  column_title = \"m-DAGs MSA-similarity  Animals by Phyla\",\n  col = rev(viridis(256)),\n  cluster_rows = FALSE,\n  show_heatmap_legend = FALSE,\n  cluster_columns = FALSE,\n  top_annotation = annot,\n  show_column_names = FALSE,\n  show_row_names = FALSE,\n  left_annotation =\n    rowAnnotation(\n      df = dff,\n      col = colorsP,\n      show_annotation_name = FALSE\n    )\n)\n\n\n\n\nMun_heat_2 <- Heatmap(\n  matrix = Sim_Mun_mDAG[meta_animals$mDAG_Id,\n                        meta_animals$mDAG_Id],\n  column_title = \"m-DAGs Munkres-similarity  Animals by Phyla\",\n col = rev(viridis(256)),\n  cluster_rows = FALSE,\n  show_heatmap_legend = FALSE,\n  cluster_columns = FALSE,\n  top_annotation = annot,\n  show_column_names = FALSE,\n  show_row_names = FALSE,\n  left_annotation =\n    rowAnnotation(\n      df = dff,\n      col = colorsP,\n      show_annotation_name = FALSE\n    )\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndraw(MSA_heat_1,merge_legend=TRUE)\n```\n\n::: {.cell-output-display}\n![](m_DAGs_similarity_files/figure-html/heatmaps-1.png){width=100%}\n:::\n\n```{.r .cell-code}\ndraw(MSA_heat_2,merge_legend=TRUE)\n```\n\n::: {.cell-output-display}\n![](m_DAGs_similarity_files/figure-html/heatmaps-2.png){width=100%}\n:::\n\n```{.r .cell-code}\ndraw(Mun_heat_1,merge_legend=TRUE)\n```\n\n::: {.cell-output-display}\n![](m_DAGs_similarity_files/figure-html/heatmaps-3.png){width=100%}\n:::\n\n```{.r .cell-code}\ndraw(Mun_heat_2,merge_legend=TRUE)\n```\n\n::: {.cell-output-display}\n![](m_DAGs_similarity_files/figure-html/heatmaps-4.png){width=100%}\n:::\n:::\n\n\n\n\n\n\n\n\n## MDS (Multidimensional Scaling) MSA & Munkres similarities\n\nMulti-dimensional Scaling (MDS) is a classic multivariate data analysis technique that allows for obtaining a low-dimensional representation of the observed similarities. First, we transform each similarity measure into a distance measure as follows: let $s_{ij}$ be a similarity measure between a pair $i,j$, we define its distance measure as $d_{ij}=\\sqrt{1-s_{ij}^2}$.\n\nThe following is the MDS for the MSA distance:\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n## Metric multidimensional scaling (mMDS)\nmds7 <- cmdscale(sqrt(1-Sim_MSA_mDAG^2),k=7,eig=TRUE)\nmds7$GOF\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4449519 0.5570199\n```\n\n\n:::\n\n```{.r .cell-code}\nmds <- mds7$points %>%  as_tibble()\ncolnames(mds) <-paste0(\"Dim.\",1:dim(mds7$points)[2])\n\n\ncooordinates=as_tibble(mds7$points)\ncolnames(cooordinates)=paste(\"Component\",1:7)\nggpairs(cooordinates,columns=1:4,\n        aes(color=meta_taxo$Kingdom[1:884],\n            title=\"MDS 4 dimensions projection\",legend=1),\n        lower=list(continuous=\"points\")) + \n  scale_fill_manual(values = colorsK$Kingdom) + \n  theme(legend.position = \"left\")\n```\n\n::: {.cell-output-display}\n![](m_DAGs_similarity_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n\n\n\nThe following is the MDS for the Munkres distance:\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n## Metric multidimensional scaling\nmds7 <- cmdscale(sqrt(1-Sim_Mun_mDAG^2),k=7,eig=TRUE)\nmds7$GOF\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.5605691 0.5800736\n```\n\n\n:::\n\n```{.r .cell-code}\nmds <- mds7$points %>%  as_tibble()\ncolnames(mds) <-paste0(\"Dim.\",1:dim(mds7$points)[2])\n\ncooordinates=as_tibble(mds7$points)\ncolnames(cooordinates)=paste(\"Component\",1:7)\nggpairs(cooordinates,columns=1:4,\n        aes(color=meta_taxo$Kingdom[1:884],\n            title=\"MDS 4 dimensions projection\",legend=1),\n        lower=list(continuous=\"points\")) + \n  scale_fill_manual(values = colorsK$Kingdom) + \n  theme(legend.position = \"left\")\n```\n\n::: {.cell-output-display}\n![](m_DAGs_similarity_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n\n\n\n## Hierarchical clustering MSA similarity\n\nThrough hierarchical clustering using the Ward method, we have derived a partition of the m-DAGs into 4, 5, and 6 clusters, respectively. The corresponding information has been organized into a table, as follows:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nD=as.dist(sqrt(1-Sim_MSA_mDAG^2))\nhc_MSA=hclust(as.dist(D),method =\"ward.D\")\nclust4_MSA=cutree(hc_MSA,4)\ntable(clust4_MSA,meta_taxo$Kingdom[1:884])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          \nclust4_MSA Animals Fungi Plants Protists\n         1     331     0      0        0\n         2     197     0      0        0\n         3       7   154     14       56\n         4       0     0    125        0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclust5_MSA=cutree(hc_MSA,5)\ntable(clust5_MSA,meta_taxo$Kingdom[1:884])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          \nclust5_MSA Animals Fungi Plants Protists\n         1     129     0      0        0\n         2     202     0      0        0\n         3     197     0      0        0\n         4       7   154     14       56\n         5       0     0    125        0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclust6_MSA=cutree(hc_MSA,6)\ntable(clust6_MSA,meta_taxo$Kingdom[1:884])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          \nclust6_MSA Animals Fungi Plants Protists\n         1     129     0      0        0\n         2     202     0      0        0\n         3     197     0      0        0\n         4       7   149     14       34\n         5       0     5      0       22\n         6       0     0    125        0\n```\n\n\n:::\n:::\n\n\n\n\n\n\nWe can also create a table that correlates the clusters (in this case, two clusters) with the Phylum classification:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naux=meta_taxo[1:884,] %>%\n  select(Organism,Kingdom,Phylum,Class,Full_Name)\naux$clust4_MSA=clust4_MSA\naux_Animals_cluster_1_2 = aux %>%\n  filter(Kingdom==\"Animals\",clust4_MSA %in% c(1,2))\n\ntable(aux_Animals_cluster_1_2$Phylum,aux_Animals_cluster_1_2$clust4_MSA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  \n                     1   2\n  Annelids           0   1\n  Arthropods         0 158\n  Brachiopodas       0   1\n  Cephalochordates   0   2\n  Cnidarians         0  10\n  Echinoderms        0   3\n  Hemichordates      0   1\n  Mollusks           0  14\n  Nematodes          0   3\n  Placozoans         0   1\n  Poriferans         0   1\n  Tunicates          0   2\n  Vertebrates      331   0\n```\n\n\n:::\n:::\n\n\n\n\n\n\nWe can retrieve the information of the elements belonging to a specific classification (Animals and Plants) that are part of a particular cluster as follows:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naux_7_Animals_cluster_3= filter(aux,\n                                clust4_MSA==3,\n                                Kingdom==\"Animals\")\naux_7_Animals_cluster_3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 6\n  Organism Kingdom Phylum    Class     Full_Name                      clust4_MSA\n  <chr>    <chr>   <chr>     <chr>     <chr>                               <int>\n1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                 3\n2 loa      Animals Nematodes Nematodes Loa loa (eye worm)                      3\n3 tsp      Animals Nematodes Nematodes Trichinella spiralis                    3\n4 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyda…          3\n5 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (South…          3\n6 shx      Animals Flatworms Flatworms Schistosoma haematobium (urin…          3\n7 smm      Animals Flatworms Flatworms Schistosoma mansoni                     3\n```\n\n\n:::\n\n```{.r .cell-code}\naux_14_Plants_clust_3= filter(aux,clust4_MSA==3,\n                             Kingdom==\"Plants\")\naux_14_Plants_clust_3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 6\n   Organism Kingdom Phylum Class Full_Name                      clust4_MSA\n   <chr>    <chr>   <chr>  <chr> <chr>                               <int>\n 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3\n 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3\n 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3\n 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3\n 5 cvr      Plants  Green  algae Chlorella variabilis                    3\n 6 mis      Plants  Green  algae Micromonas commoda                      3\n 7 mng      Plants  Green  algae Monoraphidium neglectum                 3\n 8 mpp      Plants  Green  algae Micromonas pusilla                      3\n 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3\n10 ota      Plants  Green  algae Ostreococcus tauri                      3\n11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3\n12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3\n13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3\n14 gsl      Plants  Red    algae Galdieria sulphuraria                   3\n```\n\n\n:::\n:::\n\n\n\n\n\n\nWe can retrieve the information of the elements from a specific Phylum or Class, and the cluster they belong to, as follows:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naux_all_Nematodes_Flatworns= aux %>% \n  filter(Kingdom==\"Animals\",\n         Phylum %in% c(\"Nematodes\",\"Flatworms\"))\naux_all_Nematodes_Flatworns\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 6\n   Organism Kingdom Phylum    Class     Full_Name                     clust4_MSA\n   <chr>    <chr>   <chr>     <chr>     <chr>                              <int>\n 1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                3\n 2 cbr      Animals Nematodes Nematodes Caenorhabditis briggsae (nem…          2\n 3 cel      Animals Nematodes Nematodes Caenorhabditis elegans (nema…          2\n 4 loa      Animals Nematodes Nematodes Loa loa (eye worm)                     3\n 5 nai      Animals Nematodes Nematodes Necator americanus (New Worl…          2\n 6 tsp      Animals Nematodes Nematodes Trichinella spiralis                   3\n 7 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyd…          3\n 8 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (Sout…          3\n 9 shx      Animals Flatworms Flatworms Schistosoma haematobium (uri…          3\n10 smm      Animals Flatworms Flatworms Schistosoma mansoni                    3\n```\n\n\n:::\n:::\n\n\n\n\n\n\nThe class Algae are all in the same cluster:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naux_all_algae_class= aux %>% \n  filter(Kingdom==\"Plants\",\n         Class %in% c(\"algae\"))\naux_all_algae_class\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 6\n   Organism Kingdom Phylum Class Full_Name                      clust4_MSA\n   <chr>    <chr>   <chr>  <chr> <chr>                               <int>\n 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3\n 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3\n 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3\n 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3\n 5 cvr      Plants  Green  algae Chlorella variabilis                    3\n 6 mis      Plants  Green  algae Micromonas commoda                      3\n 7 mng      Plants  Green  algae Monoraphidium neglectum                 3\n 8 mpp      Plants  Green  algae Micromonas pusilla                      3\n 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3\n10 ota      Plants  Green  algae Ostreococcus tauri                      3\n11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3\n12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3\n13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3\n14 gsl      Plants  Red    algae Galdieria sulphuraria                   3\n```\n\n\n:::\n:::\n\n\n\n\n\n\n## Hierarchical clustering Munkres similarity\n\nAnalogous to the MSA similarity we obtain a classification of the m-DAGs into different clusters and retrieve the cluster's information as follows:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nD=as.dist(sqrt(1-Sim_Mun_mDAG^2))\nhc_Mun=hclust(as.dist(D),method =\"ward.D\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclust4_Mun=cutree(hc_Mun,4)\ntable(clust4_Mun,meta_taxo$Kingdom[1:884])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          \nclust4_Mun Animals Fungi Plants Protists\n         1     331     0      0        0\n         2     197     0      0        0\n         3       7   154     14       56\n         4       0     0    125        0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\naux=meta_taxo[1:884,] %>%\n  select(Organism,Kingdom,Phylum,Class,Full_Name)\naux$clust4_Mun=clust4_Mun\naux_Animals_cluster_1_2_Mun = aux %>%\n  filter(Kingdom==\"Animals\",clust4_Mun %in% c(1,2))\n\ntable(aux_Animals_cluster_1_2_Mun$Phylum,\n      aux_Animals_cluster_1_2_Mun$clust4_Mun)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  \n                     1   2\n  Annelids           0   1\n  Arthropods         0 158\n  Brachiopodas       0   1\n  Cephalochordates   0   2\n  Cnidarians         0  10\n  Echinoderms        0   3\n  Hemichordates      0   1\n  Mollusks           0  14\n  Nematodes          0   3\n  Placozoans         0   1\n  Poriferans         0   1\n  Tunicates          0   2\n  Vertebrates      331   0\n```\n\n\n:::\n\n```{.r .cell-code}\naux_7_Animals_cluster_3_Mun= filter(aux,\n                                clust4_Mun==3,\n                                Kingdom==\"Animals\")\naux_7_Animals_cluster_3_Mun\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 6\n  Organism Kingdom Phylum    Class     Full_Name                      clust4_Mun\n  <chr>    <chr>   <chr>     <chr>     <chr>                               <int>\n1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                 3\n2 loa      Animals Nematodes Nematodes Loa loa (eye worm)                      3\n3 tsp      Animals Nematodes Nematodes Trichinella spiralis                    3\n4 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyda…          3\n5 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (South…          3\n6 shx      Animals Flatworms Flatworms Schistosoma haematobium (urin…          3\n7 smm      Animals Flatworms Flatworms Schistosoma mansoni                     3\n```\n\n\n:::\n\n```{.r .cell-code}\naux_all_Nematodes_Flatworns= aux %>% \n  filter(Kingdom==\"Animals\",\n         Phylum %in% c(\"Nematodes\",\"Flatworms\"))\naux_all_Nematodes_Flatworns\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 6\n   Organism Kingdom Phylum    Class     Full_Name                     clust4_Mun\n   <chr>    <chr>   <chr>     <chr>     <chr>                              <int>\n 1 bmy      Animals Nematodes Nematodes Brugia malayi (filaria)                3\n 2 cbr      Animals Nematodes Nematodes Caenorhabditis briggsae (nem…          2\n 3 cel      Animals Nematodes Nematodes Caenorhabditis elegans (nema…          2\n 4 loa      Animals Nematodes Nematodes Loa loa (eye worm)                     3\n 5 nai      Animals Nematodes Nematodes Necator americanus (New Worl…          2\n 6 tsp      Animals Nematodes Nematodes Trichinella spiralis                   3\n 7 egl      Animals Flatworms Flatworms Echinococcus granulosus (hyd…          3\n 8 ovi      Animals Flatworms Flatworms Opisthorchis viverrini (Sout…          3\n 9 shx      Animals Flatworms Flatworms Schistosoma haematobium (uri…          3\n10 smm      Animals Flatworms Flatworms Schistosoma mansoni                    3\n```\n\n\n:::\n\n```{.r .cell-code}\naux_14_Plants_clust2_Mun= filter(aux,clust4_Mun==3,\n                             Kingdom==\"Plants\")\naux_14_Plants_clust2_Mun\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 6\n   Organism Kingdom Phylum Class Full_Name                      clust4_Mun\n   <chr>    <chr>   <chr>  <chr> <chr>                               <int>\n 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3\n 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3\n 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3\n 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3\n 5 cvr      Plants  Green  algae Chlorella variabilis                    3\n 6 mis      Plants  Green  algae Micromonas commoda                      3\n 7 mng      Plants  Green  algae Monoraphidium neglectum                 3\n 8 mpp      Plants  Green  algae Micromonas pusilla                      3\n 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3\n10 ota      Plants  Green  algae Ostreococcus tauri                      3\n11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3\n12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3\n13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3\n14 gsl      Plants  Red    algae Galdieria sulphuraria                   3\n```\n\n\n:::\n\n```{.r .cell-code}\naux_all_algae_class= aux %>% \n  filter(Kingdom==\"Plants\",\n         Class %in% c(\"algae\"))\naux_all_algae_class\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 14 × 6\n   Organism Kingdom Phylum Class Full_Name                      clust4_Mun\n   <chr>    <chr>   <chr>  <chr> <chr>                               <int>\n 1 apro     Plants  Green  algae Auxenochlorella protothecoides          3\n 2 bpg      Plants  Green  algae Bathycoccus prasinos                    3\n 3 cre      Plants  Green  algae Chlamydomonas reinhardtii               3\n 4 csl      Plants  Green  algae Coccomyxa subellipsoidea                3\n 5 cvr      Plants  Green  algae Chlorella variabilis                    3\n 6 mis      Plants  Green  algae Micromonas commoda                      3\n 7 mng      Plants  Green  algae Monoraphidium neglectum                 3\n 8 mpp      Plants  Green  algae Micromonas pusilla                      3\n 9 olu      Plants  Green  algae Ostreococcus lucimarinus                3\n10 ota      Plants  Green  algae Ostreococcus tauri                      3\n11 vcn      Plants  Green  algae Volvox carteri f. nagariensis           3\n12 ccp      Plants  Red    algae Chondrus crispus (carragheen)           3\n13 cme      Plants  Red    algae Cyanidioschyzon merolae                 3\n14 gsl      Plants  Red    algae Galdieria sulphuraria                   3\n```\n\n\n:::\n:::\n\n\n\n\n\n\n## Comparison between MSA and Munkres similarities\n\nIn order to compare the two similarities we consider the Spearman and Pearson correlation. First, we load the similarities for every pair of m-DAG and each similarity measure.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn=length(meta_taxo$mDAG_Id[1:884])\nn\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 884\n```\n\n\n:::\n\n```{.r .cell-code}\ndim(Sim_MSA_mDAG)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 884 884\n```\n\n\n:::\n\n```{.r .cell-code}\naux=as_tibble(Sim_MSA_mDAG)\naux$mDag=names(aux)\naux=aux %>% pivot_longer(cols=`0313`:`0300`,\n                         names_to=\"mDag_2\",\n                         values_to=\"Sim_MSA\")\n\naux_2= aux %>%  mutate(i=pmax(as.integer(mDag),\n                              as.integer(mDag_2)),\n                       j=pmin(as.integer(mDag),\n                       as.integer(mDag_2))) %>% unite(\"ij\",i:j) %>%\n  filter(duplicated(ij))\n\n\naux=as_tibble(Sim_Mun_mDAG)\naux$mDag=names(aux)\naux=aux %>% pivot_longer(cols=`0313`:`0300`,\n                         names_to=\"mDag_2\",\n                         values_to=\"Sim_Mun\")\naux_2 = aux_2 %>% left_join(aux)\n\nSim_comp=aux_2\nrm(aux,aux_2)\n```\n:::\n\n\n\n\n\n\nNext we obtain the Spearman and Pearson correlations as follows:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(Sim_comp[,c(3,5)],method=\"spearman\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Sim_MSA   Sim_Mun\nSim_MSA 1.0000000 0.8930995\nSim_Mun 0.8930995 1.0000000\n```\n\n\n:::\n\n```{.r .cell-code}\ncor(Sim_comp[,c(3,5)],method=\"pearson\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Sim_MSA   Sim_Mun\nSim_MSA 1.0000000 0.9203871\nSim_Mun 0.9203871 1.0000000\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nGGally::ggpairs(Sim_comp[,c(3,5)])\n```\n\n::: {.cell-output-display}\n![](m_DAGs_similarity_files/figure-html/unnamed-chunk-25-1.png){width=100%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsim_pairs= Sim_comp%>% pivot_longer(\n  cols=c(Sim_MSA,Sim_Mun),\n  names_to=\"Method\",\n  values_to=\"Similarity\")\n\nggstatsplot::ggbetweenstats(\n  data = sim_pairs,\n  x = Method,\n  y = Similarity,\n  centrality.plotting=TRUE)\n```\n\n::: {.cell-output-display}\n![](m_DAGs_similarity_files/figure-html/unnamed-chunk-26-1.png){width=100%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(hrbrthemes)\nlibrary(viridis)\nsim_pairs %>%\n  ggplot( aes(x=Method, y=Similarity, fill=Method)) +\n  geom_boxplot() +\n  scale_fill_viridis(discrete = TRUE, alpha=0.6) +\n  theme(legend.position=\"none\")+\n  ggtitle(\"Boxplot diagram of the similarities between the two aproaches\") \n```\n\n::: {.cell-output-display}\n![](m_DAGs_similarity_files/figure-html/unnamed-chunk-27-1.png){width=100%}\n:::\n:::\n\n\n\n\n\n\nBasic statistics similarity\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim_pairs %>% group_by(Method) %>% \n  summarise(N=n(),\n          mean=mean(Similarity),\n          sd=sd(Similarity),\n          Q1=quantile(Similarity,0.25),\n          median=quantile(Similarity,0.5),\n          Q3=quantile(Similarity,0.75))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 7\n  Method       N  mean    sd    Q1 median    Q3\n  <chr>    <int> <dbl> <dbl> <dbl>  <dbl> <dbl>\n1 Sim_MSA 390286 0.672 0.182 0.559  0.670 0.781\n2 Sim_Mun 390286 0.547 0.202 0.427  0.509 0.635\n```\n\n\n:::\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}